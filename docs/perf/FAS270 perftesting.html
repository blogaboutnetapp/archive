<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />
<title>FAS270 perftesting</title>
</head>

<body>
<p>“естировалс€  FAS270  (одноконтроллерна€ конфигураци€, сегмент Уentry level Ц low enterpriseФ). »нтерфейсы FC и iSCSI.</p>
<p><strong>FAS270 (DataONTAP 7.0.5)</strong><br />
    <strong>14HDD 72G15K, 1GB RAM Cache</strong></p>
<p><strong>aggr0</strong><strong> RAID-DP 13 HDD (2 parity + 11 data)  + 1 Spare</strong><br />
    <strong>vol1</strong><br />
    <strong>10 hdd in vol1 (flexvol type)</strong><br />
    <strong>lun 10GB</strong><br />
    <strong>no</strong><strong> snapshots, 0% reserve</strong><br />
    <strong>vol1</strong><strong> minra on</strong></p>
<p>ѕодключалс€  Ђпр€мым проводомї в Load Generator (в случае FC Ц point-to-point 2GB/s, в случае iSCSI Ц кроссоверный кабель Cat5e 10м)</p>
<p>УLoad GeneratorФ: SUN Enterprise 4900 2x SPARC3 1.2GHz  4GB RAM / Solaris10 06/06<br />
  FC HBA Emulex LP10000 (driver bundled in Solaris10,  v5.21 for MS Windows 2003 Server R2), Software iSCSI initiator (bundled in  Solaris10)</p>
<p>»змерени€  проводились с помощью IOmeter:<br />
    <strong>IOMeter</strong><strong> v.2006.07.27 stable, dynamo  compiled for SPARC (gcc 3.4.3)</strong>,  собиралс€ из исходников на Load  Generator непосредственно.</p>
<p>“естировалс€ трем€ типами паттернов <strong>database pattern</strong>, <strong>fileserver pattern</strong> и <strong>webserver</strong><strong> pattern</strong>.<br />
  RAW access: 16777216 sectors (8GiB)<br />
  –ежим тестировани€: 1 Worker,  up to 256 Outstanding IOs exponential steps  (1,2,4,8Е256)</p>
<p>«амер€лс€ лимит по IOPS:  512bytes blocks Sequential Read, up to 256 Outstanding IOs<br />
  и  MBPS: 1MB blocks Sequential Read, up to 256 Outstanding IOs</p>
<p>“акже  замер€лс€ тест IOzone по спецификации Alex Roudnev (forum.sql.ru) на блоках 64K и 4K и стандартный &quot;auto&quot; mode.<br />
    <strong>iozone64  -i 0 -i 1 -i 2 -i 4 -i  5 -i 8 -e -o -c -s 4000M -r 4K -j 1 -f TEST4G4k.log  -b /export/home/romx/testlog-NF4g4k.xls</strong><strong> </strong><br />
    <strong>iozone64  -i 0 -i 1 -i 2 -i 4 -i  5 -i 8 -e -o -c -s 4000M -r 64K -j 1 -f TEST4G64k.log  -b /export/home/romx/testlog-NF4g64k.xls</strong><br />
    <strong>iozone64 -a -b /export/home/testlog-NFA.xls</strong> <br />
  (результаты  не обработаны, есть только Уraw dataФ)</p>
<p>
  <a href="FAS270/testlog-NF4g4k.xls">testlog-NF4g4k.xls</a><br />
  <a href="FAS270/testlog-NF4g64k.xls">testlog-NF4g64k.xls</a><br />
  <a href="FAS270/testlog-NFA.xls">testlog-NFA.xls</a><br />
  <a href="FAS270/testlog-NS4g4k.xls">testlog-NS4g4k.xls</a><br />
  <a href="FAS270/testlog-NS4g64k.xls">testlog-NS4g64k.xls</a><br />
  <a href="FAS270/testlog-NSA.xls">testlog-NSA.xls</a></p>
<p><strong>ќписани€ использованных паттернов:</strong></p>
<table border="1" cellspacing="0" cellpadding="0" width="384">
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p>&nbsp;</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p>&nbsp;</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p>&nbsp;</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p>&nbsp;</p></td>
  </tr>
  <tr>
    <td width="384" nowrap="nowrap" colspan="4" valign="bottom"><p align="center"><strong>database pattern</strong></p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p><em>block    size</em></p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p><em>% of    size</em></p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p><em>% read</em></p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p><em>%    random</em></p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">8192</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">67</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p>&nbsp;</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p>&nbsp;</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p>&nbsp;</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p>&nbsp;</p></td>
  </tr>
  <tr>
    <td width="384" nowrap="nowrap" colspan="4" valign="bottom"><p align="center"><strong>fileserver pattern</strong></p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p><em>block    size</em></p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p><em>% of    size</em></p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p><em>% read</em></p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p><em>%    random</em></p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">512</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">10</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">80</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">1024</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">5</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">80</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">2048</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">5</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">80</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">4096</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">60</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">80</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">8192</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">2</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">80</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">16384</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">4</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">80</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">32768</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">4</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">80</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">65535</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">10</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">80</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p>&nbsp;</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p>&nbsp;</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p>&nbsp;</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p>&nbsp;</p></td>
  </tr>
  <tr>
    <td width="384" nowrap="nowrap" colspan="4" valign="bottom"><p align="center"><strong>webserver pattern</strong></p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p><em>block    size</em></p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p><em>% of    size</em></p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p><em>% read</em></p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p><em>%    random</em></p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">512</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">22</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">1024</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">15</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">2048</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">8</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">4096</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">23</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">8192</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">15</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">16384</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">2</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">32768</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">6</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">65535</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">7</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">131072</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">1</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
  <tr>
    <td width="97" nowrap="nowrap" valign="bottom"><p align="right">524288</p></td>
    <td width="91" nowrap="nowrap" valign="bottom"><p align="right">1</p></td>
    <td width="88" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">100</p></td>
  </tr>
</table>
<p>&nbsp;</p>
<p><strong>–езультаты:</strong></p>
<p>1. паттерны</p>
<table border="1" cellspacing="0" cellpadding="0" width="823">
  <tr>
    <td width="65" nowrap="nowrap" valign="bottom"><br />
        <strong>IOPS</strong> </td>
    <td width="121" nowrap="nowrap" valign="bottom"><p>dbPattern    FC 270</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p>dbPattern    ISCSI 270</p></td>
    <td width="120" nowrap="nowrap" valign="bottom"><p>fsPattern    FC 270</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p>fsPattern    iSCSI 270</p></td>
    <td width="124" nowrap="nowrap" valign="bottom"><p>webPattern    FC 270</p></td>
    <td width="138" nowrap="nowrap" valign="bottom"><p>webPattern    iSCSI 270</p></td>
  </tr>
  <tr>
    <td width="65" nowrap="nowrap" valign="bottom"><p align="right">1</p></td>
    <td width="121" nowrap="nowrap" valign="bottom"><p align="right">2573</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">1582</p></td>
    <td width="120" nowrap="nowrap" valign="bottom"><p align="right">2735</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">235</p></td>
    <td width="124" nowrap="nowrap" valign="bottom"><p align="right">3091</p></td>
    <td width="138" nowrap="nowrap" valign="bottom"><p align="right">1636</p></td>
  </tr>
  <tr>
    <td width="65" nowrap="nowrap" valign="bottom"><p align="right">2</p></td>
    <td width="121" nowrap="nowrap" valign="bottom"><p align="right">4207</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">2674</p></td>
    <td width="120" nowrap="nowrap" valign="bottom"><p align="right">4274</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">505</p></td>
    <td width="124" nowrap="nowrap" valign="bottom"><p align="right">5028</p></td>
    <td width="138" nowrap="nowrap" valign="bottom"><p align="right">2401</p></td>
  </tr>
  <tr>
    <td width="65" nowrap="nowrap" valign="bottom"><p align="right">4</p></td>
    <td width="121" nowrap="nowrap" valign="bottom"><p align="right">5812</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">3751</p></td>
    <td width="120" nowrap="nowrap" valign="bottom"><p align="right">5891</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">771</p></td>
    <td width="124" nowrap="nowrap" valign="bottom"><p align="right">7406</p></td>
    <td width="138" nowrap="nowrap" valign="bottom"><p align="right">3189</p></td>
  </tr>
  <tr>
    <td width="65" nowrap="nowrap" valign="bottom"><p align="right">8</p></td>
    <td width="121" nowrap="nowrap" valign="bottom"><p align="right">6670</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">4676</p></td>
    <td width="120" nowrap="nowrap" valign="bottom"><p align="right">7312</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">1987</p></td>
    <td width="124" nowrap="nowrap" valign="bottom"><p align="right">8982</p></td>
    <td width="138" nowrap="nowrap" valign="bottom"><p align="right">3660</p></td>
  </tr>
  <tr>
    <td width="65" nowrap="nowrap" valign="bottom"><p align="right">16</p></td>
    <td width="121" nowrap="nowrap" valign="bottom"><p align="right">6964</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">5350</p></td>
    <td width="120" nowrap="nowrap" valign="bottom"><p align="right">7954</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">4402</p></td>
    <td width="124" nowrap="nowrap" valign="bottom"><p align="right">9335</p></td>
    <td width="138" nowrap="nowrap" valign="bottom"><p align="right">4010</p></td>
  </tr>
  <tr>
    <td width="65" nowrap="nowrap" valign="bottom"><p align="right">32</p></td>
    <td width="121" nowrap="nowrap" valign="bottom"><p align="right">6492</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">5527</p></td>
    <td width="120" nowrap="nowrap" valign="bottom"><p align="right">8309</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">4913</p></td>
    <td width="124" nowrap="nowrap" valign="bottom"><p align="right">9447</p></td>
    <td width="138" nowrap="nowrap" valign="bottom"><p align="right">3821</p></td>
  </tr>
  <tr>
    <td width="65" nowrap="nowrap" valign="bottom"><p align="right">64</p></td>
    <td width="121" nowrap="nowrap" valign="bottom"><p align="right">6900</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">5723</p></td>
    <td width="120" nowrap="nowrap" valign="bottom"><p align="right">8341</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">4926</p></td>
    <td width="124" nowrap="nowrap" valign="bottom"><p align="right">9547</p></td>
    <td width="138" nowrap="nowrap" valign="bottom"><p align="right">3777</p></td>
  </tr>
  <tr>
    <td width="65" nowrap="nowrap" valign="bottom"><p align="right">128</p></td>
    <td width="121" nowrap="nowrap" valign="bottom"><p align="right">6825</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">5813</p></td>
    <td width="120" nowrap="nowrap" valign="bottom"><p align="right">8324</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">4892</p></td>
    <td width="124" nowrap="nowrap" valign="bottom"><p align="right">9588</p></td>
    <td width="138" nowrap="nowrap" valign="bottom"><p align="right">3839</p></td>
  </tr>
  <tr>
    <td width="65" nowrap="nowrap" valign="bottom"><p align="right">256</p></td>
    <td width="121" nowrap="nowrap" valign="bottom"><p align="right">6902</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">5811</p></td>
    <td width="120" nowrap="nowrap" valign="bottom"><p align="right">8468</p></td>
    <td width="128" nowrap="nowrap" valign="bottom"><p align="right">4899</p></td>
    <td width="124" nowrap="nowrap" valign="bottom"><p align="right">9522</p></td>
    <td width="138" nowrap="nowrap" valign="bottom"><p align="right">3804</p></td>
  </tr>
</table>
<p>2.  максималка</p>
<table border="1" cellspacing="0" cellpadding="0" width="469">
  <tr>
    <td width="116" nowrap="nowrap" valign="bottom"><br />
      FC    maxIOPS </td>
    <td width="113" nowrap="nowrap" valign="bottom"><p>FC    maxMBPS</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p>iSCSI    maxIOPS</p></td>
    <td width="132" nowrap="nowrap" valign="bottom"><p>iSCSI    maxMBPS</p></td>
  </tr>
  <tr>
    <td width="116" nowrap="nowrap" valign="bottom"><p align="right">21810</p></td>
    <td width="113" nowrap="nowrap" valign="bottom"><p align="right">182,2</p></td>
    <td width="108" nowrap="nowrap" valign="bottom"><p align="right">17862</p></td>
    <td width="132" nowrap="nowrap" valign="bottom"><p align="right">70,22</p></td>
  </tr>
</table>
<p>&nbsp;</p>
<p><img src="image002.gif" alt="results" width="816" height="548" /></p>
<p>&nbsp;</p>
<p><strong>¬ыводы:</strong></p>
<p>’орошо  видно, что производительность FAS270 заметно зависит от характера доступа, достига€  максимума примерно на 32-64 Outstanding IOs (до 8 OutIOs имеет линейный прирост).<br />
  –азница в  производительности дл€ FC и iSCSI в первую очередь определ€етс€ недостаточностью мощности  процессора контроллера модели FAS270, лимит по производительности достигаетс€ в  результате 100% загрузки процессора контроллера.<br />
  –азница в  производительности дл€ FC и iSCSI минимальна в случае database pattern (разница не превышает 15-18% ) и  максимальна дл€ web pattern, характеризующегос€ большим  количеством мелких блоков и смесью разных размеров.<br />
  ћаксимум на  iSCSI ( тесты iSCSI maxIOPS и iSCSI maxMBPS) достигнут при практически 100%  загрузке Load Generator, таким образом теоретический лимит строго говор€ не  достигнут, будучи ограничен возможностью LG. ƒл€ FC максимальные цифры достигнуты при  примерно 85-88% процессорной загрузки LG.<br />
  Ќе€сной  осталась причина странного поведени€ результатов на fileserver pattern (нетипично медленный рост  результатов при увеличении OutIOs)<br />
  ќсталс€  вопросом использованный размер frame дл€ iSCSI на Solaris. Ѕыл ли на тестировании Jumbo Frame или нет пон€ть не удалось (8-).  —мена MTU с  1500 на 9000 дл€ интерфейса на результате не отразилась, что необычно (дл€ Windows включение Jumbo Frame увеличило производительность iSCSI пр€мо таки dramatically).</p>
<p>&nbsp;</p>
</body>
</html>
