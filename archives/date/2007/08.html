<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="ru-RU">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>about NetApp   &raquo; 2007 &raquo; Август</title>

<link rel="stylesheet" href="../../../wp-content/themes/fluid-blue/style.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../wp-content/themes/fluid-blue/print.css" type="text/css" media="print" />
<link rel="alternate" type="application/rss+xml" title="about NetApp RSS Feed" href="../../../feed" />
<link rel="pingback" href="../../../xmlrpc.php.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 2.6" />

</head>

<body>
<div id="page">
<div id="header">
	<div id="headertitle">
		<h1><a href="../../../index.html" title="about NetApp: Системы хранения данных как предмет разговора">about NetApp</a></h1>
		<p>Системы хранения данных как предмет разговора</p>
	</div> 
	<!-- Search box (If you prefer having search form as a sidebar widget, remove this block) -->
	<div class="search">
		<form method="get" id="searchform" action="../../../index.html">
<input type="text" size="20" name="s" id="s" value="Поиск..."  onblur="if(this.value=='') this.value='Поиск...';" onfocus="if(this.value=='Поиск...') this.value='';"/>
</form>
	</div> 
	<!-- Search ends here-->
		
</div>

<div id="navbar">
<ul id="nav">
	<li><a href="../../../index.html">Home</a></li>
	<li class="page_item page-item-153"><a href="../../../about/trackback.html" title="about">about</a></li>
<li class="page_item page-item-215"><a href="../../../distributory-v-rossii/trackback.html" title="Дистрибуторы в России">Дистрибуторы в России</a></li>
<li class="page_item page-item-1327"><a href="../../../disti-ua/trackback.html" title="Дистрибуторы в Украине">Дистрибуторы в Украине</a></li>
</ul>
</div>
<div id="wrapper">

	<div id="content">

	
			<p>Archive for Август 2007</p>

				
		<div class="navigation">
			<div class="alignleft"></div>
			<div class="alignright"></div>
		</div>

						
			<div class="post" id="post-41">
				<h2 class="posttitle"><a href="../../41/trackback.html" rel="bookmark" title="Permanent Link to NAS и SAN. Что это. Чем схоже и чем отличается.">NAS и SAN. Что это. Чем схоже и чем отличается.</a></h2>
				<div class="postmetadata">29 Август 2007, 20:53 <!-- от  --></div>
				<div class="postentry">
					<p>Часто приходится сталкиваться с принципиальным непониманием у клиентов разницы между NAS и SAN-подключением внешнего дискового массива.</p>
<p>??так, что есть что, чем отличается друг от друга и какие плюсы-минусы у каждого.</p>
<p><strong>NAS</strong> хорошо знаком большинству пользователей, использующих в локальной сети своей организации файловый сервер. <strong>Файловый сервер - это NAS</strong>. Это устройство, подключенное в локальную сеть и предоставляющее доступ к своим дискам по одному из протоколов &#8220;сетевых файловых систем&#8221;, наример <strong>CIFS</strong> (<em>Common Internet File System</em>) для Windows-систем (раньше называлась SMB - Server Message Blocks) или <strong>NFS</strong> (<em>Network File System</em>) для UNIX/Linux-систем.<br />
Остальные варианты встречаются исчезающе редко.</p>
<p><strong>SAN-устройство</strong>, с точки зрения пользователя, есть просто <strong>локальный диск</strong>.<br />
Обычные варианты протокола доступа к SAN-диску это протокол FibreChannel (FC) и iSCSI (IP-SAN). Для использования SAN в компьютере, который хочет подключиться к SAN, должна быть установлена плата адаптера SAN, которая обычно называется <strong>HBA</strong> - <em>Host Bus Adapter</em>.<br />
Этот адаптер представляет собой с точки зрения компьютера такую своеобразную SCSI-карту и обращается с ней так же, как с обычной SCSI-картой. Отсылает в нее команды SCSI и получает обратно блоки данных по протоколу SCSI. Наружу же эта карта передает блоки данных и команды SCSI, завернутые в пакеты FC или IP для iSCSI.</p>
<p>На приведенном рисунке вы видите 1 диск, подключенный с NAS-устройства (внизу), и один диск, подключенный по SAN по протоколу iSCSI.</p>
<p><img src="/pics/NAS-SAN-pic1.png" /></p>
<p>Здесь мы видим, как SAN-диск виден в диспетчере устройств. Microsoft iSCSI Initiator это софтверный (программный) адаптер протокола iSCSI, представляющийся системе как SCSI-карта, через которую идет обмен данными с SAN-диском.<br />
В случае FC на его месте находился бы HBA FC, он тоже является с точки зрения OS &#8220;SCSI-адаптером&#8221;.</p>
<p><img src="/pics/NAS-SAN-pic2.png" /></p>
<p>Когда мы подключаем компьютер к SAN, нужно сделать rescan all disks и вскоре в Disk Manager появится новый неотформатированный раздел. На нем обычным образом можно создать партицию, отформатировать ее и получить локальный диск, который физически будет являться выделенным разделом на большой системе хранения и соединяться с компьютером оптическим кабелем FC или сетью gigabit ethernet в случае использования iSCSI.</p>
<p><img src="/pics/NAS-SAN-pic3.png" /></p>
<p><img src="/pics/NAS-SAN-pic4.png" /></p>
<p>Каковы же плюсы и минусы обеих этих моделей доступа к данным системы хранения?</p>
<ul>
<li>NAS работает поверх локальной сети, используя обычное сетевое оборудование.</li>
<li>Он работает преимущественно с файлами и информацией, оформленной как файлы (пример: документы общего пользования, word- и excel-файлы).</li>
<li>Он позволяет коллективное использование информации на дисках (одновременный доступ с нескольких компьютеров).</li>
</ul>
<ul>
<li>SAN работает в собственной сети, для использования которой нужен дорогостоящий Host Bus Adapter (HBA).</li>
<li>Он работает на уровне блоков данных. Это могут быть файлы, но это могут быть и нефайловые методы хранения. Например база данных Oracle на т.н. raw-partition.</li>
<li>Для компьютера это локальный диск, поэтому коллективное использование информации на SAN диске обычно невозможно (или делается очень сложно и дорого).</li>
</ul>
<p>Плюсы NAS:</p>
<ul>
<li>дешевизна и доступность его ресурсов не только для отдельных серверов, но и для любых компьютеров организации.</li>
<li>простота коллективного использования ресурсов.</li>
</ul>
<p>минусы NAS:</p>
<ul>
<li>невозможно использовать &#8220;нефайловые&#8221; методы.</li>
<li>доступ к информации через протоколы &#8220;сетевых файловых систем&#8221; зачастую медленнее, чем как к локальному диску.</li>
</ul>
<p>Плюсы SAN:</p>
<ul>
<li>можно использовать блочные методы доступа, хранение &#8220;нефайловой&#8221; информации (часто используется для баз данных, а также для почтовой базы Exchange).</li>
<li>&#8220;низкоуровневый&#8221; доступ к SAN-диску обычно более быстрый, чем через сеть. Гораздо проще сделать очень быстрый доступ к данным с использованием кэширования.</li>
<li>Некоторые приложения работают только с &#8220;локальными дисками&#8221; и не работают на NAS (пример - MS Exchange)</li>
</ul>
<p>Минусы SAN:</p>
<ul>
<li>трудно, дорого или вовсе невозможно осуществить коллективный доступ к дисковому разделу в SAN с двух и более компьютеров.</li>
<li>Стоимость подключения к FC-SAN довольно велика (около 1000-1500$ за плату HBA). Подключение к iSCSI (IP-SAN) гораздо дешевле, но требует поддержки iSCSI на дисковом массиве.</li>
</ul>
<p>??так, что же общего между этими двумя методами? Оба этих метода используются для &#8220;сетевого хранения данных&#8221; (networking data storage).</p>
<p>Что из них лучше? Единственного ответа не существует. Попытка решить задачи NAS с помощью SAN-системы, как и обратная задача, зачастую есть кратчайший путь потратить большие деньги без видимой выгоды и результата. Каждая из этих &#8220;парадигм&#8221; имеет свои сильные стороны, каждая имеет оптимальные методы применения.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../../tag/nas.html" rel="tag">nas</a>, <a href="../../tag/san.html" rel="tag">san</a>, <a href="../../tag/whoiswho.html" rel="tag">whoiswho</a><br />					Раздел: <a href="../../category/justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;" rel="category tag">justread</a>,  <a href="../../category/whoisho/index.html" title="Просмотреть все записи в рубрике &laquo;whoisho&raquo;" rel="category tag">whoisho</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../41/trackback.html#respond" title="Комментарий к записи NAS и SAN. Что это. Чем схоже и чем отличается.">Комментарий</a>									 </div>
			</div>
	
						
			<div class="post" id="post-43">
				<h2 class="posttitle"><a href="../../43/trackback.html" rel="bookmark" title="Permanent Link to Тестирование производительности, part 4.">Тестирование производительности, part 4.</a></h2>
				<div class="postmetadata">28 Август 2007, 19:13 <!-- от  --></div>
				<div class="postentry">
					<p>Приведенные ниже данные получил не я, а один из моих коллег - читателей этого блога, на имеющемся у него оборудовании. Мне эти результаты были особенно интересны, поскольку я еще вживую не сталкивался с самой старшей машиной семейства NetApp FAS - FAS6070A. </p>
<p>Приведенные ниже под катом результаты могут вас шокировать, оскорбить ваши чувства или иным способом задеть ваши убеждения. <em>(Это Disclaimer такой, да;).</em></p>
<p>??менно по этой причине я стараюсь не заниматься сталкиванием вендоров в тестировании и не поддерживать Holy War. Но уж что выросло, то выросло.</p>
<p><a href="../../43/trackback.html#more-43">Читать запись полностью &raquo;</a></p>
				</div>
		
				<div class="postmetadata">
										Раздел: <a href="../../category/news/index.html" title="Просмотреть все записи в рубрике &laquo;новости&raquo;" rel="category tag">новости</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../43/trackback.html#respond" title="Комментарий к записи Тестирование производительности, part 4.">Комментарий</a>									 </div>
			</div>
	
						
			<div class="post" id="post-40">
				<h2 class="posttitle"><a href="../../40/trackback.html" rel="bookmark" title="Permanent Link to Data ONTAP Simulator">Data ONTAP Simulator</a></h2>
				<div class="postmetadata">27 Август 2007, 16:17 <!-- от  --></div>
				<div class="postentry">
					<p>Вполне возможно мне уже удалось заинтересовать некоторых моих читателей возможностями систем хранения Network Appliance. Однако одно дело слушать рассказы, а совсем другое - попробовать самому, ибо &#8220;даже маленькая практика стоит большой теории&#8221;.</p>
<p>?? тут я хотел бы рассказать о существовании поистине уникального для рынка систем хранения продукта - Симуляторе системы хранения NetApp. </p>
<p>Пожалуй самым правильным будет процитировать тут <a href="http://blogs.netapp.com/dave/2006/11/simulate_netapp.html">заметку Dave Hitz</a> в блоге NetApp об этом продукте:</p>
<blockquote><p>Несколько лет назад мы начали получать жалобы от системных администраторов, которые использовали системы NetApp, примерно такого вида:</p>
<p><em>&#8220;Мне хочется попробовать новые возможности вашего нового релиза Data ONTAP, но все мои системы в продакшне, а мой босс не хочет покупать &#8220;железо&#8221; для моих экспериментов&#8221;</em></p>
<p>Чтобы решить эту проблему мы выпустили &#8220;ONTAP Simulator&#8221;. Симулятор это полная версия Data ONTAP, которая работает как процесс под Linux. Вместо реальных жестких дисков она открывает файлы с именами disk.1, disk.2 и так далее. Вместо физической сетевой карты она перехватывает raw-пакеты из Linux ethernet-драйвера.</p>
<p>Это отличный инструмент для обучения нашему Data ONTAP. Попробуйте новые возможности, или, например, убедитесь, что комбинация возможностей работает так как обещано. Вы можете удалить один из файлов дисков, чтобы увидеть, что произойдет в случае выхода из строя диска, или отредактировать дисковый файл в двоичном редакторе, чтобы увидеть что получается в случае дисковых ошибок.</p>
<p>Мы также используем симулятор в наших учебных классах. Нам больше не нужно держать 30 систем для 30 студентов. Мы используем несколько физических систем для того чтобы показать, например, процедуру замены жесткого диска, когда безусловно нужно видеть реальное &#8220;железо&#8221;, но большинство учащихся используют симулятор. Это уменьшает шум, сберегает электричество и снижает затраты на транспорт при выездном обучении.</p>
<p>Сперва люди только игрались им, но некоторые пользователи вскоре сумели сделать кое-что посерьезнее. Они используют симулятор для тестирования сложных конфигураций, включающих в себя системы с кластеризацией, удаленным реплицированием и долговременным архивированием информации, все с помощью нескольких симуляторов в одной Linux PC. Пользователи сообщали мне, что оказалось гораздо проще и быстрее найти ошибки конфигурации на симуляторе, чем если бы это было на реальном оборудовании, и это могло быть сделано еще до того как это реальное оборудование было куплено, привезено и установлено.<br />
Пользователи используют симулятор также для того, например, чтобы познакомиться с новой версией OS Data ONTAP до апгрейда, для проверки как это заработает в их сетевой структуре и для отладки скриптов управления. Пользователям даже удалось выловить несколько багов Data ONTAP. За исключением низкоуровневых драйверов, симулятор <strong>в точности тот же самый код</strong>, что работает в реальном Data ONTAP, так что вы видите ровно то, как поведет себя реальная система. <em>(С некоторыми исключениями: симулятор медленнее, у него жесткий лимит по доступной дисковой емкости, и мы не эмулируем FС, так что блочный доступ может быть только iSCSI).</em></p>
<p>Симулятор также &#8220;взросл&#8221; как и сам ONTAP. Когда мы были маленькой компанией-стартапом, мы сделали симулятор еще до того, как получили реальное &#8220;железо&#8221;. Позже инженеры обнаружили, что чаще быстрее и проще запускать эмулятор, чем загружать новую OS в реальную систему. Кроме этого инструменты дебаггинга удобнее работали в локальном процессе, чем в &#8220;железном&#8221; устройстве. Мы использовали симулятор в разработке почти 10 лет, прежде чем придумали, что это может быть также отличным инструментом для пользователей.</p>
<p>На этот момент многие тысячи пользователей скачали симулятор. Может конечно мы и не продали несколько &#8220;железных&#8221; систем в результате, но я уверен, что большинство из этих людей просто не могут себе позволить купить дополнительное оборудование только чтобы &#8220;поиграться&#8221;. ??ными словами я думаю, что все, что позволит системным администраторам чуствовать комфорт при работе с нашими системами это наша выгода в долгосрочной перспективе, даже если мы теряем несколько продаж в краткосрочной.</p>
</blockquote>
<p>В принципе загрузка симулятора доступна только действующим клиентам и партнерам компании, однако для настойчивого и умелого интернетчика, умеющего <a href="http://www.google.ru/search?hl=ru&amp;q=Data+ONTAP+Simulator+ISO&amp;lr=">пользоваться поиском </a>нет <a href="http://rapidshare.com/users/F5JY14">проблем найти</a> его и <a href="http://keriomail.googlepages.com/">в свободном доступе</a>.</p>
<p>Симулятор снабжен документацией и инструкцией по установке. Там есть несколько тонких моментов, поэтому убедитесь, что вы прочли инструкцию до конца и поняли ее.</p>
<p>При необходимости можно даже установить &#8220;симулятор в симуляторе&#8221;, например я на своем рабочем ноутбуке использую ONTAP Simulator запущенный внутри виртуальной машины с установленным Linux-ом, работающей на бесплатном VMware Player. Конечно быстродействие такой системы оставляет желать лучшего, однако это вполне работоспособное решение при наличии досточного количества памяти на хост-машине.<br />
Разнообразные готовые &#8220;виртуальные машины&#8221; с установленным Linux можно свободно скачать <a target="_blank" href="http://www.vmware.com/appliances/directory/cat/45">с вебсайта VMware</a>.</p>
<p>Хочу напоследок также привлечь ваше внимание к тому факту, что если у вас есть по настоящему серьезный интерес к системам NetApp, и вы хотите не просто поэкспериментировать с конфигурированием, но и включить в свою реальную IT-систему настоящую систему хранения, например для оценки производительности или для тестирования в &#8220;боевых условиях&#8221;, то все партнеры компании имеют (должны иметь по крайней мере, если это настоящие, серьезные партнеры NetApp) демо-оборудование, которое можно получить на тестирование.</p>
<p>Что еще почитать:<br />
<a href="http://www.oracle.com/technology/pub/articles/garg-netapp-simulator.html"><strong>Learning Oracle RAC with the NetApp Simulator</strong></a><br />
<em>by Sachin Garg</em></p>
<p><a href="http://blog.scottlowe.org/2006/06/27/netapp-ontap-simulator-and-esx-server/"><strong>NetApp ONTAP Simulator and ESX Server</strong></a><br />
<em>blog.scottlowe.org</em></p>
<p><a href="http://blog.scottlowe.org/2006/07/10/iscsi-and-esx-server-3/"><strong>iSCSI and ESX Server 3</strong></a><br />
<em>blog.scottlowe.org</em></p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../../tag/netapp/index.html" rel="tag">netapp</a>, <a href="../../tag/simulator.html" rel="tag">simulator</a>, <a href="../../tag/techtalk/index.html" rel="tag">techtalk</a><br />					Раздел: <a href="../../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../40/trackback.html#comments" title="Комментарий к записи Data ONTAP Simulator">Комментарии (4)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-42">
				<h2 class="posttitle"><a href="../../42/trackback.html" rel="bookmark" title="Permanent Link to SnapManager">SnapManager</a></h2>
				<div class="postmetadata">22 Август 2007, 20:21 <!-- от  --></div>
				<div class="postentry">
					<p>Одним из результатов длительного технологического партнерства NetApp с такими компаниями как Oracle, Microsoft, SAP, Veritas/Symantec (и, с недавних пор, VMware) стала разработка семейства продуктов SnapManager.<br />
SnapManager это программа, устанавливаемая на сервер, работающий с системой хранения NetApp, и позволяющая использовать функциональность снэпшотов для какой-либо прикладной системы, например MS Exchange, MS SQL Server, Oracle или SAP.</p>
<p>Для чего понадобилось создавать отдельный продукт для использования снэпшотов?</p>
<p>Во первых это позволяет упростить операции и управлять ими не из консоли самой системы хранения, а из привычного администраторского интерфейса соответствующей серверной системы.</p>
<p>Во вторых ряд приложений требуют для использования снэпшотов некоторых дополнительных действий. Поскольку, как я рассказывал ранее, снэпшот мгновенен (время фиксации - миллисекунды), то это может создать специфические проблемы, например для транзакционных баз данных.<br />
Такая база данных при работе часто имеет открытыми продолжительные транзакции, например &#8220;длинный&#8221; SELECT и так далее. Очевидно, что в случае мгновенного снэпшота, сделанного без учета задачи, для которой он берется, он может создать больше проблем, чем решений их. Например, снэпшот, взятый в момент незакончившейся проводки операции продажи может создать неконсистентную копию (&#8221;товар списался, а деньги не зачислились&#8221;), которая в дальнейшем может создать большие проблемы, например при попытке ее использовать для восстановления после сбоя.<br />
Решением будет так называемый режим hot backup, когда база данных должна завершить текущие транзакции и попридержать новые поступающие на ту секунду, когда система хранения создаст снэпшот текущего хранилища. Весьма желательно при восстановлении раздела из снэпшота провести проверку его на валидность, отсутствие логических повреждений содержимого, и так далее.<br />
Для всего этого и был создан SnapManager.</p>
<p>Путем глубокой интеграции в API соответствующих приложений SnapManager может производить всю необходимую сложную рутину согласованной работы приложения и системы хранения автоматически, сведя всю сложность настройки и управления к условным &#8220;двум кнопкам&#8221; - &#8220;Сохранить&#8221; и &#8220;Восстановить&#8221;. Все прочие формальности обеспечения взаимодействия прикладной задачи, такой как MS Exchange, Oracle или MS SQL Server, с системой хранения берет на себя SnapManager.</p>
<p>В настоящий момент в семейство продуктов входят:<br />
Snapmanager for Exchange 2000/2003/2007<br />
for MS SQL Server<br />
for Oracle 9i and 10g on UNIX/Linux (Windows ожидается)<br />
for SAP (on Solaris/Oracle)<br />
for Sharepoint Portal Server.</p>
<p>Еще почитать:</p>
<p><strong><a href="http://www.netapp.com/library/tr/3554.pdf">SnapManager 2.0 for Oracle:<br />
Leveraging NetApp Data ONTAP 7G for Database Backup, Recovery, and Clone Management</a></strong><br />
<em>Tushar Patel Network Appliance, Inc. December 2006 | TR-3554 </em></p>
<p><strong><a href="http://www.netapp.com/library/tr/3233.pdf">SnapManager 3.2 for Microsoft Exchange<br />
Best Practices</a></strong><br />
<em>Shannon Flynn, Network Appliance, Inc. August 2006 | TR-3233</em></p>
<p><strong><a href="http://www.netapp.com/library/tr/3452.pdf">Best Practices Guide:<br />
SnapManager for Oracle with Oracle 9i and Oracle 10g</a></strong><br />
<em>Blaine McFadden, Network Appliance, Inc. June 2006 | TR-3452</em></p>
				</div>
		
				<div class="postmetadata">
										Раздел: <a href="../../category/news/index.html" title="Просмотреть все записи в рубрике &laquo;новости&raquo;" rel="category tag">новости</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../42/trackback.html#comments" title="Комментарий к записи SnapManager">Комментарии (2)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-39">
				<h2 class="posttitle"><a href="../../39/trackback.html" rel="bookmark" title="Permanent Link to Снэпшоты / Snapshots">Снэпшоты / Snapshots</a></h2>
				<div class="postmetadata">20 Август 2007, 19:29 <!-- от  --></div>
				<div class="postentry">
					<p>Одной из важных особенностей и &#8221;интересностей&#8221; систем хранения Network Appliance является примененная в них технология снэпшотов (snapshots).</p>
<p>Ранее я уже писал о том, что сама технология снэпшотов в системах хранения данных <a target="_blank" href="http://patft.uspto.gov/netacgi/nph-Parser?patentnumber=5819292">была изобретена </a>в NetApp и само слово является trademark компании, именно потому конкуренты вынуждены придумывать разнообразные собственные названия для подобных технологий, таких как PowerSnap (EMC), QuickShadow (HDS) и так далее.</p>
<p>Какие же технологии создания снэпшотов существуют?</p>
<p><strong>Full Clone (или &#8220;Split-Mirror&#8221;)</strong><br />
Наиболее простое и &#8220;лобовое&#8221; решение. Мы резервируем место, равное по объему тому LUN, для которого мы хотим выполнить snapshot. При необходимости иметь несколько снэпшотов место пропорционально увеличивается.<br />
По команде на создание снэпшота контроллер системы хранения по внутренней магистрали данных начинает быстро копировать содержимое LUN в зарезервированную область. Либо же постоянно поддерживает &#8220;зеркало&#8221; (&#8221;mirror&#8221;), а в момент &#8220;создания снэпшота&#8221; репликация основного раздела в &#8220;зеркало&#8221; останавливается (&#8221;split&#8221;)<br />
<strong><em>Плюсы:</em></strong> наш snapshot это полная физическая копия LUN-а. На этом плюсы исчерпываются и начинаются минусы.<br />
<strong><em>Минусы:</em></strong> Непроизводительные потери места на диске на зарезервированный под снэпшоты объем. Снэпшот не мгновенен (в случае full clone), либо удваивает количество операций записи в случае split-mirror. Время его создания зависит от объемов LUN-а (а также загрузки контроллера системы хранения). Процесс копирования сильно нагружает контроллер и приводит к значительному падению производительности системы хранения на время создания снэпшота.</p>
<p><strong>Copy-on-Write (или Point-in-Time)<br />
</strong>Попыткой решить основные проблемы снэпшота типа <em>Full Clone</em> явился снэпшот типа <em>Copy-on-write</em>. Основная идея его была такова: Если главная проблема в том, чтобы одномоментно копировать большой объем данных, то давайте будем копировать только изменяемые блоки, оставляя неизменные на своих прежних местах. При этом исходные блоки будут копироваться туда только тогда, когда прикладная система захочет их изменить. ?? вместо полной копии мы получим инкрементальную. В пул свободных блоков, зарезервированных под снэпшот, попадут только измененные в LUN-е блоки. Таким образом текущий LUN есть тот LUN как он есть, а в снэпшоте этого LUN ссылки на измененные блоки будут заменены на ссылки в пул снэпшота, на неизмененные версии блоков, скопированные туда перед их изменением.<br />
Copy-on-Write - &#8220;Копирование-при-записи&#8221;<br />
<strong><em>Плюсы:</em></strong> гораздо экономнее расходуется место. Нет необходимости сразу резервировать полный объем LUN-а. Один пул может обслуживать все LUN-ы системы хранения, расходуясь по мере накопления изменений.<br />
<strong><em>Минусы:</em></strong> Кажда операция записи в случае использования copy-on-write превращается в три. Сперва прочитать исходный блок, затем перенести (записать) его в пул, и, наконец, записать блок, который мы изначально хотели записать.<br />
То есть каждая операция записи становится операциями &#8220;чтение-запись-запись&#8221;. С соответствующим влиянием на общую производительность системы хранения.</p>
<p><strong><em>Какое же решение использует NetApp?</em></strong><br />
<strong>Третье.</strong><br />
Тут следует вспомнить тот факт, что в основании системы хранения лежит собственная внутренняя файловая система NetApp под названием <a target="_blank" href="../../19/trackback.html">WAFL - Write Anywhere File Layout</a>.<br />
Одной из ее особенностей является то, что файловая система устроена так, что никогда не перезаписывает блоки, единожды записанные на диск, до полного удаления файла, лишь дописывая его и изменяя указатели на актуальную &#8220;таблицу размещения файлов&#8221;.</p>
<p><img style="display: inline" title="Snapshots" alt="Snapshots" src="/pics//snapshots.gif" width="462" height="250"></p>
</p>
<p>Такая схема позволяет реализовать функцию снэпшота очень просто и изящно. Ведь в любой момент времени сохраненная &#8220;таблица размещения файлов&#8221; размером в пределах килобайта, и будет таким снэпшотом, поскольку ранее записанные блоки, на которые она ссылается, никогда больше заведомо не изменятся.</p>
<p>Ситуация в каком-то смысле обратная технологии copy-on-write, в отличие от нее мы не переносим исходное содержимое блоков &#8220;в сторону&#8221;, перезаписывая его затем. Мы наоборот, производим &#8220;перезапись&#8221; путем записи нового блока &#8220;в сторону&#8221;, оставляя прежний блок на месте, а затем просто переставляем на новый блок указатель в &#8220;актуальной&#8221; &#8220;таблице размещения файлов&#8221; (на самом деле &#8220;таблице inodes&#8221;, поскольку Data ONTAP и WAFL несет в основе своей близкую к unix-подобной схему организации файловой системы).</p>
<p><em><strong>Что это нам дает?<br />
</strong>Во первых</em> количество снапшотов становится практически неограниченным. В настоящий момент количество снэпшотов на том равно 255, количество томов - 500 (на контроллер). Отсюда легко видно, что общее количество снэпшотов, которые теоретически можно использовать на системе хранения NetApp равно 127000. Это значительно выше обычного числа в 8-14 снэпшотов на систему для большинства конкурентов.<br />
<em>Второй момент</em> заключается в том, что снэпшоты <a target="_blank" href="http://blog.aboutnetapp.ru/pics/snapimpact.gif">не ухудшают параметры </a>системы хранения при своем создании и использовании. ??менно это ухудшение вызывает необходимость ограничить количество снэпшотов на систему хранения в случае снэпшотов вида copy-on-write.<br />
<em>Третий момент</em> - снэпшоты занимают на диске ровно то место, которое равно по объему изменениям между снэпшотами. То есть не объем LUN-а и даже не объем зарезервированного pool-а. А просто объем изменений. Нет изменений - место не занимается. Точка.<br />
Ну и наконец немаловажный факт - снэпшоты в системах хранения NetApp есть всегда и при этом<strong> бесплатны</strong>. Они просто есть. Это такое же свойство файловой системы WAFL и OS Data ONTAP как, например, hardlinks и softlinks в линуксной Ext2FS. ??ми можно не пользоваться, но они все равно есть.</p>
<p>Дополнительных денег стоят как правило какие-то дополнительные функции для использования снэпшотов, например SnapRestore для восстановления тома целиком, SnapManager - ПО для использования функциональности snapshots с прикладной задачей, такой как Exchange, Oracle или MS SQL или SnapDrive - ПО для управления, создания и использования снэпшотов непосредственно с хост-сервера Windows или UNIX/Linux. О практическом использовании снэпшотов в дополнительных программных продуктах, использующих возможности снэпшотов в системе ханения NetApp, и о том, что эти продукты дают на практике я еще подробнее напишу отдельным постом.</p>
<p> Еще почитать:</p>
<p><a target="_blank" href="http://www.netapp.com/library/tr/3002.pdf"><strong>File System Design for an NFS  File Server Appliance <br />
</strong></a><em>Dave Hitz, James Lau, &amp; Michael Malcolm | Network Appliance | TR 3002</em></p>
<p><a target="_blank" href="http://www.netapp.com/library/tr/3202.pdf"><strong>BEST PRACTICES GUIDE FOR DATA PROTECTION WITH FILERS RUNNING FCP </strong></a><br />
<em>Nick Wilhelm-Olsen, Brett Cooper | October 1, 2002 | TR3202 </em></p>
<p><strong><a target="_blank" href="http://www.netapp.com/library/tr/3210.pdf">Oracle9i for UNIX:  Backup and Recovery Using a NetApp Filer in a SAN Environment</a><br />
</strong><em>Richard Jooss | Brian Casper | 04/2004 | TR 3210</em></p>
<p><strong><a target="_blank" href="http://www.oracle.com/technology/deploy/availability/pdf/oscp_snapshot_use.pdf">Guidelines for Using Snapshot Storage Systems for Oracle Databases<br />
</a></strong><em>Nabil Osorio and Bill Lee, Oracle Corporation October 2001</em></p>
				</div>
		
				<div class="postmetadata">
										Раздел: <a href="../../category/news/index.html" title="Просмотреть все записи в рубрике &laquo;новости&raquo;" rel="category tag">новости</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../39/trackback.html#comments" title="Комментарий к записи Снэпшоты / Snapshots">Комментарии (5)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-28">
				<h2 class="posttitle"><a href="../../28/trackback.html" rel="bookmark" title="Permanent Link to Тестирование производительности, part 3.">Тестирование производительности, part 3.</a></h2>
				<div class="postmetadata">16 Август 2007, 8:58 <!-- от  --></div>
				<div class="postentry">
					<p>Сравнительные результаты систем FAS270 и FAS3020</p>
<p> Перед чтением рекомендую ознакомиться с <a href="../../../index.html%3Fp=26.html"><font color="#115577">дисклеймером</font></a></p>
<p><a href="../../28/trackback.html#more-28">Читать запись полностью &raquo;</a></p>
				</div>
		
				<div class="postmetadata">
										Раздел: <a href="../../category/news/index.html" title="Просмотреть все записи в рубрике &laquo;новости&raquo;" rel="category tag">новости</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../28/trackback.html#respond" title="Комментарий к записи Тестирование производительности, part 3.">Комментарий</a>									 </div>
			</div>
	
						
			<div class="post" id="post-38">
				<h2 class="posttitle"><a href="../../38/trackback.html" rel="bookmark" title="Permanent Link to Эта мифическая &#8220;Скорость интерфейса&#8221;.">Эта мифическая &#8220;Скорость интерфейса&#8221;.</a></h2>
				<div class="postmetadata">13 Август 2007, 22:09 <!-- от  --></div>
				<div class="postentry">
					<p><strong>&#8220;Скорость FC вдвое(вчетверо) быстрее iSCSI&#8221;. Так ли это?</strong></p>
<p>Давайте рассмотрим подробно.</p>
<p>?? для начала давайте разберем что такое &#8220;скорость&#8221;.<br />
В применении к интерфейсу передачи данных &#8220;скорость&#8221; это скорость передачи электрического сигнала в меди или оптического сигнала в оптоволокне.<br />
Парадоксально, но факт, скорость передачи сигнала что в оптическом FC, что в медном iSCSI близка до такой степени, что мы можем разницу скорости передачи электрического сигнала на физическом уровне проигнорировать. Тем более, что существует также и &#8220;медный&#8221; FC и оптический Ethernet (например 1000Base-FX).<br />
Таким образом на физическом уровне скорость передачи сигналов для обоих интерфейсов близка и несущественна для нашей задачи. Более того, иногда скорость сигнала в оптическом кабеле может быть <a href="../../38/trackback.html#prim">меньше скорости в медном</a>.</p>
<p>Где же кроется разница?</p>
<p>&#8220;Скоростью&#8221; принято неправильно называть &#8220;пропускную способность&#8221;, производительность интерфейса по передаче байт, то есть не &#8220;скорость потока&#8221;, а &#8220;ширину трубы&#8221;. Это прискорбная путаница в понятиях настолько широко распространена, что уже прямо воспринимается как данность.<br />
?? если <em>скорость</em> измеряется в метрах в секунду, то <em>пропускная способность</em> в байтах (литрах, килограммах) в секунду. А это несколько иной предмет, даже несмотря на то, что в &#8220;хакерском&#8221; жаргоне и закрепилось слово &#8220;метр&#8221; для &#8220;мегабайта&#8221;. Но не будем следовать этому прискорбному обычаю.</p>
<p>??так, что же с пропускной спообностью?<br />
Давайте рассмотрим нашу проблему на примере аналогии.</p>
<p>У нас имеется точка А и точка Б. Расстояние между ними для упрощения вычислений - 60 км.<br />
Скорость транспорта на дороге - 60 км/ч.<br />
У нас в наличии имеется два автобуса, ПАЗик на 20 человек и ??карус на 40.<br />
В точку А прибывают пассажиры, которых надо доставить в точку Б.<br />
Если количество пассажиров оказывается, например, 40, то для доставки их из точки А в точку Б нужно одна поездка ??каруса или две поездки ПАЗика. То есть ??карус в данном случае оказывается вдвое эффективнее.<br />
Однако если пассажиров в точке А всего 20 или менее, то <strong>неважно что за автобус мы используем</strong>, в обоих случаях мы перевезем пассажиров за одно и то же время.</p>
<p>При этом &#8220;скорость&#8221; будет в обеих случаях 60 км/ч, то есть оба автобуса потратят один и тот же час на перевозку человекобайта из точки А в точку Б.</p>
<p>Конечно процесс передачи данных по интерфейсу непрерывен и более похож не на автобусы, а на транспортер или эскалатор, а разница в его ширине, в том, сколько человек может встать на ступеньку: один или два.</p>
<p>Но и в этом случае, если производительности меньшего транспортера достаточно для перевозки пассажиропотока (пассажиры не скапливаются на посадке), то разницы в &#8220;скорости&#8221; перемещения &#8220;пассажиров&#8221;-байт между ним и более &#8220;широким&#8221; транспортером не будет. Ведь при этом, как и прежде, скорость этих транспортеров равна.</p>
<p>Таким образом становится очевиден парадоксальный вывод:<br />
<strong>&#8220;Скорость&#8221; интерфейса передачи данных зависит прежде всего от приложения, с ним работающего, а вовсе не от его &#8220;пропускной способности&#8221; в гигабайтах в секунду,<br />
</strong>до тех пор, пока мы не достигаем предела производительности интерфейса.</p>
<p>Если приложение не обеспечивает на одном конце интерфейса количество данных, превышающее по объему 1 гигабит в секунду (и, соответственно, не потребляет их с такой скоростью), то разница для этого приложения между FC и iSCSI будет только в цене.</p>
<blockquote><p><font size="-2">Примечание для экспертов: Я намеренно сейчас уклоняюсь от залезания в дебри обсуждения задержек, initiator и target queues, форматов пакетов, скорости обработки процессорами интерфейсов, &#8220;и прочая и прочая&#8221;. Цель - ухватить суть проблемы и увидеть лес за деревьями.</font></p>
</blockquote>
<p>Создает ли ваше приложение такой траффик к системе хранения данных вы сможете и сами, просто оцените в Windows Perfmon параметр Logical Disk - Disk Reads(Writes) Bytes/sec и Disk Queue для того, чтобы понять, не возникает ли у вас &#8220;очередь&#8221; на входе на &#8220;эскалатор&#8221;.<br />
Подробнее о измерении производительности средствами perfmon <a href="../../13/trackback.html">я писал ранее</a>.</p>
<p><a name="prim" title="prim"></a><em>Примечания:</em><br />
Цитаты:<br />
1. &#8220;<strong>Refractive Index</strong> - все оптически прозрачные материалы имеют коэффициент преломления, равный отношению скорости света в вакууме к скорости света в материале. Для оптоволокна он равен 1,45-1,50, т.е. скорость света в ВОЛС около 200000 км/с&#8221; (<a target="_blank" href="http://ispa-sat.ru/info/abbreviations.htm">тут</a>)<br />
2. &#8220;<strong>Скорость распространения сигнала</strong> по кабелю [Twisted Pair EIA/TIA 568] или, обратный параметр – <span class="keyword">задержка сигнала</span> на метр длины кабеля. &#8230; Типичные величины скорости распространения сигнала – от 0,6 до 0,8 от скорости распространения света в вакууме.&#8221; (<a target="_blank" href="http://www.intuit.ru/department/network/baslocnet/2/baslocnet_2.html">тут</a>)</p>
				</div>
		
				<div class="postmetadata">
										Раздел: <a href="../../category/news/index.html" title="Просмотреть все записи в рубрике &laquo;новости&raquo;" rel="category tag">новости</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../38/trackback.html#comments" title="Комментарий к записи Эта мифическая &#8220;Скорость интерфейса&#8221;.">1 комментарий</a>									 </div>
			</div>
	
						
			<div class="post" id="post-37">
				<h2 class="posttitle"><a href="../../37/trackback.html" rel="bookmark" title="Permanent Link to Тестирование с помощью IOmeter">Тестирование с помощью IOmeter</a></h2>
				<div class="postmetadata">10 Август 2007, 19:42 <!-- от  --></div>
				<div class="postentry">
					<p>Одним из наиболее популярных т.н. &#8220;синтетических&#8221; тестов является программа IOmeter. ??значально эту программу разработали в Intel, но когда процесс разработки остановился, то были открыты исходные коды и в настоящий момент тест поддерживается энтузиастами OpenSource. ??зредка программа обновляется. В настоящий момент основные вебсайты программы это <a href="http://www.iometer.org">www.iometer.org</a> и страница разработки на SourceForge.</p>
<p>К сожалению каких-либо материалов начального уровня, позволяющих сразу разобраться в работе IOmeter, в сети не найдено, поэтому пришлось сделать это самому, а на будущее написать шпаргалку. В значительной мере эта шпаргалка является описанием конкретно моего случая тестирования, поэтому она опускает некоторые возможности, которыми я не пользовался.<br />
Думаю освоив то, что описано здесь, можно разобраться и с остальным.</p>
<p><strong>Описания методики тестирования системы хранения с помощью программы IOmeter (версия 2006.07.27)</strong></p>
<p>Программа состоит из GUI-фронтенда iometer.exe (есть только под windows) и генератора нагрузки dynamo.exe (бывает под windows, linux, solaris, netware), управляемого из GUI по сети.</p>
<p>Запускаем на сервере, к которому подключен тестируемый раздел на системе хранения, программу dynamo из комплекта поставки iometer, она будет осуществлять нагрузку для тестирования.<br />
dynamo бывает под windows, linux, может быть собрана под solaris.</p>
<p>Ключи запуска выводятся по /?</p>
<p>Указывается компьютер (имя или ip), на котором установлен GUI frontend IOmeter. (/i )</p>
<p>Указывается имя &#8220;менеджера&#8221;, на котором запущен dynamo (/n ), будет показано в GUI.</p>
<p>Указывается имя (ip-адрес) компьютера &#8220;менеджера&#8221; для коммуникации с ним по сети. (/m )</p>
<p>Указывается номер порта для связи dynamo и GUI, если не указан, то будет взят по умолчанию 1066. Должен быть свободно пропущен через межсетевые экраны и файрволлы для обеспечения взаимодействия dynamo и IOmeter GUI.</p>
<p>Если небходимо, можно назначить исполнение на конкретном CPU (см. подсказку по /?).</p>
<blockquote><p>Пример:</p>
<p>dynamo /i testadmin /m 192.168.0.10 /n generator001</p>
<p>testadmin - имя (или ip-адрес) компьютера где будет работать iometer<br />
192.168.0.1 - адрес (можно dns-имя) сервера нагрузки (где исполняется dynamo)<br />
generator001 - произвольное имя генератора нагрузки, показываемое в iometer GUI.</p>
</blockquote>
<p>Если dynamo уже запущен, то при старте Iometer тот найдет присутствующие в сети Managers, покажет их и разрешит использование. При отсутствии удаленных dynamo будет запущен локальный dynamo, для тестирования локальных ресурсов.</p>
<p>Каждый процессор менеджера тестирования с запущенным dynamo представлен отдельным worker. На каждый worker можно назначить свой тест.<br />
Worker это процесс, который будет исполнять тест. По умолчанию количество workers равно количеству процессоров (ядер, HyperThreading pseudo-CPUs). Но можно создать дополнительные workers кнопкой на тулбаре.<br />
Дополнительно могут быть добавлены workers для тестирования интерфейсов локальной сети (см. тулбар).<br />
Сброс workers и реконнект к менеджерам там же, на тулбаре.</p>
<p>В Iometer открываем конфигурационный файл, отключаем в параметрах открытия Managers and Workers, чтобы не искало чужих managers, настроенных в конфигурационном файле. В дальнейшем, если записать конфигурационный файл на своей тестировочной инфраструктуре, можно открывать и с настройками workers.</p>
<p>Выбираем нужного нам manager и его worker<br />
В закладке Disk Targets выбираем объект, например смонтированный LUN системы хранения.<br />
<em><strong>Желтым цветом </strong></em>показаны логические дисковые разделы с файловой системой, <strong>ДОСТУПНЫЕ НА ЗАП??СЬ.</strong><br />
<em><strong>Голубым</strong></em> - физические разделы без партиции на них.<br />
<em><strong>Перечеркнутый значок </strong></em>означает, что на диске не найден тестовый файл.<br />
Отмечаем нужный крестиком слева. На данном LUNе (в случае использования файловой системы) будет при первом запуске создан тестовый файл iobw.tst. Операции при тестировании будут проводиться с ним.<br />
<strong>ВН??МАН??Е: по умолчанию этот файл будет занимать все свободное место на диске!</strong><br />
Это может занять продолжительное время при первом запуске. Ожидайте. По завершении создания файла начнется тест. При необходимости тестовый файл может быть обычным образом скопирован на другие разделы, чтобы не создавать его там заново.</p>
<p>Для того, чтобы ограничить размер тестирования введите размер файла в 512b-блоках в поле Maximum Disk Size. Например: &#8220;16777216&#8243; sectors (8GiB).</p>
<p>Starting disk Sector, Outstanding IOs и Test Connection rate оставляем в состоянии по умолчанию.</p>
<p>В закладке Access Specifications в правой панели перечислены импортированные из конфигурационного файла преконфигурированные паттерны.<br />
Выбираем worker у менеджера и добавляем для него из правой в левую панель необходимый паттерн.<br />
Патернов одновременно может быть назначено несколько.<br />
Каждый worker может иметь свои паттерны.<br />
В конкретном случае добавляем только один только одному worker-у.</p>
<p>На закладке Results Display будем наблюдать ход теста.<br />
Варианты вывода: Start of test - накопительный, или Last Update - последний замер. Период замера показывает движок Update Frequency (от 1 секунды до &#8220;бесконечности&#8221;). <em>В случае &#8220;бесконечности&#8221; результаты отображаться не будут.</em><br />
<em><strong>ВН??МАН??Е:</strong></em> это влияет только на отображение результатов, само тестирование непрерывно и в записанном результате будет показано наивысшее значение.</p>
<p>В группе Display назначены по умолчанию 6 индикаторов (от Total I/O per second до Interrupts per second). ??ндикаторы могут быть изменены нажатием на кнопку их имени. Оставим по умолчанию.</p>
<p>В закладке Test Setup указываем имя теста в поле Test Description (это будет занесено в лог тестирования для опознания результатов). Например &#8216;fc dbpattern&#8217;.<br />
Поле Run Time - время исполнения теста. Если тест состоит из нескольких запусков, то это длительность ОДНОГО запуска. Устанавливаем 1 минута.<br />
Поле Ramp Up Time это время &#8220;разгона&#8221; системы перед началом замера. Устанавливаем 15 секунд.<br />
Остальные поля оставляем по умолчанию.</p>
<p>В Cycling Option выбираем из выпадающего списка<br />
<em>&#8220;Cycle # Outstanding IOs &#8212; &#8230;&#8221;<br />
</em>Это установит тестирование с прогрессивно увеличивающимся количеством потоков выполнения (Outstanding IOs).<br />
В поле # of Outstanding IOs указываем<br />
<em>Start:1 End:256 Power:2 Exponential Stepping.</em><br />
При этом количество потоков будет увеличиваться экспоненциально: 1,2,4 &#8230; 128,256.<br />
Значение Outstanding IOs от 1 до 8 относится к очень &#8220;легким&#8221; программам, 128 и 256 - очень &#8220;тяжелым&#8221;. Целиком тест покажет нагрузочную способность в зависимости от интенсивности ввода-вывода от сервера.<br />
Также можно увеличивать количество параллельно работающих workers, не забудьте предварительно их создать и назначить им паттерны нагрузки!<br />
При выборе соответствующих вариантов тестирования становятся доступны поля ввода значений для этих режимов.<br />
Каждый из таких потоков будет исполняться 1 минуту, итого 9 минут (+15 секунд ramp up на каждый тест) на полный тест паттерна.</p>
<p>Все готово.</p>
<p>Нажимаем на Start Tests (зеленый флажок в тулбаре). Если тестовый файл не был создан, то ожидаем, пока он будет создан, после чего начнется тестирование. Будет запрошено имя и раcположение файла результатов (по умолчанию results.csv). Желательно дать имя соответствующее профилю тестирования, например &#8216;fc dbpattern.csv&#8217; для упрощения дальнейшего разбора.<br />
Запустив тест пожно пойти посмотреть текущие результаты на &#8220;градусниках&#8221; в закладке Results Display.<br />
В statusbar внизу программы отображается прогресс выполнения группы тестов.</p>
<p>По завершению тестирования одного паттерна перейти в Access Specifications и поменять паттерн. ??зменить описание теста в Test Setup и запустить новый цикл.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../../tag/iometer.html" rel="tag">iometer</a>, <a href="../../tag/performance/index.html" rel="tag">performance</a>, <a href="../../tag/techtalk/index.html" rel="tag">techtalk</a>, <a href="../../tag/testing.html" rel="tag">testing</a><br />					Раздел: <a href="../../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../37/trackback.html#comments" title="Комментарий к записи Тестирование с помощью IOmeter">Комментарии (5)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-36">
				<h2 class="posttitle"><a href="../../36/trackback.html" rel="bookmark" title="Permanent Link to Thin Provisioning">Thin Provisioning</a></h2>
				<div class="postmetadata">7 Август 2007, 19:25 <!-- от  --></div>
				<div class="postentry">
					<p>Серьезной проблемой при эксплуатации систем хранения является непроизводительный расход распределенного места на дисковом томе.</p>
<p>Одной из причин, приведших к использованию &#8220;сетей хранения&#8221; - SAN - было стремление уйти от жестко &#8220;распределеного&#8221; по серверам пространства хранения. Сервер с двумя дисками 144GB в RAID1 обладает пространством хранения в 144GB, даже если использует для своей работы значительно меньше (например 5GB OS + 15GB DB = 20GB, остаток неиспользуемого пространства - 124GB).<br />
Но, к сожалению, использовать там где оно нужно это неиспользуемое место на локальных дисках DAS (Direct Attached Storage) для работы практически невозможно. Сейчас мы не рассматриваем разные попытки выхода из положения, например путем создания на свободном месте пространства дисков архивной &#8220;файлопомойки&#8221; с помощью DFS или просто в виде множества shares.</p>
<p>Причем необходимость повышения производительности дисковой группы, которая часто возможна только путем увеличения количества задействованных &#8220;шпинделей&#8221;, только усугубляет ситуацию.<br />
Прорывом в этой области явилось использование SAN, то есть объединения пространства всех &#8220;байтов&#8221; на дисках в некое единое поле, из которого можно нарезать столько, сколько необходимо конкретному серверу.</p>
<p>Однако довольно скоро использующие SAN столкнулись с другим вариантом непроизводительного расхода простанства.</p>
<p>Представим себе реальную практическую ситуацию в компании, использующей централизованный SAN-storage.<br />
DB-админ создает новую базу данных, для размещения которой ему нужен новый дисковый раздел (LUN - Logical Unit Number - логический &#8220;диск&#8221; в SAN-сети). Текущий объем базы 10GB. Однако чтобы в случае необходимости была возможность роста объемов DB-админ намеревается просить больше. <em>&#8220;Рост в течении года будет ну например вдвое. Ну хорошо, значит 20GB минимум, ну на всякие непредвиденные расходы попрошу еще 10. ??того 30GB. Как говорится &#8216;проси больше - дадут меньше&#8217;, напишу в заявке 50 GB. Должно хватить.&#8221;</em></p>
<p>Заявка попадает к администратору SAN, которому всегда есть чем заняться кроме как высчитывать место.<br />
<em>&#8220;Ох уж эти мне DB-админы. Куда они столько места расходуют? ?? все ходят, все просят еще и еще. Сколько там? 50GB? ?? через месяц опять придут просить увеличить? Такая морока. Ладно, нарежу им по 75GB, или даже по 100GB, чтобы два раза не вставать, может так хоть оставят в покое подольше?&#8221;</em></p>
<p>??так, реально используемые 10GB данных вольготно расположились на пространстве вдесятеро большем (ну или впятеро, если следовать заявке dbadmin). Беда заключается в том, что, несмотря на все технологические достижения SAN в области экономии пространства, то пространство хранения, которое &#8220;нарезано&#8221; на LUN-ы уже недоступно для использования, кроме как той системой, которой принадлежит LUN, даже в том случае, если оно физически не используется внутри этого LUN-а.<br />
Дорогостоящее пространство на FC-дисках занято, хотя и не используется, и не может быть использовано там, где оно, вдруг может понадобиться. ?? так на каждом из десятков, возможно сотен, LUN-ов.</p>
<p>То есть мы получаем ситуацию, описанную выше с DAS, но на новом технологическом уровне и за значительно б<em>О</em>льшие деньги. ;)<br />
??сследования показывают, что на современных системах хранения степень заполнения LUN-ов данными как правило от четверти до половины его общего объема. ?? это еще достаточно оптимистическая оценка.</p>
<p>??менно решению этой проблемы посвящена концепция <a target="_blank" href="http://en.wikipedia.org/wiki/Thin_provisioning">thin provisioning</a>-а. К сожалению термин этот достаточно новый, и адекватного перевода на русский для него пока не устоялось, я предпочитаю использовать словосочетание &#8220;экономное распределение&#8221;.</p>
<p><a target="_blank" href="http://en.wikipedia.org/wiki/Thin_provisioning">Суть его</a> заключается в том, что в системе хранения пространство, даже если оно выделено какому-то LUN-у, не исключается окончательно из общего пространства &#8220;свободных байтов&#8221; системы хранения, а занимается (и вычитается из него) только по мере реального заполнения этих байтов пользовательскими данными.</p>
<p><img width="517" src="http://blog.aboutnetapp.ru/pics/thinpro.gif" height="270" /></p>
<p>Это некий аналог &#8220;кредитной карточки&#8221; в системах хранения. Ваш &#8220;виртуальный бюджет&#8221;, выделенный &#8220;в кредит&#8221;, обеспеченный массивом свободных денег банка, больше чем физический объем ваших денег на счету банка. А за счет того, что пользователь &#8220;кредитной карточки&#8221; не вычерпывает свой &#8220;кредитный лимит&#8221; немедленно, возникает возможность более гибкого его распределения между всеми пользователями банка.</p>
<p>??спользование thin provisioning-а позволяет эффективно расходовать имеющееся пространство системы хранения, а экономия места на SAN-сторадже может выражаться во вполне осязаемых тысячах долларов, которые пожирает ежегодно бюджет IT-подразделения на неизбежное расширение емкостей хранения. При этом, прошу отметить, вы отнюдь не принуждены экономить и затягивать пояс. Нет, просто в рассмотренном выше случае про базу данных и ее админа, dbadmin получит свои 50GB, по крайней мере размер выделенного LUN-а ему будет такой. Однако из свободного пространства системы хранения вычтется те 10GB, которые он займет своей базой. Ну а когда через год она у него подрастет до 20, вот тогда и вычтется 20. То есть несмотря на выделение вашей кредитной карточке банка &#8216;SAN Bank&#8217; ;) лимита в 20 тысяч долларов, которые вы вправе при необходимости потратить, общий объем доступных банку в этот момент для операций средств отнюдь не уменшается на 20K$.</p>
<p>Если не брать во внимание &#8220;динозавров иных эпох&#8221; типа IBM MVS и прочих мэйнфреймов, первой эту идею реализовала &#8220;в железе&#8221; компания <a target="_blank" href="http://3par.com/products/thinprovisioning.php">3PAR</a> (и следом ряд других столь же малоизвестных пока компаний: Compellent, EqualLogic, Pillar Data), а уж затем о технологии thin provisioning-а заговорили все.</p>
<p>Одной из первых среди крупных вендоров &#8220;первого эшелона&#8221; thin provisioning для своих систем реализовала также и <strong>NetApp</strong>, причем, как и ранее, возможности thin provisioning-а стали доступны в том числе и для ранее выпущенных систем NetApp после обновления внутренней OS.<br />
Это стало возможным не только за счет реализации многих ключевых особенностей систем хранения Network Appliance как встроенных функций внутренней OS, но и за счет продуманной и эффективной внутренней файловой системы WAFL и структур &#8221;виртуализованных томов&#8221; FlexVol в OS Data ONTAP G7, которые позволяют реализовать возможности концепции thin provisioning просто, &#8220;бесшовно&#8221; и с минимальным возможным ущербом для производительности.</p>
<p>??з известных вендоров систем хранения безусловно стоит упомянуть также системы Hitachi Tagmastore USP, в которых этим летом также, в той или иной степени, наконец была реализована идея &#8220;экономного распределения&#8221; емкости с использованием их методов виртуализации (хотя, <a target="_blank" href="http://thestorageanarchist.typepad.com/weblog/2007/07/0014-beware-of-.html">как оказалось</a>, и со множеством ограничений по использованию).<br />
Для NAS эту технологию в какой-то степени реализовала и EMC в своих системах Celerra.</p>
<p>Так или иначе, но идея экономного распределения емкости и эффективной экономии дискового пространства с ее помощью отчеливо захватила вендоров систем хранения данных, и по праву называется сейчас одним из &#8220;хитов сезона&#8221;. ??меет смысл обратить внимание на это решение.</p>
<p><strong>Еще почитать:</strong></p>
<p><a target="_blank" href="http://www.netapp.com/ftp/wp-thin-provisioning.pdf">NETAPP THIN PROVISIONING: BETTER FOR BUSINESS</a><br />
Paul Feresten and Quinn Summers, Network Appliance, Inc.<br />
March 2007 | WP-7017-0307</p>
<p><a target="_blank" href="http://www.netapp.com/library/tr/3483.pdf">Thin Provisioning in a NetApp SAN or IP SAN Enterprise Environment</a><br />
Richard Jooss, Network Appliance, Inc.<br />
June 2006, TR-3483</p>
<p><a target="_blank" href="http://searchstorage.techtarget.com/originalContent/0,289142,sid5_gci1025747,00.html">NetApp eases storage provisioning pain</a><br />
By Jo Maitland, News Director<br />
15 Nov 2004 | SearchStorage.com</p>
<p><a target="_blank" href="http://www.eweek.com/article2/0,1895,2155586,00.asp">Deduplication, Thin Provisioning: Top Storage Trends</a><br />
By Chris Preimesberger July 6, 2007</p>
<p><a target="_blank" href="http://www.3par.com/documents/ESG_Report_Thin_Provisioning_0406.pdf">ESG group analysis: Thin Provisioning</a><br />
By Tony Asaro Senior Analyst April 2006</p>
<p><a target="_blank" href="http://www.3par.com/documents/3PAR-tp-wp-01.2.pdf">3PAR Thin Provisioning</a><br />
By: Geoffrey Hough, Sr. Marketing Manager with Sandeep Singh, Product Manager</p>
				</div>
		
				<div class="postmetadata">
										Раздел: <a href="../../category/news/index.html" title="Просмотреть все записи в рубрике &laquo;новости&raquo;" rel="category tag">новости</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../36/trackback.html#comments" title="Комментарий к записи Thin Provisioning">Комментарии (2)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-27">
				<h2 class="posttitle"><a href="../../27/trackback.html" rel="bookmark" title="Permanent Link to Тестирование производительности, part 2">Тестирование производительности, part 2</a></h2>
				<div class="postmetadata">1 Август 2007, 18:23 <!-- от  --></div>
				<div class="postentry">
					<p>Перед чтением рекомендую ознакомиться с <a href="../../../index.html%3Fp=26.html">дисклеймером</a> к первому посту серии.</p>
<p>Впрочем, не поленюсь тут его повторить:</p>
<p>Это сделанные мной лично тесты на имеющемся у меня в лаборатории оборудовании NetApp и других компаний-вендоров. Данные тесты не спонсированы и никак не связаны с компанией Network Appliance. Результаты тестов не могут считаться официальными данными производительности, приводятся только для удовлетворения любопытства и не подразумевают никаких обещаний со стороны компании или лично меня, <em>blah-blah-blah</em>. Ф-фух. :)</p>
<p><a href="../../27/trackback.html#more-27">Читать запись полностью &raquo;</a></p>
				</div>
		
				<div class="postmetadata">
										Раздел: <a href="../../category/news/index.html" title="Просмотреть все записи в рубрике &laquo;новости&raquo;" rel="category tag">новости</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../27/trackback.html#comments" title="Комментарий к записи Тестирование производительности, part 2">1 комментарий</a>									 </div>
			</div>
	
		
		<div class="navigation">
			<div class="alignleft"></div>
			<div class="alignright"></div>
		</div>
		
	
	</div>
	<div id="sidebar">
		<ul>
			
			
			<!-- Author information is disabled per default. Uncomment and fill in your details if you want to use it.
			<li><h2>Автор</h2>
			<p>A little something about you, the author. Nothing lengthy, just an overview.</p>
			</li>
			-->

			<li class="pagenav"><h2>Страницы</h2><ul><li class="page_item page-item-153"><a href="../../../about/trackback.html" title="about">about</a></li>
<li class="page_item page-item-215"><a href="../../../distributory-v-rossii/trackback.html" title="Дистрибуторы в России">Дистрибуторы в России</a></li>
<li class="page_item page-item-1327"><a href="../../../disti-ua/trackback.html" title="Дистрибуторы в Украине">Дистрибуторы в Украине</a></li>
</ul></li>
			<li><h2>Рубрики</h2>
				<ul>
					<li class="cat-item cat-item-89"><a href="../../category/commands/index.html" title="Просмотреть все записи в рубрике &laquo;commands&raquo;">commands</a>
</li>
	<li class="cat-item cat-item-37"><a href="../../category/howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;">howto</a>
</li>
	<li class="cat-item cat-item-52"><a href="../../category/justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;">justread</a>
</li>
	<li class="cat-item cat-item-51"><a href="../../category/review/index.html" title="Просмотреть все записи в рубрике &laquo;review&raquo;">review</a>
</li>
	<li class="cat-item cat-item-3"><a href="../../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;">techtalk</a>
</li>
	<li class="cat-item cat-item-71"><a href="../../category/tricks/index.html" title="Просмотреть все записи в рубрике &laquo;tricks&raquo;">tricks</a>
</li>
	<li class="cat-item cat-item-95"><a href="../../category/utilities/index.html" title="Просмотреть все записи в рубрике &laquo;utilities&raquo;">utilities</a>
</li>
	<li class="cat-item cat-item-44"><a href="../../category/whoisho/index.html" title="Просмотреть все записи в рубрике &laquo;whoisho&raquo;">whoisho</a>
</li>
	<li class="cat-item cat-item-1"><a href="../../category/news/index.html" title="Просмотреть все записи в рубрике &laquo;новости&raquo;">новости</a>
</li>
	<li class="cat-item cat-item-387"><a href="../../category/opros.html" title="Просмотреть все записи в рубрике &laquo;опрос&raquo;">опрос</a>
</li>
	<li class="cat-item cat-item-8"><a href="../../category/translations/index.html" title="Просмотреть все записи в рубрике &laquo;переводы&raquo;">переводы</a>
</li>
	<li class="cat-item cat-item-40"><a href="../../category/citaty/index.html" title="Просмотреть все записи в рубрике &laquo;цитаты&raquo;">цитаты</a>
</li>
				</ul>
			</li>

			<li><h2>Архивы</h2>
				<ul>
					<li><a href='../2018/01.html' title='Январь 2018'>Январь 2018</a></li>
	<li><a href='../2015/10.html' title='Октябрь 2015'>Октябрь 2015</a></li>
	<li><a href='../2015/04.html' title='Апрель 2015'>Апрель 2015</a></li>
	<li><a href='../2015/03.html' title='Март 2015'>Март 2015</a></li>
	<li><a href='../2015/01.html' title='Январь 2015'>Январь 2015</a></li>
	<li><a href='../2014/12.html' title='Декабрь 2014'>Декабрь 2014</a></li>
	<li><a href='../2014/11.html' title='Ноябрь 2014'>Ноябрь 2014</a></li>
	<li><a href='../2014/10.html' title='Октябрь 2014'>Октябрь 2014</a></li>
	<li><a href='../2014/09.html' title='Сентябрь 2014'>Сентябрь 2014</a></li>
	<li><a href='../2014/08.html' title='Август 2014'>Август 2014</a></li>
	<li><a href='../2014/07.html' title='Июль 2014'>Июль 2014</a></li>
	<li><a href='../2014/06.html' title='Июнь 2014'>Июнь 2014</a></li>
	<li><a href='../2014/05.html' title='Май 2014'>Май 2014</a></li>
	<li><a href='../2014/04.html' title='Апрель 2014'>Апрель 2014</a></li>
	<li><a href='../2014/03.html' title='Март 2014'>Март 2014</a></li>
	<li><a href='../2014/02.html' title='Февраль 2014'>Февраль 2014</a></li>
	<li><a href='../2014/01.html' title='Январь 2014'>Январь 2014</a></li>
	<li><a href='../2013/12.html' title='Декабрь 2013'>Декабрь 2013</a></li>
	<li><a href='../2013/11.html' title='Ноябрь 2013'>Ноябрь 2013</a></li>
	<li><a href='../2013/10.html' title='Октябрь 2013'>Октябрь 2013</a></li>
	<li><a href='../2013/09.html' title='Сентябрь 2013'>Сентябрь 2013</a></li>
	<li><a href='../2013/08.html' title='Август 2013'>Август 2013</a></li>
	<li><a href='../2013/07.html' title='Июль 2013'>Июль 2013</a></li>
	<li><a href='../2013/06.html' title='Июнь 2013'>Июнь 2013</a></li>
	<li><a href='../2013/05.html' title='Май 2013'>Май 2013</a></li>
	<li><a href='../2013/04.html' title='Апрель 2013'>Апрель 2013</a></li>
	<li><a href='../2013/03.html' title='Март 2013'>Март 2013</a></li>
	<li><a href='../2013/02.html' title='Февраль 2013'>Февраль 2013</a></li>
	<li><a href='../2013/01.html' title='Январь 2013'>Январь 2013</a></li>
	<li><a href='../2012/12.html' title='Декабрь 2012'>Декабрь 2012</a></li>
	<li><a href='../2012/11.html' title='Ноябрь 2012'>Ноябрь 2012</a></li>
	<li><a href='../2012/10.html' title='Октябрь 2012'>Октябрь 2012</a></li>
	<li><a href='../2012/09.html' title='Сентябрь 2012'>Сентябрь 2012</a></li>
	<li><a href='../2012/08.html' title='Август 2012'>Август 2012</a></li>
	<li><a href='../2012/07.html' title='Июль 2012'>Июль 2012</a></li>
	<li><a href='../2012/06.html' title='Июнь 2012'>Июнь 2012</a></li>
	<li><a href='../2012/05.html' title='Май 2012'>Май 2012</a></li>
	<li><a href='../2012/04.html' title='Апрель 2012'>Апрель 2012</a></li>
	<li><a href='../2012/03.html' title='Март 2012'>Март 2012</a></li>
	<li><a href='../2012/02.html' title='Февраль 2012'>Февраль 2012</a></li>
	<li><a href='../2012/01.html' title='Январь 2012'>Январь 2012</a></li>
	<li><a href='../2011/12.html' title='Декабрь 2011'>Декабрь 2011</a></li>
	<li><a href='../2011/11.html' title='Ноябрь 2011'>Ноябрь 2011</a></li>
	<li><a href='../2011/10/index.html' title='Октябрь 2011'>Октябрь 2011</a></li>
	<li><a href='../2011/09/index.html' title='Сентябрь 2011'>Сентябрь 2011</a></li>
	<li><a href='../2011/08.html' title='Август 2011'>Август 2011</a></li>
	<li><a href='../2011/07/index.html' title='Июль 2011'>Июль 2011</a></li>
	<li><a href='../2011/06/index.html' title='Июнь 2011'>Июнь 2011</a></li>
	<li><a href='../2011/05/index.html' title='Май 2011'>Май 2011</a></li>
	<li><a href='../2011/04/index.html' title='Апрель 2011'>Апрель 2011</a></li>
	<li><a href='../2011/03/index.html' title='Март 2011'>Март 2011</a></li>
	<li><a href='../2011/02.html' title='Февраль 2011'>Февраль 2011</a></li>
	<li><a href='../2011/01.html' title='Январь 2011'>Январь 2011</a></li>
	<li><a href='../2010/12.html' title='Декабрь 2010'>Декабрь 2010</a></li>
	<li><a href='../2010/11/index.html' title='Ноябрь 2010'>Ноябрь 2010</a></li>
	<li><a href='../2010/10/index.html' title='Октябрь 2010'>Октябрь 2010</a></li>
	<li><a href='../2010/09/index.html' title='Сентябрь 2010'>Сентябрь 2010</a></li>
	<li><a href='../2010/08.html' title='Август 2010'>Август 2010</a></li>
	<li><a href='../2010/07/index.html' title='Июль 2010'>Июль 2010</a></li>
	<li><a href='../2010/06.html' title='Июнь 2010'>Июнь 2010</a></li>
	<li><a href='../2010/05.html' title='Май 2010'>Май 2010</a></li>
	<li><a href='../2010/04/index.html' title='Апрель 2010'>Апрель 2010</a></li>
	<li><a href='../2010/03/index.html' title='Март 2010'>Март 2010</a></li>
	<li><a href='../2010/02.html' title='Февраль 2010'>Февраль 2010</a></li>
	<li><a href='../2010/01.html' title='Январь 2010'>Январь 2010</a></li>
	<li><a href='../2009/12/index.html' title='Декабрь 2009'>Декабрь 2009</a></li>
	<li><a href='../2009/11/index.html' title='Ноябрь 2009'>Ноябрь 2009</a></li>
	<li><a href='../2009/10.html' title='Октябрь 2009'>Октябрь 2009</a></li>
	<li><a href='../2009/09.html' title='Сентябрь 2009'>Сентябрь 2009</a></li>
	<li><a href='../2009/08/index.html' title='Август 2009'>Август 2009</a></li>
	<li><a href='../2009/07/index.html' title='Июль 2009'>Июль 2009</a></li>
	<li><a href='../2009/06.html' title='Июнь 2009'>Июнь 2009</a></li>
	<li><a href='../2009/05.html' title='Май 2009'>Май 2009</a></li>
	<li><a href='../2009/04.html' title='Апрель 2009'>Апрель 2009</a></li>
	<li><a href='../2009/03.html' title='Март 2009'>Март 2009</a></li>
	<li><a href='../2009/02.html' title='Февраль 2009'>Февраль 2009</a></li>
	<li><a href='../2009/01.html' title='Январь 2009'>Январь 2009</a></li>
	<li><a href='../2008/12.html' title='Декабрь 2008'>Декабрь 2008</a></li>
	<li><a href='../2008/11.html' title='Ноябрь 2008'>Ноябрь 2008</a></li>
	<li><a href='../2008/10.html' title='Октябрь 2008'>Октябрь 2008</a></li>
	<li><a href='../2008/09.html' title='Сентябрь 2008'>Сентябрь 2008</a></li>
	<li><a href='../2008/08.html' title='Август 2008'>Август 2008</a></li>
	<li><a href='../2008/03.html' title='Март 2008'>Март 2008</a></li>
	<li><a href='../2008/02.html' title='Февраль 2008'>Февраль 2008</a></li>
	<li><a href='12.html' title='Декабрь 2007'>Декабрь 2007</a></li>
	<li><a href='11.html' title='Ноябрь 2007'>Ноябрь 2007</a></li>
	<li><a href='10.html' title='Октябрь 2007'>Октябрь 2007</a></li>
	<li><a href='09.html' title='Сентябрь 2007'>Сентябрь 2007</a></li>
	<li><a href='08.html' title='Август 2007'>Август 2007</a></li>
	<li><a href='07/index.html' title='Июль 2007'>Июль 2007</a></li>
	<li><a href='06.html' title='Июнь 2007'>Июнь 2007</a></li>
	<li><a href='05.html' title='Май 2007'>Май 2007</a></li>
				</ul>
			</li>

			
					</ul>
	</div>

</div> <!-- wrapper -->
<div id="footer">
	<a href="../../../feed">Entries (RSS)</a> and <a href="../../../comments/feed">Comments (RSS)</a>. Valid <a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional"><abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a> and <a href="http://jigsaw.w3.org/css-validator/check/referer"><abbr title="Cascading Style Sheets">CSS</abbr></a>.<br />
	Powered by <a href="http://wordpress.org/" title="Powered by WordPress.">WordPress</a> and <a href="http://srinig.com/wordpress/themes/fluid-blue/">Fluid Blue theme</a>.<br />
	<!-- 14 queries. 0.102 seconds. -->
	</div>
</div> <!-- page -->
</body>
</html>
