<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="ru-RU">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>about NetApp   &raquo; iscsi</title>

<link rel="stylesheet" href="../../../wp-content/themes/fluid-blue/style.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../wp-content/themes/fluid-blue/print.css" type="text/css" media="print" />
<link rel="alternate" type="application/rss+xml" title="about NetApp RSS Feed" href="../../../feed" />
<link rel="pingback" href="../../../xmlrpc.php.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 2.6" />

</head>

<body>
<div id="page">
<div id="header">
	<div id="headertitle">
		<h1><a href="../../../index.html" title="about NetApp: Системы хранения данных как предмет разговора">about NetApp</a></h1>
		<p>Системы хранения данных как предмет разговора</p>
	</div> 
	<!-- Search box (If you prefer having search form as a sidebar widget, remove this block) -->
	<div class="search">
		<form method="get" id="searchform" action="../../../index.html">
<input type="text" size="20" name="s" id="s" value="Поиск..."  onblur="if(this.value=='') this.value='Поиск...';" onfocus="if(this.value=='Поиск...') this.value='';"/>
</form>
	</div> 
	<!-- Search ends here-->
		
</div>

<div id="navbar">
<ul id="nav">
	<li><a href="../../../index.html">Home</a></li>
	<li class="page_item page-item-153"><a href="../../../about/trackback.html" title="about">about</a></li>
<li class="page_item page-item-215"><a href="../../../distributory-v-rossii/trackback.html" title="Дистрибуторы в России">Дистрибуторы в России</a></li>
<li class="page_item page-item-1327"><a href="../../../disti-ua/trackback.html" title="Дистрибуторы в Украине">Дистрибуторы в Украине</a></li>
</ul>
</div>
<div id="wrapper">

	<div id="content">

	
			<p>Posts tagged &#8216;iscsi&#8217;</p>

	 		
		<div class="navigation">
			<div class="alignleft"><a href="page/2.html">&laquo; Previous Entries</a></div>
			<div class="alignright"></div>
		</div>

						
			<div class="post" id="post-1189">
				<h2 class="posttitle"><a href="../../1189/trackback.html" rel="bookmark" title="Permanent Link to Странное поведение Synology DS411 на iSCSI">Странное поведение Synology DS411 на iSCSI</a></h2>
				<div class="postmetadata">13 Август 2012, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p><a href="http://wahlnetwork.com/2012/08/07/synology-ds411-vsphere-home-lab-storage-protocol-bakeoff/">Любопытная статья</a> обнаружилась в блоге <a href="http://wahlnetwork.com/">Wahl Network</a>, который я тут уже упоминал в связи с переводами из него<a href="../../1160/trackback.html"> про LACP</a> и <a href="../../1164/trackback.html">агрегирование каналов Ethernet/NFS в VMware</a>.<br />
В очередной статье автор показывает, какие странные проблемы бывают порой у бюджетных стораджей. Он собрал для своей домашней лабы сторадж на базе <a href="http://www.synology.com/us/products/DS411/index.php">Synology DS411</a>, с 4 дисками SSD в качестве хранилки, и получил, подключившись к ней по iSCSI, чудовищно плохие (и странные) результаты при записи (да и вообще, в целом на iSCSI плохие). При том, что при работе по NFS этой же проблемы нет.<br />
Налицо явная проблема на уровне фирмвари контроллера. ?? кто знает, сколько таких &#8220;волчьих ям&#8221; поджидает юзеров &#8220;домашних NAS&#8221;, при попытке использовании их в жестких условиях энтерпрайза.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../ds411.html" rel="tag">ds411</a>, <a href="index.html" rel="tag">iscsi</a>, <a href="../nfs/index.html" rel="tag">nfs</a>, <a href="../synology.html" rel="tag">synology</a><br />					Раздел: <a href="../../category/justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;" rel="category tag">justread</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../1189/trackback.html#comments" title="Комментарий к записи Странное поведение Synology DS411 на iSCSI">Комментарии (6)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1159">
				<h2 class="posttitle"><a href="../../1159/trackback.html" rel="bookmark" title="Permanent Link to VMware и использование NFS: часть 2">VMware и использование NFS: часть 2</a></h2>
				<div class="postmetadata">21 Май 2012, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>В <a href="../../1151/trackback.html">части первой</a> я написал небольшую вводную, что такое NFS, и почему вам стоит обратить на этот способ подключения системы хранения к хост-серверу виртуализации, какие достоинства, удобства и премущества есть у этого способа.</p>
<p>??так, перейдем к некоторым конкретным вопросам, на которые приодится отвечать, выбирая NFS в качестве протокола доступа к датастору в VMware. Впервые такой вариант появился еще в VMware ESX 3.0, и постепенно зарабатывает все большую популярность, потесняя “классический” блочный способ подключения по FCP или iSCSI. О преимуществах, и некоторых недостатках я писал в <a href="../../1151/trackback.html">первой части данной серии</a>.</p>
<p>Какие же основные проблемы принято называть, когда речь идет о испоьзовании NFS для VMware?</p>
<p><strong>1. На NFS нет multipathing.</strong></p>
<p>“<em>?? значит, выбирая NFS, я ограничен производительностью только одного интерфейса Ethernet</em>” добавляется явно или подразумеваемо. Ну, на самом деле это “и так и не так”. Пока оставим “за скобками” <em>практическую </em>надобность расширения канала к дискам даже для Gigabit Ethernet NFS или iSCSI (во многих системах это расширение bandwidth имеет довольно спорную <em>практическую </em>ценность). На NFS действительно нет multipath в том виде, в котором он понимается в блочных протоколах, потому что <strong>multipathing (MPIO, Multipathed Input Output) – это фича исключительно блочных протоколов.</strong> А так как NFS это не блочный протокол, то <em>фичи блочных протоколов</em> в нем быть не может “по определению”. Это так. Однако, NFS, как протокол поверх TCP/IP, конечно же имеет возможности реализации отказоустойчивости, путем использования множественных путей (как его имеет сам нижележащий TCP/IP), а также использования нескольких параллельных каналов доступа к данным, для расширения bandwidth. </p>
<p>Но тут есть некотрая тонкость. Проблема связана с тем, что NFS, для связи с данным датастором, с данным IP, и всеми его файлами, использует только одну TCP-сессию. А одну сессию, имеющую один IP-source и один IP-destination никак нельзя забалансировать по нескольким физическим портам Ethernet, даже с использованием etherchannel, формально работающем уровнем ниже.</p>
<p>Но можно (и нужно) выйти из положения хитрым трюком. Дело в том, что можно создать для destination несколько так называемых IP-алиасов, а также несколько портов VMkernel в качестве IP-source. Датастор, тем самым может быть доступен по нескольким равноправным IP-адресам. Если мы подключим датастор таким образом, у нас уже могут быть несколько различных IP-destination, через разные IP-source в VMkernel и, значит, заработает балансировка по IP-хэшу. Такой трафик, вышедший из нескольких IP-source в своих подсетях, и пришедший на сторадж в разные IP-алиасы, <strong>можно</strong> распределить по нескольким физическим eth-интерфейсам. Просто это присходит не “мистически-автоматически”, как в случае iSCSI MPIO, а путем ручной настройки этой балансировки, и дальнейшей ее самостоятельной работы.</p>
<p>Подробнее о этом методе рассказывается в <em><a href="http://www.netwell.ru/docs/netapp/rus_tr-3802_ethernet_storage_bp.pdf">TR-3802 Ethernet для систем хранения: Наилучшие методы</a></em> (глава 4.6 IP-алиасы), и в <em><a href="http://netwell.ru/docs/netapp/TR-3749_Rus_NetApp_VMware_vSphere_v5.0/tr-3749_rus_netapp_vmware_vsphere_v5.0.pdf">TR-3749 Руководство по наилучшим способам использования систем NetApp с VMware vSphere</a></em> (глава 3.3 Основы сети хранения с использованием Ethernet, глава 3.6 Сеть хранения с использованием Multiswitch Link Aggregation).</p>
<p>Дабы не раздувать один блогопост, чуть подробнее предлагаю углубиться в тему в отдельном посте далее, посвященном тому, как именно организована балансировка методом нескольких IP-алиасов на стороне стораджа, и нескольких портов VMkernel на стороне хост-сервера.</p>
<p><strong>UPD:</strong> Если вы счастливый обладатель VMware в лицензии <em>Enterprise Plus</em>, то тогда вам доступен еше один вариант загрузки нескольких NFS-линков к стораджу - это режим <em>Load-based Teaming</em> для интерфейсов vnic. Об этом способе мы также поговорим чуть позднее в отдельном посте.</p>
<p><strong>2. NFS нестабилен в работе и имеет проблемы с призводительностью.</strong></p>
<p><em>“Мы видели это своими глазами, собрав сервер NFS на Linux”</em> – добавляется явно или подразумеваемо. ?? это снова “и так, и не так”. Да, действительно, реализация NFS на Linux давно страдает серьезными проблемами, ее обычно приходится в продакшне твикать и патчить, только чтобы поправить некоторые наиболее вопиющие проблемы. В vanilla code она в продакшн малопригодна. Но это не значит, что <em>любой</em> NFS server также непригоден, только потому что он – NFS! Реализация NFS от NetApp зарекомендовала себя во множестве систем крайне высокого класса, ей по плечу задачи от небольших систем, до масштабов Yahoo!, Oracle, Siemens и Deutsche Telecom. NetApp имеет опыт разработки и эксплуатации NFS-серверов уже около 20 лет, в самых жестких условиях и требованиях по производительности и надежности. </p>
<p>??так: Не все реализации NFS “одинаково полезны”. ?? реализацией NFS в Linux многообразие их не исчерпывается. Не нужно интерполировать на NetApp неудачные реализации одной отдельно взятой подсистемы, в одной конкретной OS (или группе OS, использующих общих прародителей данного кода).</p>
<p>В следующей части я попробую более подробно остановится на методах multipathing для NFS, о которых выше в посте я вкратце уже упомянул.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="index.html" rel="tag">iscsi</a>, <a href="../mpio.html" rel="tag">mpio</a>, <a href="../netapp/index.html" rel="tag">netapp</a>, <a href="../nfs/index.html" rel="tag">nfs</a>, <a href="../vmware/index.html" rel="tag">vmware</a><br />					Раздел: <a href="../../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../1159/trackback.html#comments" title="Комментарий к записи VMware и использование NFS: часть 2">1 комментарий</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1004">
				<h2 class="posttitle"><a href="../../1004/trackback.html" rel="bookmark" title="Permanent Link to SAN boot">SAN boot</a></h2>
				<div class="postmetadata">17 Октябрь 2011, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>Я обратил внимание, что очень многие, в особенности впервые сталкивающиеся с SAN, обязательно хотят реализовать у себя возможность бездисковой загрузки серверов из SAN, с созданного в ней LUN-а. Но потом как-то охладевают к этой идее, по причине ряда сложностей реализации и неочевидности преимуществ. Действительно, если у вас blade-ферма на три десятка blades в ней, то экономия на жестких дисках по ценам изготовителя blades, может вылиться в экономию, за которую можно пострадать, но при всего 2-4 серверах в SAN это обычно не стоит выделки. Однако если вы все же решили заняться SAN boot, то вот какие полезные сведения я обнаружил в <a href="http://communities.netapp.com/community/netapp-blogs/msenviro/blog">блоге группы поддержки решений Microsoft</a>, сформированной в NetApp.</p>
<p>Во-первых, следует знать, что на сегодняшний день загрузка из SAN для актуальных OS Microsoft полностью поддерживаемое решение. См. статью из <a href="http://support.microsoft.com/kb/305547">Knowledge Base</a>.</p>
<p>Во-вторых, следует помнить, что проблемы с зонингом – есть “номер один” всех проблем с SAN boot. Если у вас что-то не работает – начните с проверки зонинга. Чаще всего разрешение проблемной ситуации с зонингом и есть решение проблемы загрузки из SAN. Если ваша система на поддержке – обратитесь в поддержку NetApp, они “знают много гитик”. Проверяйте и перепроверяйте все настройки зонинга ДО того, как начнете долбить поддержку.</p>
<p>Третий момент, который стоит помнить, это то, что поддержка MS MPIO на этапе загрузки крайне ограничена. ??спользуемый в MS на этапе инсталляции WinPE (Windows Preinstall Environment) не рассчитан на работу с MPIO, и подключение LUN по нескольким путям может давать непредсказуемые результаты. При первой загрузке этапа установки, инсталлятор Windows загружает модуль boot.wim (это и есть WinPE) и начинает копирование файлов из дистрибутива в “локальный диск”, который в вашем случае будет SAN LUN-ом. После копирования загрузится уже собственно Windows. Поддержка рекомендует на время работы WinPE физически отключать второй путь, который можно будет подключить назад позже, когда у вас уже будет работающий MPIO.</p>
<p>Также стоит помнить, что <a href="http://support.microsoft.com/kb/2504934">MPIO не поддерживается в sysprep</a><strong></strong>. Вам придется настроить MPIO непосредственно на том образе, с которого будут грузиться система, но официально не поддерживается его конфигурирование непосредственно в <em>syspreped </em>образе. Оно работает, как показывает опыт. Но не поддерживается MS. Be warned, есличо.</p>
<p>MPIO, несмотря на написанное выше, настоятельно рекомендуется для загрузки SAN boot! Если в момент загрузки вы потеряете связь с SAN LUN, с которого система загружается, она упадет в BSOD Inacessible boot device. Смотрите по этому поводу <a href="http://technet.microsoft.com/en-us/library/cc786214%28WS.10%29.aspx">статью в TechNet</a>.</p>
<p>Для того, чтобы LUN в SAN был увиден системой на этапе инсталляции, он должен быть подключен из BIOS карты HBA. Это поддерживается для “аппаратных” HBA FC (FCoE), а также для hardware HBA iSCSI. Теоретически есть методы загрузки из SAN и для Software iSCSI, но рассмотрение этой темы выходит за рамки данной статьи.</p>
<p>Напомню еще раз, что, для двухпортовых карт, вы должны активировать поддержку загрузки в BIOS <strong>только для одного из двух имеющихся портов HBA!</strong> Реализация отличается в зависимости от вендора HBA, так что внимательно проследите эту тему самостоятельно по документации.<strong> На этапе загрузки не работает MPIO, и LUN должен видеться только по одному пути!</strong></p>
<p>Если после всего перечисленного выше, инсталлятор по прежнему не видит диск, на который он может установить OS, то, скорее всего, в дистрибутиве проблема с драйверами для данного типа HBA. Можно попробовать вставить правильные драйвера непосредственно в инсталлятор, в модули boot.wim и install.wim, либо подставьте драйвера вручную, когда это запрашивает инсталлятор. Опять же тема интеграции драйверов в дистрибутив Windows достаточно хорошо рассмотрена в интернете.</p>
<p>Помните, что если вы вынули CD/DVD-диск, чтобы вставить на его место диск с драйверами, то не забудьте вернуть назад диск с дистрибутивом для продолжения установки. :)</p>
<p>Обратите внимание, что в <a href="http://now.netapp.com/NOW/knowledge/docs/hba/win/relwinhu53/pdfs/setup.pdf">Windows Host Utilities Installation and Setup Guide</a> со страницы 95 идет очень детальное и подробное описание настройки SAN Boot.</p>
<p>Для практической проверки и отработки решения группа построила стенд из 22 серверов Fujitsu RX200, снабженных двухпортовыми FCoE HBA Brocade 1020, включенных в два коммутатора Brocade 8000 FCoE, куда также подключены два контроллера FAS6030 с дисками. HBA обладают возможностью загрузки из SAN в их BIOS, а сервера имеют средства управления Fujitsu iRMS (аналог HP iLO и DELL DRAC). Система хранения NetApp имеет активированную лицензию <strong>FlexClone</strong>, используемую в дальнейшем процессе. В принципе, описываемые процессы могут быть реализованы и без FlexClone, но с ним они куда эффективнее расходуют пространство хранения, так как место на диске занимают только изменения относительно мастер-LUNа.</p>
<p>Начнем с создания пустого volume и на нем LUN-а, который будет мастер-образом. Смонтируем данный LUN на один из серверов, заполним и сконфигурируем его, а позже склонируем для остальных серверов. Не забудьте установить в этот образ OS все нужные роли, драйвера и приложения, в данном случае были установлены NetApp DSM, Host Utilities, а также драйвера и приложение управления HBA от Brocade.</p>
<p>Запустим sysprep с опциями –generalize и –shutdown, после чего сервер отключится и LUN необходимо отмапить от сервера. Эталонный мастер-образ подготовлен.</p>
<p>Теперь подготовим остальные сервера на загрузку из SAN. <strong>Помните, что в BIOS HBA необходимо включить загрузку с SAN LUN только для одного порта!</strong> Смотрите ссылку на документ <a href="http://www.microsoft.com/download/en/details.aspx?id=2815">Boot from SAN in Windows Server 2003 and Windows Server 2008</a> из MS Download Center.</p>
<p>В имеющемся HBA в BIOS была выбрана опция загрузки “First visible LUN” (эти настройки могут отличаться для разных HBA, решайте по аналогии) с тем чтобы обеспечить наиболее простую загрузку, которая не потребует в дальнейшем перенастройки при изменениях, как в случае опции “Preferred LUN”. Вариант First visible LUN, разумеется, требует некоторых предосторожностей, например дисковый массив с загрузочным LUN должен располагаться в ближайшей к серверам фабрике, чтобы минимизировать задержки, а также иметь LUN ID 0.</p>
<p>Создаем клон тома мастер-образа, например с помощью FlexClone. Маппим LUN в клоне тома (не оригинальный мастер-образ, а клон!) на сервер. Включаем сервер с использованием iRMC и подключаемся к серверной консоли.</p>
<p>Сервер загружается и запускается mini-setup после sysprep. В нем вы можете задать пароль, изменить имя сервера, назначить IP-адрес, и так далее (если вы знакомы с развертыванием образов Windows с использованием sysprep, это не должно быть неожиданностью). После завершения mini-setup вы получаете созданную из мастер-образа индивидуальную копию установки Windows.</p>
<p>??так, мы за несколько минут получили полностью загруженный в индивидуальный образ Windows физический сервер, загружаемый из SAN.</p>
<p>Немного иначе происходит процесс для загрузки виртуальных серверов из SAN.</p>
<p>В случае <strong>pass-through disks</strong> Hyper-V все происходит также, как и в случае физического сервера, но нужно создать для VM еще один клон, и назначить ему LUN ID отличный от 0, чтобы он не пересекся с LUN, используемым для загрузки физического сервера. ??спользуя LUN FlexClone вы можете создать клоны мастер-LUN непосредственно на том же volume, где он сам и находится. Следите, чтобы на volume либо было достаточно места для записи хранимых “разностных” изменений, или чтобы была активирована опция “volume autogrow” и места было достаточно уже на aggregate этого тома. Если вам понадобится создать больше VM, просто создайте еще несколько клонов мастер-LUN.</p>
<p>В случае использования <strong>VHD</strong>, следует создать LUN для физического сервера, содержащий файлы VHD для находящихся на нем виртуальных. Также можно использовать возможности sub-LUN клонирования FlexClone, создав один клон LUN-а с множеством клонов VHD в нем.</p>
<p>Преимущества SAN boot, кроме экономии на локальных дисках, это, безусловно, большая гибкость. Особенно это полезно в условиях тестового стенда, когда развертывание из чистого эталонного образа занимает всего несколько минут, а если вам понадобилось вернуть предшествующую конфигурацию, например для продолжения работ по предыдущей теме, вы просто маппите ранее созданный и оставшийся на сторадже LUN и загружаетесь в предыдущую установку, без необходимости восстанавливать ее из бэкапа, как в “традиционном” варианте с локальными дисками.</p>
<p>??спользование же FlexClone в данном случае поможет значительно сократить занятый объем. Например, в описываемом случае, около 50 LUN-ов разлчных проектов данного стенда имеют совокупную емкость около 5TB, занимая при этом на диске всего около 300GB.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../boot.html" rel="tag">boot</a>, <a href="../diskless.html" rel="tag">diskless</a>, <a href="../fc.html" rel="tag">fc</a>, <a href="../fcoe.html" rel="tag">FCoE</a>, <a href="../hba.html" rel="tag">hba</a>, <a href="index.html" rel="tag">iscsi</a>, <a href="../ms.html" rel="tag">ms</a>, <a href="../netapp/index.html" rel="tag">netapp</a>, <a href="../san.html" rel="tag">san</a>, <a href="../sanboot.html" rel="tag">sanboot</a><br />					Раздел: <a href="../../category/howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;" rel="category tag">howto</a>,  <a href="../../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>,  <a href="../../category/tricks/index.html" title="Просмотреть все записи в рубрике &laquo;tricks&raquo;" rel="category tag">tricks</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../1004/trackback.html#comments" title="Комментарий к записи SAN boot">Комментарии (5)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1043">
				<h2 class="posttitle"><a href="../../1043/trackback.html" rel="bookmark" title="Permanent Link to iSCSI или FC? Цена решения.">iSCSI или FC? Цена решения.</a></h2>
				<div class="postmetadata">13 Октябрь 2011, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>Недавно один мой коллега провел “для себя” небольшой подсчет цен на решение SAN, сравнив стоимость “железа” для построения сети передачи данных iSCSI и FC разной пропускной способности.</p>
<p>Данные оказались любопытными, и я упросил его разрешить мне их опубликовать.</p>
<p><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/pics//image147.png" width="487" height="296" /></p>
<p>По оси X – количество подключаемых в SAN хостов-серверов, по Y – цена оборудования без учета стоимости работы и времени, только “железо”.</p>
<p>Цены брались “real-life” и “street price” (не list price). Разумеется dual fabric и по два порта на хост, и так далее, как положено в реал лайфе. Выбиралось оборудование за минимальную цену, выполняющее поставленную задачу, но, естественно, из доступного данному партнеру списка вендоров (поэтому, главным образом, Cisco и IBM (Brocade)). В подсчет включались HBA и NIC, коммутаторы, SFP, кабеля, лицензии на порты, где нужны, и так далее.</p>
<p>Результат любопытен, и показывает неоднозначность вопроса “дороговизны”. Так, например, на 1-8 хостов стоимость решения 10G Ethernet в разы перекрывает тот же 8G FC, а вот на 16-24 хоста в SAN все уже не столь очевидно (больше 24 хостов анализ не производился, там уже начинаются “директоры” и совсем иного класса оборудование). </p>
<p>Также было бы очень любопытно сделать анализ динамики цен, например, в прошлом году и через год. Тоже, подозреваю, много интересного получится подумать. Обещаю вернуться к вопросу через год.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../10g.html" rel="tag">10G</a>, <a href="../ethernet.html" rel="tag">ethernet</a>, <a href="../fc.html" rel="tag">fc</a>, <a href="../gigabit.html" rel="tag">gigabit</a>, <a href="index.html" rel="tag">iscsi</a>, <a href="../san.html" rel="tag">san</a><br />					Раздел: <a href="../../category/justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;" rel="category tag">justread</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../1043/trackback.html#comments" title="Комментарий к записи iSCSI или FC? Цена решения.">Комментарии (20)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1058">
				<h2 class="posttitle"><a href="../../1058/trackback.html" rel="bookmark" title="Permanent Link to SMB vs. iSCSI: как дела у Hyper-V? Результаты неожиданны.">SMB vs. iSCSI: как дела у Hyper-V? Результаты неожиданны.</a></h2>
				<div class="postmetadata">5 Октябрь 2011, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>Любопытную, и, честно говоря, даже неожиданную для меня тему исследовал блоггер NetApp <em>Lobanov</em>.</p>
<p>Следящие за темой уже знают, что в Hyper-V 3.0 Microsoft объявила, что <a href="http://virtualstorageguy.com/2011/09/20/microsoft-announces-smb-2-2-and-nas-support-for-hyper-v-3-0-in-windows-8/">будет поддерживать работу по NAS протоколу SMBv2.2</a>.</p>
<p>Вы помните, что VMware уже с версии 3.0 активно рекомендует использовать NAS для подключения датасторов виртуальных машин по файловому протоколу NFS, и пользуется&#160; при этом большими преимуществами такого варианта перед “классическим” блочным FC и iSCSI, о чем я уже не раз писал в этом блоге. Однако у Microsoft в ее Hyper-V не было такой возможность в штатном, поддерживаемом порядке, впрочем и пользователи, скорее всего, не особо это требовали. Отчасти это было связано с широко распространенным убеждением, что NAS-протоколы, и уж CIFS/SMB в особенности, вообще не пригодны для производительных применений. ?? если в отношении NFS в VMware эти заблуждения уже более-менее развеяны многочисленными результатами тестов, как NetApp и EMC, так и самой VMware, да и сотнями и тысячами практических реализаций разного масштаба, то в отношении CIFS по прежнему бытует стойкое убеждение в непригодности его ни для чего, кроме “домашних папок” и копирования файлов по сети.</p>
<p>Отчасти это действительно так. CIFS как протокол сетевой файловой системы, значительно сложнее устроен, чем NFS, обладает множеством хитрых возможностей, и, как следствие, заметно большей величиной “оверхеда”, накладных расходов. Кроме того, CIFS (или SMB 1.0) никогда и не ориентировался на такое применение.</p>
<p>Однако первым шагом в сторону переработки и устранения старых родовых болячек NetBIOS и LAN Manager, от которого ведет свою родословную CIFS, был сделан в SMB v2.0, в котором Microsoft показала, что она знает о проблемах, и приняла решение их устранить. С тех пор CIFS/SMB развивается, не слишком шумно, но довольно существенно, а как видимый результат – появление поддержки новой версии, SMB v2.2 в качестве поддерживаемого протокола доступа к датасторам в новой версии Hyper-V.</p>
<p>Однако, пока Windows 8, Hyper-V 3.0 и SMB 2.2 не вышли в релиз, что же может показать в плане производительности обычный SMB2.0, появившийся в Windows Server 2008, и поддерживаемый в Data ONTAP?</p>
<h2><a href="http://communities.netapp.com/community/netapp-blogs/msenviro/blog/2011/09/29/looking-ahead-hyper-v-over-smb-vs-iscsi">Looking ahead Hyper-V over SMB vs. iSCSI</a></h2>
<p>Posted by <a href="http://communities.netapp.com/people/lobanov">lobanov</a> on Sep 29, 2011 10:06:19 AM </p>
<p>В свете грядущих новостей о&#160; <a href="http://communities.netapp.com/community/netapp-blogs/virtualstorageguy/blog/2011/09/20/microsoft-announces-smb-22-and-nas-support-for-hyper-v-30-in-windows-8">поддержке в Hyper-V работы по SMB через версию SMB 2.2</a>, у нас скоро появится новая возможность работать с виртуальными машинами через IP сеть. До сих пор существовала только одна такая возможность, подключая LUN по iSCSI. Очеивдный вопрос, вертящийся у всех на языке, как будут обстоять дела в варианте с SMB с точки зрения эффективности использования системы хранения, управления, и, самое главное, с точки зрения производительности. Для того, чтобы разобраться во всем этом, мы решили провести эксперимент, сравнив эти два варианта подключения, использовав оборудование нашей тестовой лаборатории<a href="http://communities.netapp.com/community/netapp-blogs/msenviro/blog/2011/09/22/getting-ready-for-windows-server-8-part-ii-hyper-v-over-smb">.</a></p>
<p>Для теста использовался один сервер в следующей конфигурации:</p>
<ul>
<li>16 CPU (Dual Socket Quad Core with HyperThreading)</li>
<li>48 GB&#160; RAM</li>
<li>Один 1Gbs Ethernet NIC</li>
<li>Win2K8R2 SP1</li>
</ul>
<p>Один контроллер NetApp FAS6030 под Data ONTAP 8.0.1 работает на один сетевой адаптер Ethernet 1Gbs, на контроллере создано два тома flexvol:</p>
<ul>
<li>“HVoverSMB_CIFS” это CIFS share, смонтированная на хост Hyper-V как symbolic link. </li>
<li>“HVoverSMB_ISCSI” несет один LUN, подключенный к хосту Hyper-V по протоколу iSCSI. </li>
</ul>
<p>Оба тома имеют размер 1TB в режиме Thin-Provisioned, и&#160; LUN на томе для iSCSI также сделан Thin-Provisioned. Таким образом, со стороны хоста Hyper-V мы видим 2TB&#160; usable storage, в то время, как на стороне контроллера пространство на дисках почти не занято.&#160; Мы решили не использовать 10G Ethernet, так как хотели замедлить, для наглядности, время загрузки, и максимально нагрузить сеть в процессе эксперимента.</p>
<p>Мы создали 20 VM на iSCSI LUN, и 20 VM на CIFS Share. Каждая виртуальная машина имела следующую конфигурацию:</p>
<ul>
<li>1 CPU </li>
<li>2 GB RAM</li>
<li>Win2K8R2 SP1 </li>
<li>40GB VHD</li>
</ul>
<p>Оригинальный эталонный шаблон VM был создан с использованием нашей новой техники <a href="http://communities.netapp.com/community/netapp-blogs/msenviro/blog/2011/09/22/getting-ready-for-windows-server-8-part-ii-hyper-v-over-smb">Thick/Thin VHD ,</a> о которой я рассказывал ранее,&#160; а последующие копии с этого шаблона созданы с использованием Sub-Lun cloning, и файлового SIS cloning vпри помощи cmdлетов <em>Start-NaClone</em>, и <em>Copy-NaHostFile</em>. ??тоговый результат 40 VM, и 1.6TB дисков виртуальных машин занимают менее 16GB на контроллере! </p>
<p>Затем мы подвергли получившуюся систему испытанием старым добрым Boot Storm – одновременной загрузкой 20 виртуальных машин каждого типа, и сбором данных о производительности как на хосте Hyper-V, так и на контроллере NetApp. Мы собирали данные производительности Hyper-V при помощи Performance Monitor, обращая внимание, в первую очередь, на CPU и призводительность сетевого адаптера. Контроллер NetApp мониторился с помощью <a href="http://communities.netapp.com/docs/DOC-10354">Get-NaSysStat PowerShell Script</a>. Оба инструмента был настроены на сбор данных каждые 5 секунд.</p>
<p><strong>Результаты</strong></p>
<p><strong>Время загрузки</strong></p>
<p>В обоих тестах загрузка до экрана Logon заняла менее 90 секунд для всех 20 виртуальных машин.&#160; Давайте посмотрим, что в это время происходило на хостах Hyper-V и контроллере NetApp.</p>
<p><strong>Hyper-V-Host Performance</strong></p>
<p>CPU load</p>
<p><a href="/pics//image148.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/pics//image-thumb45.png" width="640" height="140" /></a></p>
<p>&#160;</p>
<p>Network Adapter: BytesReceived/sec</p>
<p><a href="/pics//image149.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/pics//image-thumb46.png" width="640" height="140" /></a></p>
<p>&#160;</p>
<p><strong>NetApp Array Performance</strong></p>
<p>Net_Data_Sent</p>
<p><a href="/pics//image150.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/pics//image-thumb47.png" width="640" height="140" /></a></p>
<p>CPU_Busy</p>
<p><a href="/pics//image152.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/pics//image-thumb48.png" width="640" height="140" /></a></p>
<p>CIFS vs. iSCSI Ops/sec</p>
<p><a href="/pics//image153.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/pics//image-thumb49.png" width="640" height="140" /></a></p>
<p>&#160;</p>
<p>Как вы видите, как со стороны хоста Hyper-V, так и со стороны контроллера NetApp, уровни загрузки CPU, а также производительность сети оказались сравнимыми! Важно отметить, что, в данном случае, мы еще даже не используем SMB2.2, так как работает Server 2008 R2 SP1, а не Server.Next. Если же мы видим равную производительность для текущего поколения софта, запущенного на оборудовании четырехлетней давности, то что же мы получим, когда появится Server.Next?</p>
<p>Но где же вообще разница между протоколами, спросите вы, а что там с latency?</p>
<p>Давайте посмотрим, вот картина на стороне NetApp:</p>
<p><a href="/pics//image154.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/pics//image-thumb50.png" width="640" height="140" /></a></p>
<p>Неожиданно, не правда-ли?</p>
<p>На первый взгляд, все неплохо, исключая взлет latency до 4ms в самый “разгар шторма”. Но посмотрите на параметр <em>read latency</em> для теста&#160; CIFS. Почему он показывает меньшую latency на идентичной нагрузке? То что мы видим, это преимущества протокола SMB 2.x; Windows использует собственный кэш NTFS для улучшения производительности на чтение, просто посылая на систему хранения меньше избыточных запросов чтения.</p>
<p>&#160;</p>
<p><strong>Величина эффективности использования пространства хранения на NetApp</strong></p>
<p>??спользуя <em>thin-provisioning</em>, <em>single copy rapid provisioning</em>, и дедупликацию, мы получили фантастически высокие результаты для обоих протоколов.</p>
<table border="1" cellspacing="0" cellpadding="2" width="642">
<tbody>
<tr>
<td valign="top" width="117"><strong>??мя</strong></td>
<td valign="top" width="122"><strong>Общий размер</strong></td>
<td valign="top" width="80"><strong>??спользовано</strong></td>
<td valign="top" width="93"><strong>Доступно</strong></td>
<td valign="top" width="105"><strong>Дедупликация</strong></td>
<td valign="top" width="123"><strong>Aggregate</strong></td>
</tr>
<tr>
<td valign="top" width="121">HVoverSMB_CIFS </td>
<td valign="top" width="122">1024.0 GB </td>
<td valign="top" width="80">1%</td>
<td valign="top" width="91">1015.9 GB </td>
<td valign="top" width="108">да</td>
<td valign="top" width="121">aggr0</td>
</tr>
<tr>
<td valign="top" width="123">HVoverSMB_ISCSI</td>
<td valign="top" width="122">1024.0 GB </td>
<td valign="top" width="80">1%</td>
<td valign="top" width="92">1013.7 GB </td>
<td valign="top" width="110">да</td>
<td valign="top" width="125">aggr0</td>
</tr>
</tbody>
</table>
<p>Как вы видите, в обоих случаях величина эффективности использования хранилища сравнима и высока.</p>
<p>&#160;</p>
<p>Так как мы увидели, что производительность и уровень использования системы хранения примерно одинаков, давайте посмотрим на остальные критерии и попытаемся ответить на вопрос, что же лучше.</p>
<p><strong>CIFS</strong></p>
<p><u>За</u>:</p>
<ul>
<li>Одна сетевая папка CIFS на любое число хостов Hyper-V или кластеров Clusters.</li>
<li>Перемещение VM между хостами Hyper-V становится гораздо проще, так как все хосты имеют доступ к одним и тем же VHD. </li>
<li>Значительно более высокий уровень плотности VM на том.</li>
</ul>
<p><u>Против</u>:</p>
<ul>
<li>Конфигурирование прав на CIFS share несколько сложновато, так как требует разобраться со специфическими разрешениями на Share и NTFS, которые требуются для Hyper-V. </li>
<li>В настоящий момент <strong>не поддерживается.</strong></li>
</ul>
<p><strong>iSCSI</strong></p>
<p><u>За</u>: </p>
<ul>
<li>Конфигурирование прав NTFS очевидно.</li>
<li>Поддерживается. </li>
<li>Равная производительность с FCP без необходимости сложного зонирования.</li>
</ul>
<p><u>Против</u>:</p>
<ul>
<li>К LUN-ам не может быть совместного доступа от нескольких хостов и кластеров, без использования WSFC, и CSV.</li>
<li>Перемещение VHD на другой хост Hyper-V требует переконфигурирования системы хранения или копирования файлов VHD по сети.</li>
</ul>
<p>&#160;</p>
<p><strong>Выводы</strong></p>
<p>Результаты теста и их анализ показывают, что сегодня SMB2.0 и iSCSI сравнимы. Оба варианта подключения обеспечивают достаточную эффективность и позволяют работу виртуальных машин по IP-сети. Мы ожидаем, что большинство сложностей с правами и разрешениями будет устранена в Server.Next. Факт неподдерживаемости SMB конечно делает iSCSI однозначным победителем, но, если быть честными, если SMB начнет поддерживаться… следует отдать должное прогрессу в работе SMB. В итоге, мы уже с нетерпением ждем выхода Server.Next, SMB2.2, и Hyper-V 3.0 over SMB, это должно оказаться весьма неплохо!</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../cifs.html" rel="tag">cifs</a>, <a href="../hyper-v.html" rel="tag">hyper-v</a>, <a href="index.html" rel="tag">iscsi</a>, <a href="../netapp/index.html" rel="tag">netapp</a>, <a href="../smb.html" rel="tag">smb</a>, <a href="../smb-20.html" rel="tag">smb 2.0</a><br />					Раздел: <a href="../../category/translations/index.html" title="Просмотреть все записи в рубрике &laquo;переводы&raquo;" rel="category tag">переводы</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../1058/trackback.html#comments" title="Комментарий к записи SMB vs. iSCSI: как дела у Hyper-V? Результаты неожиданны.">Комментарии (3)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-632">
				<h2 class="posttitle"><a href="../../632/trackback.html" rel="bookmark" title="Permanent Link to Ethernet Storage">Ethernet Storage</a></h2>
				<div class="postmetadata">8 Июль 2010, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>“Ethernet storage” принято называть все системы хранения, использующие ethernet для передачи данных. Это могут быть NFS или CIFS NAS, а также iSCSI или FCoE SAN.</p>
<p>??спользование Ethernet как среды передачи данных систем хранения становится все популярнее, однако задачи создания “сети хранения данных” с использованием ethernet предъявляют особые требования к стабильности и надежности работы сети. То что “прокатит” для раздачи интернета в офисе может “не прокатить” при создании сети IP-SAN или NFS для критически важных для бизнеса задач.</p>
<p>Если перед вами стоит задача организации такой сети передачи данных, хочу обратит ваше внимание на свежий перевод в библиотеке Netwell: <a href="http://www.netwell.ru/docs/netapp/RUS%20TR-3802%20Ethernet%20Storage%20BP.htm">TR-3802 Ethernet Storage Best Practices</a>.</p>
<p>Как организовывать и настраивать транкинг VLAN? Как работает и чем полезен протокол Spanning Tree? Что такое, и как работает VIF – Virtual Interfaces в NetApp? Чем отличаются Single mode и Multi-mode VIF? Static и Dynamic Multimode VIF? Почему объединенные в etherchannel (ethernet-транкинг) порты могут не давать ожидаемой от этого объединения увеличения полосы пропускания? Как работают Jumbo Frames и Flow Control на уровне Ethernet, и как правильно его применять?</p>
<p>Все это в исключительно полезном документе техбиблиотеки NetApp доступном теперь и на русском языке:</p>
<p><strong><a href="http://www.netwell.ru/docs/netapp/rus_tr-3802_ethernet_storage_bp.pdf">TR-3802 Ethernet Storage Best Practices.</a></strong></p>
<p>PS. Кстати может быть полезен и не только пользователям NetApp.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../ethernet.html" rel="tag">ethernet</a>, <a href="index.html" rel="tag">iscsi</a>, <a href="../netapp/index.html" rel="tag">netapp</a>, <a href="../nfs/index.html" rel="tag">nfs</a><br />					Раздел: <a href="../../category/justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;" rel="category tag">justread</a>,  <a href="../../category/review/index.html" title="Просмотреть все записи в рубрике &laquo;review&raquo;" rel="category tag">review</a>,  <a href="../../category/news/index.html" title="Просмотреть все записи в рубрике &laquo;новости&raquo;" rel="category tag">новости</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../632/trackback.html#comments" title="Комментарий к записи Ethernet Storage">Комментарии (2)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-629">
				<h2 class="posttitle"><a href="../../629/trackback.html" rel="bookmark" title="Permanent Link to MySQL 5.0 Performance Protocol Comparison">MySQL 5.0 Performance Protocol Comparison</a></h2>
				<div class="postmetadata">5 Июль 2010, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>Тестлаб компании NetApp продолжает тестировать и публиковать показатели производительности различных программных систем, работающих с системой хранения через различные протоколы доступа, с акцентом именно на сравнение производительности различныхпротоколов. Очередь дошла и до популярной базы данных MySQL, часто использующейся в различных веб-проектах.</p>
<p>По результатам недавно опубликованного отчета о тестировании производительности работы базы данных MySQL 5.0.56 (InnoDB) на сервере HP DL580 G5 под RHEL4, с использованием трех протоколов доступа – FC, iSCSI и NFS, к системе хранения FAS3070 можно оценить эффективность использования передачи данных по этим трем протоколам.</p>
<p><strong><a href="http://www.netapp.com/us/library/technical-reports/tr-3693.html">MySQL 5.0 Performance Protocol Comparison</a></strong></p>
<p>При тестировании использовался открытый тестовый пакет генерации нагрузки <a href="http://sourceforge.net/projects/osdldbt">DBT-2 Rel.40</a> (Database Test Suite), генерировавший нагрузку профиля OLTP (16K random read/write в пропорции 57% read/43% write) для базы объемом 100GB. Больше подробностей можно узнать из приведенного документа. Также приведены подробные описания конфигов и использованных настроек всех компонентов.</p>
<p>Для затравки – один из измеренных результатов.</p>
<p><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/pics//image46.png" width="578" height="356" /> </p>
<p>Тестировние показало, что использование iSCSI дало снижение всего на 9%, а NFS – всего на 16% относительно взятой за максимум производительности на FC. Результаты показывают, что широко распространившееся во времена MySQL 3.23 <a href="http://dev.mysql.com/tech-resources/presentations/presentation-oscon2000-20000719/">мнение</a>, что NFS в базах MySQL непригоден для использования, уже не соответствует действительности.&#160; <br />Любопытно, что того же мнения теперь придерживаются и “с той стороны баррикад”, в Sun/Oracle:    <br /><em>”<a href="http://blogs.sun.com/dlutz/entry/mysql_on_sun_storage_7000">for MySQL on Linux over NFS, performance is great, right out of the box.</a>”</em></p>
<p>??нтересущимся рекомендую тщательно просмотреть отчет, там есть над чем подумать. Есть основания предполагать, что с более новым железом (все же FAS3070 это уже довольно старая система, c ONTAP 7.2.4) и с новым клиентским софтом (RHEL4, использовавшийся на хосте, имел ядро 2.6.9-42.EL.smp) разница может оказаться еще менее значительной.</p>
<p>Также интересующимся рекомендую обратить внимание на документы:</p>
<p><strong><a href=" http://media.netapp.com/documents/tr-3495.pdf">Linux (RHEL 4) 64-Bit Performance with NFS, iSCSI, and FCP Using an Oracle Database on NetApp Storage</a></strong></p>
<p><strong><a href="http://www.netapp.com/us/library/technical-reports/tr-3657.html">Best Practices Guidelines for MySQL</a></strong></p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../fc.html" rel="tag">fc</a>, <a href="index.html" rel="tag">iscsi</a>, <a href="../mysql.html" rel="tag">mysql</a>, <a href="../netapp/index.html" rel="tag">netapp</a>, <a href="../nfs/index.html" rel="tag">nfs</a>, <a href="../performance/index.html" rel="tag">performance</a><br />					Раздел: <a href="../../category/justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;" rel="category tag">justread</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../629/trackback.html#respond" title="Комментарий к записи MySQL 5.0 Performance Protocol Comparison">Комментарий</a>									 </div>
			</div>
	
						
			<div class="post" id="post-601">
				<h2 class="posttitle"><a href="../../601/trackback.html" rel="bookmark" title="Permanent Link to Результаты тестирования FC и Software iSCSI под MS Hyper-V R2">Результаты тестирования FC и Software iSCSI под MS Hyper-V R2</a></h2>
				<div class="postmetadata">20 Май 2010, 13:37 <!-- от  --></div>
				<div class="postentry">
					<p>Компания NetApp опубликовала результаты тестирования <strong>4Gb FC</strong> и Software iSCSI по <strong>1Gb Ethernet</strong> и <strong>10Gb Ethernet</strong> в среде MS Hyper-V R2 с использованием своей системы хранения NetAp FAS3160A (система midrange-класса).</p>
<p>Тестирование производилось с помощью IOmeter (о котором я уже не раз писал в блоге), с 4 хост-серверов IBM x3550 (1x Quad-core Intel Xeon E5420, 2,5GHz), на каждом из которых бы установлен Windows 2008 R2 c Hyper-V role и 8 виртуальными машинами в каждом, с Windows 2008 64-bit Enterprise edition (итого 32 виртуальных машины). ??нтерфейсы каждого сервера: FC – QLogic QLE2462, Gigabit Ethernet – Intel PRO/1000 PT dual port, 10G Ethernet – Intel Ethernet Server Adapter X520, включались в коммутаторы Brocade 200E, Cisco 4948 Ethernet Switch и Fujitsu XG1200 соотвественно.   <br />Особое внимание при тестировании уделялось получению результатов, приближенных к “боевым”, позволяющим использовать их для оценки реальной, “живой” инфраструктуры Hyper-V.</p>
<p>??спользовался паттерн: <strong>100% Random, 75% Read, 4KB и 8KB Request size</strong>.</p>
<p>Тесты показали сравнительно незначительную разницу между всеми тремя вариантами (4Gb FC, 1Gb software iSCSI, 10Gb software iSCSI) как в IOPS, так и в Latency. Дополнительная загрузка задачи softwre iSCSI initiator составила 3-5 процентов, в том числе и на 512 outstanding IOs (очень высокая загрузка), и разница со значением загрузки при использовании FC уменьшалась с повышением объемов загрузки (Outstanding IOs).</p>
<p>Показательно почти полное отсутствие значимого отличия по быстродействию между 4Gb FC и 1Gb iSCSI на рассматриваемой задаче.   <br />Отсутствие значительной разницы между 1Gb Ethernet и 10Gb Ethernet по видимому связано с тем, что Software iSCSI initiator на 10G Ethernet перестал быть эффективен, и, возможно, следует рассмотреть использование iSCSI HBA для таких высокоскоростных решений.    <br />Также сравнительно небольшую разницу дает включение и использование Jumbo Frames как на 1G Ethernet, так и на 10G Ethernet, что скорее всего говорит о специфике Hyper-V R2 в этом вопросе.</p>
<p>Лимит по производительности системы хранения FAS3160A для такой конфигурации не был достигнут.</p>
<p>Подробности и полный документ по результатам –тут:   <br /><a href="http://www.netapp.com/us/library/technical-reports/tr-3846.html" target="_blank">http://www.netapp.com/us/library/technical-reports/tr-3846.html</a></p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="index.html" rel="tag">iscsi</a>, <a href="../netapp/index.html" rel="tag">netapp</a>, <a href="../performance/index.html" rel="tag">performance</a>, <a href="../test.html" rel="tag">test</a><br />					Раздел: <a href="../../category/review/index.html" title="Просмотреть все записи в рубрике &laquo;review&raquo;" rel="category tag">review</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../601/trackback.html#comments" title="Комментарий к записи Результаты тестирования FC и Software iSCSI под MS Hyper-V R2">1 комментарий</a>									 </div>
			</div>
	
						
			<div class="post" id="post-493">
				<h2 class="posttitle"><a href="../../493/trackback.html" rel="bookmark" title="Permanent Link to Производительность iSCSI на 10G Ethernet">Производительность iSCSI на 10G Ethernet</a></h2>
				<div class="postmetadata">18 Январь 2010, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>В <a href="http://blogs.msdn.com/tvoellm/archive/2010/01/08/hyper-v-iscsi-performance-numbers.aspx">блогах MSDN</a> найден любопытный документ тестирования iSCSI на 10G Ethernet, с использованием MS Windows Server 2008, Hyper-V, и системы хранения NetApp FAS3070.<br />
Даже несмотря на то, что использовался довольно старенький сторадж (3070 это топовая модель предыдущей midrange-линейки, в настоящий момент уже не выпускаемая, вся серия 3000 уже целиком заменена на 3100), и чисто &#8220;софтверный&#8221; iSCSI, результаты могут показаться любопытными тем, кто еще раздумывает &#8220;А насколько быстр на самом деле этот непонятный iSCSI?&#8221;</p>
<p><a href="http://download.microsoft.com/download/F/B/3/FB38CA2C-6694-4D25-8452-4A28668A87F2/MSFT-NetApp-10G.docx">http://download.microsoft.com/download/F/B/3/FB38CA2C-6694-4D25-8452-4A28668A87F2/MSFT-NetApp-10G.docx</a></p>
<p>Следует отметить, что карты 10G Ethernet, например рассматриваемая в этом тестировании двупортовая Intel 10 Gigabit AF DA dual port Server Adapter <a href="http://price.ru/bin/price/prodlist?pnam=Intel+10g+AF+DA&#038;incid=1&#038;tid=&#038;acod=&#038;pmin=&#038;pmax=&#038;curr=2&#038;base=1&#038;pglen=25&#038;cid=0508&#038;vcid=030108&#038;where=00&#038;srch=1">по ценам Price.ru</a> стоит ~770$, а вообще 10G адаптеры начинаются уже от 500$.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="index.html" rel="tag">iscsi</a>, <a href="../netapp/index.html" rel="tag">netapp</a>, <a href="../performance/index.html" rel="tag">performance</a><br />					Раздел: <a href="../../category/justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;" rel="category tag">justread</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../493/trackback.html#comments" title="Комментарий к записи Производительность iSCSI на 10G Ethernet">Комментарии (10)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-236">
				<h2 class="posttitle"><a href="../../236/trackback.html" rel="bookmark" title="Permanent Link to Еще несколько слов об оптимальности.">Еще несколько слов об оптимальности.</a></h2>
				<div class="postmetadata">10 Апрель 2009, 8:55 <!-- от  --></div>
				<div class="postentry">
					<p>Специально свое мнение вынесу из комментов, так как читают меня в основном из RSS, и в комменты мало кто ходит.</p>
<p>Я не считаю, что Fibre Channel это плохо. FC это замечательная технология. Но любая технология лучше всего работает на своем месте, там, где она нужнее, там, где ее преимущества наиболее проявляются.</p>
<p>Целью же моего предыдущего поста была попытка донести мысль, что в случаях, когда то или иное дорогостоящее решение не дает существенных, сравнимых с затратами на него результатов, использовать его неразумно и расточительно. Те же деньги можно потратить с гораздо большим результатом иным способом. ?? этих способов немало.<br />
Затраты должны быть соизмеримы, и решения должны быть соразмерны задачам.</p>
<p>В прошлом своем посте я не столько пытался &#8220;опустить&#8221; FC, сколько донести мысль, что когда клиент покупает на &#8220;последние деньги&#8221; какой-нибудь Xyratex или Infortrend (все совпадения с реальным торговыми марками случайны;), при этом наполняет его дисками c &#8220;митина&#8221;, потому что &#8220;нет денег на родные&#8221;, но при этом собирается половину, а то и две трети цены массива потратить просто на &#8220;провод&#8221; для подключения, то это, мне кажется, крайний случай несбалансированности. </p>
<p>Приводя аналогии из полюбившегося автопрома: человек покупает какую-нибудь вазовскую &#8220;классику&#8221;, возить тещу и помидорную рассаду на дачу. Ну что, вполне себе задача, практическая. Не гонки Формулы, но не всем же, в конце концов, нужна Формула? Вот такая наша жизнь, в ней тоже надо ездить на дачу.<br />
?? вот, вместо покупки, например, более новой и безопасной машины, или вместо того, чтобы потратить деньги, например, на перебор двигателя, юстировку колес и промывку карбюратора-инжектора, покупатель тратит деньги, выкроенные из семейного бюджета на дачный автомобиль, на установку в &#8220;классику&#8221; ксеноновых фар, гоночных &#8220;ковшей&#8221;-сидений из красной кожи, низкопрофильной резины и брызговиков Sparco, на остатки.</p>
<p>По моему мнению, FC в entry (да зачастую и не только entry) level это типичный пример гаражного тюнинга и &#8220;синих писалок&#8221; в IT. Это эффектно, но, как и дырки в глушителе, выдающие мощный рев на светофоре, нисколько не помогают с него уехать быстрее.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../fc.html" rel="tag">fc</a>, <a href="index.html" rel="tag">iscsi</a>, <a href="../technology.html" rel="tag">technology</a><br />					Раздел: <a href="../../category/justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;" rel="category tag">justread</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../236/trackback.html#respond" title="Комментарий к записи Еще несколько слов об оптимальности.">Комментарий</a>									 </div>
			</div>
	
		
		<div class="navigation">
			<div class="alignleft"><a href="page/2.html">&laquo; Previous Entries</a></div>
			<div class="alignright"></div>
		</div>
		
	
	</div>
	<div id="sidebar">
		<ul>
			
			
			<!-- Author information is disabled per default. Uncomment and fill in your details if you want to use it.
			<li><h2>Автор</h2>
			<p>A little something about you, the author. Nothing lengthy, just an overview.</p>
			</li>
			-->

			<li class="pagenav"><h2>Страницы</h2><ul><li class="page_item page-item-153"><a href="../../../about/trackback.html" title="about">about</a></li>
<li class="page_item page-item-215"><a href="../../../distributory-v-rossii/trackback.html" title="Дистрибуторы в России">Дистрибуторы в России</a></li>
<li class="page_item page-item-1327"><a href="../../../disti-ua/trackback.html" title="Дистрибуторы в Украине">Дистрибуторы в Украине</a></li>
</ul></li>
			<li><h2>Рубрики</h2>
				<ul>
					<li class="cat-item cat-item-89"><a href="../../category/commands/index.html" title="Просмотреть все записи в рубрике &laquo;commands&raquo;">commands</a>
</li>
	<li class="cat-item cat-item-37"><a href="../../category/howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;">howto</a>
</li>
	<li class="cat-item cat-item-52"><a href="../../category/justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;">justread</a>
</li>
	<li class="cat-item cat-item-51"><a href="../../category/review/index.html" title="Просмотреть все записи в рубрике &laquo;review&raquo;">review</a>
</li>
	<li class="cat-item cat-item-3"><a href="../../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;">techtalk</a>
</li>
	<li class="cat-item cat-item-71"><a href="../../category/tricks/index.html" title="Просмотреть все записи в рубрике &laquo;tricks&raquo;">tricks</a>
</li>
	<li class="cat-item cat-item-95"><a href="../../category/utilities/index.html" title="Просмотреть все записи в рубрике &laquo;utilities&raquo;">utilities</a>
</li>
	<li class="cat-item cat-item-44"><a href="../../category/whoisho/index.html" title="Просмотреть все записи в рубрике &laquo;whoisho&raquo;">whoisho</a>
</li>
	<li class="cat-item cat-item-1"><a href="../../category/news/index.html" title="Просмотреть все записи в рубрике &laquo;новости&raquo;">новости</a>
</li>
	<li class="cat-item cat-item-387"><a href="../../category/opros.html" title="Просмотреть все записи в рубрике &laquo;опрос&raquo;">опрос</a>
</li>
	<li class="cat-item cat-item-8"><a href="../../category/translations/index.html" title="Просмотреть все записи в рубрике &laquo;переводы&raquo;">переводы</a>
</li>
	<li class="cat-item cat-item-40"><a href="../../category/citaty/index.html" title="Просмотреть все записи в рубрике &laquo;цитаты&raquo;">цитаты</a>
</li>
				</ul>
			</li>

			<li><h2>Архивы</h2>
				<ul>
					<li><a href='../../date/2018/01.html' title='Январь 2018'>Январь 2018</a></li>
	<li><a href='../../date/2015/10.html' title='Октябрь 2015'>Октябрь 2015</a></li>
	<li><a href='../../date/2015/04.html' title='Апрель 2015'>Апрель 2015</a></li>
	<li><a href='../../date/2015/03.html' title='Март 2015'>Март 2015</a></li>
	<li><a href='../../date/2015/01.html' title='Январь 2015'>Январь 2015</a></li>
	<li><a href='../../date/2014/12.html' title='Декабрь 2014'>Декабрь 2014</a></li>
	<li><a href='../../date/2014/11.html' title='Ноябрь 2014'>Ноябрь 2014</a></li>
	<li><a href='../../date/2014/10.html' title='Октябрь 2014'>Октябрь 2014</a></li>
	<li><a href='../../date/2014/09.html' title='Сентябрь 2014'>Сентябрь 2014</a></li>
	<li><a href='../../date/2014/08.html' title='Август 2014'>Август 2014</a></li>
	<li><a href='../../date/2014/07.html' title='Июль 2014'>Июль 2014</a></li>
	<li><a href='../../date/2014/06.html' title='Июнь 2014'>Июнь 2014</a></li>
	<li><a href='../../date/2014/05.html' title='Май 2014'>Май 2014</a></li>
	<li><a href='../../date/2014/04.html' title='Апрель 2014'>Апрель 2014</a></li>
	<li><a href='../../date/2014/03.html' title='Март 2014'>Март 2014</a></li>
	<li><a href='../../date/2014/02.html' title='Февраль 2014'>Февраль 2014</a></li>
	<li><a href='../../date/2014/01.html' title='Январь 2014'>Январь 2014</a></li>
	<li><a href='../../date/2013/12.html' title='Декабрь 2013'>Декабрь 2013</a></li>
	<li><a href='../../date/2013/11.html' title='Ноябрь 2013'>Ноябрь 2013</a></li>
	<li><a href='../../date/2013/10.html' title='Октябрь 2013'>Октябрь 2013</a></li>
	<li><a href='../../date/2013/09.html' title='Сентябрь 2013'>Сентябрь 2013</a></li>
	<li><a href='../../date/2013/08.html' title='Август 2013'>Август 2013</a></li>
	<li><a href='../../date/2013/07.html' title='Июль 2013'>Июль 2013</a></li>
	<li><a href='../../date/2013/06.html' title='Июнь 2013'>Июнь 2013</a></li>
	<li><a href='../../date/2013/05.html' title='Май 2013'>Май 2013</a></li>
	<li><a href='../../date/2013/04.html' title='Апрель 2013'>Апрель 2013</a></li>
	<li><a href='../../date/2013/03.html' title='Март 2013'>Март 2013</a></li>
	<li><a href='../../date/2013/02.html' title='Февраль 2013'>Февраль 2013</a></li>
	<li><a href='../../date/2013/01.html' title='Январь 2013'>Январь 2013</a></li>
	<li><a href='../../date/2012/12.html' title='Декабрь 2012'>Декабрь 2012</a></li>
	<li><a href='../../date/2012/11.html' title='Ноябрь 2012'>Ноябрь 2012</a></li>
	<li><a href='../../date/2012/10.html' title='Октябрь 2012'>Октябрь 2012</a></li>
	<li><a href='../../date/2012/09.html' title='Сентябрь 2012'>Сентябрь 2012</a></li>
	<li><a href='../../date/2012/08.html' title='Август 2012'>Август 2012</a></li>
	<li><a href='../../date/2012/07.html' title='Июль 2012'>Июль 2012</a></li>
	<li><a href='../../date/2012/06.html' title='Июнь 2012'>Июнь 2012</a></li>
	<li><a href='../../date/2012/05.html' title='Май 2012'>Май 2012</a></li>
	<li><a href='../../date/2012/04.html' title='Апрель 2012'>Апрель 2012</a></li>
	<li><a href='../../date/2012/03.html' title='Март 2012'>Март 2012</a></li>
	<li><a href='../../date/2012/02.html' title='Февраль 2012'>Февраль 2012</a></li>
	<li><a href='../../date/2012/01.html' title='Январь 2012'>Январь 2012</a></li>
	<li><a href='../../date/2011/12.html' title='Декабрь 2011'>Декабрь 2011</a></li>
	<li><a href='../../date/2011/11.html' title='Ноябрь 2011'>Ноябрь 2011</a></li>
	<li><a href='../../date/2011/10/index.html' title='Октябрь 2011'>Октябрь 2011</a></li>
	<li><a href='../../date/2011/09/index.html' title='Сентябрь 2011'>Сентябрь 2011</a></li>
	<li><a href='../../date/2011/08.html' title='Август 2011'>Август 2011</a></li>
	<li><a href='../../date/2011/07/index.html' title='Июль 2011'>Июль 2011</a></li>
	<li><a href='../../date/2011/06/index.html' title='Июнь 2011'>Июнь 2011</a></li>
	<li><a href='../../date/2011/05/index.html' title='Май 2011'>Май 2011</a></li>
	<li><a href='../../date/2011/04/index.html' title='Апрель 2011'>Апрель 2011</a></li>
	<li><a href='../../date/2011/03/index.html' title='Март 2011'>Март 2011</a></li>
	<li><a href='../../date/2011/02.html' title='Февраль 2011'>Февраль 2011</a></li>
	<li><a href='../../date/2011/01.html' title='Январь 2011'>Январь 2011</a></li>
	<li><a href='../../date/2010/12.html' title='Декабрь 2010'>Декабрь 2010</a></li>
	<li><a href='../../date/2010/11/index.html' title='Ноябрь 2010'>Ноябрь 2010</a></li>
	<li><a href='../../date/2010/10/index.html' title='Октябрь 2010'>Октябрь 2010</a></li>
	<li><a href='../../date/2010/09/index.html' title='Сентябрь 2010'>Сентябрь 2010</a></li>
	<li><a href='../../date/2010/08.html' title='Август 2010'>Август 2010</a></li>
	<li><a href='../../date/2010/07/index.html' title='Июль 2010'>Июль 2010</a></li>
	<li><a href='../../date/2010/06.html' title='Июнь 2010'>Июнь 2010</a></li>
	<li><a href='../../date/2010/05.html' title='Май 2010'>Май 2010</a></li>
	<li><a href='../../date/2010/04/index.html' title='Апрель 2010'>Апрель 2010</a></li>
	<li><a href='../../date/2010/03/index.html' title='Март 2010'>Март 2010</a></li>
	<li><a href='../../date/2010/02.html' title='Февраль 2010'>Февраль 2010</a></li>
	<li><a href='../../date/2010/01.html' title='Январь 2010'>Январь 2010</a></li>
	<li><a href='../../date/2009/12/index.html' title='Декабрь 2009'>Декабрь 2009</a></li>
	<li><a href='../../date/2009/11/index.html' title='Ноябрь 2009'>Ноябрь 2009</a></li>
	<li><a href='../../date/2009/10.html' title='Октябрь 2009'>Октябрь 2009</a></li>
	<li><a href='../../date/2009/09.html' title='Сентябрь 2009'>Сентябрь 2009</a></li>
	<li><a href='../../date/2009/08/index.html' title='Август 2009'>Август 2009</a></li>
	<li><a href='../../date/2009/07/index.html' title='Июль 2009'>Июль 2009</a></li>
	<li><a href='../../date/2009/06.html' title='Июнь 2009'>Июнь 2009</a></li>
	<li><a href='../../date/2009/05.html' title='Май 2009'>Май 2009</a></li>
	<li><a href='../../date/2009/04.html' title='Апрель 2009'>Апрель 2009</a></li>
	<li><a href='../../date/2009/03.html' title='Март 2009'>Март 2009</a></li>
	<li><a href='../../date/2009/02.html' title='Февраль 2009'>Февраль 2009</a></li>
	<li><a href='../../date/2009/01.html' title='Январь 2009'>Январь 2009</a></li>
	<li><a href='../../date/2008/12.html' title='Декабрь 2008'>Декабрь 2008</a></li>
	<li><a href='../../date/2008/11.html' title='Ноябрь 2008'>Ноябрь 2008</a></li>
	<li><a href='../../date/2008/10.html' title='Октябрь 2008'>Октябрь 2008</a></li>
	<li><a href='../../date/2008/09.html' title='Сентябрь 2008'>Сентябрь 2008</a></li>
	<li><a href='../../date/2008/08.html' title='Август 2008'>Август 2008</a></li>
	<li><a href='../../date/2008/03.html' title='Март 2008'>Март 2008</a></li>
	<li><a href='../../date/2008/02.html' title='Февраль 2008'>Февраль 2008</a></li>
	<li><a href='../../date/2007/12.html' title='Декабрь 2007'>Декабрь 2007</a></li>
	<li><a href='../../date/2007/11.html' title='Ноябрь 2007'>Ноябрь 2007</a></li>
	<li><a href='../../date/2007/10.html' title='Октябрь 2007'>Октябрь 2007</a></li>
	<li><a href='../../date/2007/09.html' title='Сентябрь 2007'>Сентябрь 2007</a></li>
	<li><a href='../../date/2007/08.html' title='Август 2007'>Август 2007</a></li>
	<li><a href='../../date/2007/07/index.html' title='Июль 2007'>Июль 2007</a></li>
	<li><a href='../../date/2007/06.html' title='Июнь 2007'>Июнь 2007</a></li>
	<li><a href='../../date/2007/05.html' title='Май 2007'>Май 2007</a></li>
				</ul>
			</li>

			
					</ul>
	</div>

</div> <!-- wrapper -->
<div id="footer">
	<a href="../../../feed">Entries (RSS)</a> and <a href="../../../comments/feed">Comments (RSS)</a>. Valid <a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional"><abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a> and <a href="http://jigsaw.w3.org/css-validator/check/referer"><abbr title="Cascading Style Sheets">CSS</abbr></a>.<br />
	Powered by <a href="http://wordpress.org/" title="Powered by WordPress.">WordPress</a> and <a href="http://srinig.com/wordpress/themes/fluid-blue/">Fluid Blue theme</a>.<br />
	<!-- 15 queries. 0.098 seconds. -->
	</div>
</div> <!-- page -->
</body>
</html>
