<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="ru-RU">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>about NetApp   &raquo; technology</title>

<link rel="stylesheet" href="../../wp-content/themes/fluid-blue/style.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../wp-content/themes/fluid-blue/print.css" type="text/css" media="print" />
<link rel="alternate" type="application/rss+xml" title="about NetApp RSS Feed" href="../../feed" />
<link rel="pingback" href="../../xmlrpc.php.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 2.6" />

</head>

<body>
<div id="page">
<div id="header">
	<div id="headertitle">
		<h1><a href="../../index.html" title="about NetApp: Системы хранения данных как предмет разговора">about NetApp</a></h1>
		<p>Системы хранения данных как предмет разговора</p>
	</div> 
	<!-- Search box (If you prefer having search form as a sidebar widget, remove this block) -->
	<div class="search">
		<form method="get" id="searchform" action="../../index.html">
<input type="text" size="20" name="s" id="s" value="Поиск..."  onblur="if(this.value=='') this.value='Поиск...';" onfocus="if(this.value=='Поиск...') this.value='';"/>
</form>
	</div> 
	<!-- Search ends here-->
		
</div>

<div id="navbar">
<ul id="nav">
	<li><a href="../../index.html">Home</a></li>
	<li class="page_item page-item-153"><a href="../../about/trackback.html" title="about">about</a></li>
<li class="page_item page-item-215"><a href="../../distributory-v-rossii/trackback.html" title="Дистрибуторы в России">Дистрибуторы в России</a></li>
<li class="page_item page-item-1327"><a href="../../disti-ua/trackback.html" title="Дистрибуторы в Украине">Дистрибуторы в Украине</a></li>
</ul>
</div>
<div id="wrapper">

	<div id="content">

	
			<p>Posts tagged &#8216;technology&#8217;</p>

	 		
		<div class="navigation">
			<div class="alignleft"></div>
			<div class="alignright"></div>
		</div>

						
			<div class="post" id="post-294">
				<h2 class="posttitle"><a href="../294/trackback.html" rel="bookmark" title="Permanent Link to Silent Data Corruption - неотслеженное повреждение данных">Silent Data Corruption - неотслеженное повреждение данных</a></h2>
				<div class="postmetadata">15 Июнь 2009, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>Без технологии защиты, действующей &#8220;от двери и до двери&#8221;, повреждение данных может пройти незамеченным, и тогда процесс восстановления окажется длительным, трудным и дорогостоящим, если и вообще возможным. Без технологии проверки целостности данных на всем протяжении пути данных, такое необнаруженное повреждение может вести к неожиданным и трудноотлавливаемым проблемам.Недавняя статья в PC Magazine (опуликована 25 августа 2008 года) сообщает о произошедшем в реальной жизни инциденте:</p>
<blockquote><p>&#8220;Netflix заметил проблему повреждения базы данных в своей системе отгрузки товара. В течении дня мы начали замечать аналогичные проблемы в прочих базах нашей торговой системы, пока, наконец, вся система не встала.&#8221;</p>
</blockquote>
<p>Причина обнаружилась в сбойном аппаратном компоненте сети передачи данных, но проблема была не столько в нем, сколько в том, что этот компонент при этом не сообщал ни о каких ошибках в своей работе.</p>
<p>Одно из мест, где повреждение данных может произойти, это процесс записи на диск. Есть два основных вида повреждений диска. Первый - так называемый &#8220;latent sector errors&#8221; или &#8220;неустойчивая ошибка чтения сектора&#8221;, который обычно является следствием физического сбоя диска. Примером может служить ошибка чтения, о которой сообщает дисковый массив.<br />
Такой вид ошибки обычно детектируется с помощью ECC или CRC в канале ввода-вывода, и чаще всего исправляется автоматически.</p>
<p>Другой тип ошибки - &#8220;тихая ошибка&#8221;, которая происходит без каких-либо сообщений.<br />
Не существует способа обнаружить и устранить такую ошибку, без наличия полного контроля целостности &#8220;от и до&#8221;, по всему пути данных от диска, до прикладной программы.</p>
<p>Недавнее исследование<sup>1</sup>, проведенное в Университете Висконсина, Университете Торонто и компании NetApp было сосредоточено на &#8220;тихих ошибках&#8221; жестких дисков. ??сследование проводилось в течении 41 месяца, и анализировались ошибки контрольных сумм 1,53 миллионов жестких дисков.</p>
<p>При исследовании использовались данные блоков на уровне файловой системы, чтобы обнаружить ранее необнаруживаемые ошибки контрольны сумм. В течении 41 месяца &#8220;тихие ошибки&#8221; были зарегистрированы на 0.86% из 358000 дисках SATA и 0.065% из 1.17 миллионов дисков Fibre Channel.  Хотя эти величины и невысоки, но они представляют собой необнаруживаемые, и полностью &#8220;тихие ошибки&#8221;, которые могут привести к потере или искажению данных, и, в результате, значительному простою.</p>
<p>&#8211;<br />
<sup>1</sup><br />
<em>L. Bairavasundaram, G. Goodson, B. Schroeder, A. Arpaci-Dusseau, R. Arpaci-Dusseau, “An Analysis of Data Corruption in the Storage Stack “, FAST08</em></p>
<p>Программный стек также становится более сложным, что делает его более уязвимым к повреждению данных. В качестве примера можно привести ошибочный указатель буфера и пропущенные или записанные &#8220;не туда&#8221; данные. Если данные повреждены внутри программного стека, то файловая система имеет очень ограниченные возможности обнаружить и исправить такую ошибку, и, как следствие, возникает потенциальная проблема необнаруженной ошибки.</p>
<p>Еще в 2001 году Oracle выступил с <noindex><nofollow><a href="http://www.oracle.com/technology/deploy/availability/htdocs/HARD.html"> инициативой HARD</a></nofollow></noindex>- Hardware Assisted Resilient Data - программой мер, обеспечивающих сквозной контроль целостности информации от диска до приложения.<br />
Постепенно к этой программе <noindex><nofollow><a href="http://www.oracle.com/technology/deploy/availability/htdocs/hardf.html">присоединяются новые участники</a></nofollow></noindex>, обеспечивающие соответствующий функционал в своих продуктах. С 2003 года существует стандарт (Protection Information) подготовленный группой ANSI T10, с 2007 года в рамках инициативы DII (Data Integrity Initiative) сотрудничают Oracle, Emulex, Seagate и LSI, организована координирующая группа SNIA Data Integrity Working Group. C 2008 соответсвующие средства и поддержка, по инициативе Oracle, внесены в ядро Linux, начиная от 2.6.27.</p>
<p>Возможно интересующиеся темой уже знают, что в дисках NetApp используется специальный размер сектора - 520 байт, вместо стандартных 512. ??менно эти 8 байт на сектор и используются для хранения дополнительной информации для защиты и обнаружения искажения информации на самом нижнем, ниже RAID уровне.</p>
<p>Вот как определяет этот механизм группа ANSI T10:<br />
<img src="/pics/t10sect.png" alt="ANSI T10 PI sector specification" /></p>
<p>Protection Informаtion Standart (PI) это расширение спецификации SCSI Block Command, утвержденного техническим комитетом T10. Спецификация PI относится к коммуникации между контроллером SCSI и устройством хранения. Стандартным образом данные размещаются в 512-байтных блоках. Стандарт DIF определяет дополнительные 8 байт, увеличивающие сектор до 520 байт. Дополнительные байты используются для хранения тегов, которые используются для проверки содержимого 512 байт данных в секторе. </p>
<p>FC HBA (как SCSI-контроллер в данном случае) генерирует соответствующие 8 байт служебных данных, которые записываются вместе с сектором. В дальнейшем это позволить иметь дополнительный &#8220;слой&#8221; защиты в случае ошибочного чтения или записи данных на самом &#8220;низком уровне&#8221;.</p>
<p>В настоящий момент на сайте Oracle <noindex><nofollow><a href="http://www.oracle.com/technology/deploy/availability/htdocs/vendors_hard.html">в списке поддержавших и проверенных тестами Oracle</a></nofollow></noindex> EMC (Symmetrix), NetApp (все модели), Hitachi Data Systems (USP), а также &#8220;братья&#8221; последней, такие как HP XP и Sun StorEdge 99xx, и малоизвестные у нас системы NEC и Fujitsu.</p>
<p>Как видно из списка, среди модульных (не-&#8221;highend&#8221;) систем пока эта технология реализована (с 2004 года) только у NetApp, и у них единственных проходит полный набор тестов HARD, хотя я слышал, что EMC CLARiiON также использует &#8220;нестандартный&#8221; (на самом деле как раз стандартный, в соответствии с новым стандартом ANSI T10) размер сектора, с той же целью.<br />
Соответствующее ПО под названием SnapValidator обеспечивает работу контрольных алгоритмов Oracle внутри системы хранения, и гарантирует полную целостность данных Oracle &#8220;от двери до двери&#8221;, от блока данных в памяти сервера, до сектора данных на &#8220;блине&#8221; жесткого диска.</p>
<p><noindex><nofollow><a href="http://www.netapp.com/us/products/platform-os/snapvalidator.html">SnapValidator на сайте NetApp</a></nofollow></noindex></p>
<p><noindex><nofollow><a href="http://www.t10.org/ftp/t10/document.03/03-224r0.pdf">T10 Committee: End-to-End Data Protection Justification, July 1, 2003.</a></nofollow></noindex></p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="netapp/index.html" rel="tag">netapp</a>, <a href="technology.html" rel="tag">technology</a>, <a href="techtalk/index.html" rel="tag">techtalk</a><br />					Раздел: <a href="../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../294/trackback.html#respond" title="Комментарий к записи Silent Data Corruption - неотслеженное повреждение данных">Комментарий</a>									 </div>
			</div>
	
						
			<div class="post" id="post-269">
				<h2 class="posttitle"><a href="../269/trackback.html" rel="bookmark" title="Permanent Link to Проблемы (и решения) Usable Space. Часть 1. Основы.">Проблемы (и решения) Usable Space. Часть 1. Основы.</a></h2>
				<div class="postmetadata">4 Май 2009, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>В ближайшие несколько постов я бы хотел поговорить о некоторых аспектах usable space на системах хранения NetApp. Usable Space на NetApp, а также методы его образования из raw, это также источник бесчисленных спекуляций наших уважаемых конкурентов (в дальнейшем &quot;Н.У.К.&quot; ;).   <br />Я отдельно остановлюсь на &quot;говнилках&quot; на эту тему в отдельном посте, а пока давайте разберем фундаментальные основы того, как из Raw Space образуется Usable Space, чтобы подойти к разбору FUD уже теоретически подкованными.</p>
<p>Но начнем издалека.</p>
<p>??так, из чего складывается пространство usable space?   <br />Один из документов NetApp, на который я давал ссылку раньше, так и называется:     <br /><a href="../178/trackback.html">Trading Capacity for Data Protection – A Guide to Capacity Overhead on a StoreVault Storage System</a>     <br />Мы платим за надежность хранения raw-байтами, и получаем, в итоге, меньшее по размерам пространство, но с разнообразными &quot;фичами&quot;. Это естественный процесс.</p>
<p>Простейший случай обмена &quot;байтов на надежность&quot; это RAID. Мы платим пространством одного диска (в случае RAID-5), двух (RAID-6), или половиной пространства (RAID-10 AKA RAID 0+1) за надежность и быстродействие.   <br />Поверх RAID мы можем создать журналируемую файловую систему, и получаем &quot;фичу&quot; хранения и обработки &quot;файлов&quot;, то есть огранизованных структур данных, со всем им присущим, и, вдобавок, защищаем целостность этих структур. Но, разумеется, партиции, загрузочные области, таблицы размещения файлов, ACL, структуры директориев, и прочее, все это также вычтется в свою очередь из пространства, дав нам взамен вышеописанные возможности, которых не было на простом и тупом raw-диске.    <br />?? так далее, и так далее.</p>
<p>Мы, несомненно теряем на этих процессах мегабайты за мегабайтами, но получаем взамен все новые и новые возможности.   <br />Смешно возражать, что, мол, если бы вы не пользовались на вашей &quot;венде&quot; NTFS-ом, а работали бы прямо в адресации ATA, вы бы могли использовать больше места на диске, которые с ним заняты &quot;непонятно чем&quot;.    <br />Уже всем сегодня понятно - &quot;чем&quot;.</p>
<p>??з чего же складывается, в свою очередь, usable space на NetApp?</p>
<p>Как вы уже знаете (по крайней мере те, кто давно читает этот блог;), NetApp, как &quot;система хранения данных&quot;, довольно &quot;высокоуровнева&quot; по природе, если воспользоваться терминами из области языков программирования. Также как, например, какой-нибудь C# или Java позволяет пишущему полностью абстрагироваться в программе от, например, физической структуры регистров процессора и управления памятью, и заняться более продуктивными вещами, чем вычисления адресов, так и в случае использования пространства хранения на NetApp администратор системы хранения может абстрагироваться от &quot;дисков&quot; и &quot;raw bytes&quot;.</p>
<p>Обычно, с повышением &quot;уровня&quot; языка, растет производительность труда программиста, а также становятся доступны многочисленные удобства, хотя апологеты ассемблера и скажут нам (соверщенно справедливо, кстати), что &quot;высокоуровневый программист&quot; и потерял за счет этого ряд возможностей по &quot;тонкой оптимизации&quot;. Однако, в окружающей нас жизни, мы, как правило, готовы пожертвовать определенными процентами эффективности программирования ради его удобства, &quot;фич&quot; и скорости разработки.   <br />Подобным путем идет и NetApp.</p>
<p>Он также как и &quot;обычные системы хранения&quot; (тм) использует нижний уровень виртуализации, в виде RAID (RAID это, с точки зрения железа ведь тоже некий &quot;виртуальный девайс&quot;), но начиная с версии своей OS Data ONTAP версии 7 сделан еще один шаг в направлении &quot;высокоуровневой&quot; виртуализации - Aggregates и FlexVol-ы.</p>
<p>Aggregates это &quot;слой дисковой виртуализации&quot;, структура (одна или несколько), в которую включены множество имеющихся у системы дисков, своеобразный disk pool, среди которых и распределяется нагрузка ввода-вывода.</p>
<p>Я уже <a href="../15/trackback.html">писал раньше</a> о важности такого параметра, как IOPS - Input-Output operations Per Second.     <br />Для отдельного диска величина IOPS сравнительно невелика (в пределах двух, максимум трех сотен для SAS или FC, значительно меньше для SATA). Для того, чтобы увеличить производительность в IOPS, создатели дисковых систем хранения объединяют диски, например с помощью создания RAID-групп. Так, например, RAID-10 (&quot;зеркало&quot; с &quot;чередованием&quot;) из 10 дисков будет иметь примерно вдесятеро большую производительность по IOPS, чем отдельный входящий в него диск. Это стало возможным за счет того, что, хотя для внешнего потребителя RAID это &quot;один большой диск&quot;, внутри же он состоит из множества меньших, на каждый из которых мы можем писать свою порцию более-менее в параллельном режиме.</p>
<p>Однако бесконечно удлинять RAID тоже нельзя, так как снижается надежность и ухудшаются некоторые другие параметры. Кроме того далеко не всегда для данных, требующих высокой скорости, нужно так много места. А объединив 10 дисков по 300GB в RAID-10 мы получим &quot;диск&quot; размером полтора терабайта (300*10/2) под один только наш &quot;скоростной файл&quot;. ?? так для каждой задачи.   <br />Как правило производители &quot;обычных систем хранения&quot;(тм) выходят из положения путем возможности &quot;конкатенации&quot; (сложения A+B+C+D&#8230;) сравнительно небольших RAID-групп, и создании на получившемся пространстве так называемых LUN - логических устройств - &quot;дисков&quot;.    <br />Как видите, тут тоже своя &quot;виртуализация&quot; имеется.</p>
<p>Большим прорывом в свое время стала разработка уже покойной компанией DEC дисковых систем хранения, в которых появилась возможность объединить все &quot;адресное пространство&quot; жестких дисков, имеющихся в системе, в единый &quot;пул байт&quot;, и уже поверх этого пула образовывать &quot;виртуальные RAID&quot; и разделы данных. Наследницы этих систем по сей день производятся компаний HP под названием EVA - Enterprise Virtual Array, и занимают до сих пор довольно значительную долю рынка, хотя нельзя закрывать глаза на тот факт, что системы эти постепенно (и все заметнее) морально устаревают, несмотря даже на столь прорывную и революционную идею в их основе.</p>
<p>Преимуществом объединения всех дисков в &quot;общий пул&quot; является возможность распределить входную нагрузку на <strong>все</strong> эти диски, работающие параллельно, нарезав на них нужное количество LUN нужных нам размеров, которые, свою очередь, также окажутся размазанными на все наши диски. При этом мы не платим за это &quot;длинным RAID&quot; и всеми его минусами, в виде, например, длительного ребилда и пониженной надежности. То есть, если мы имеем систему с 30 дисками, то, если мы сведем все эти диски в один aggregate, нарежем на нем нужное количество FlexVol, и насоздаем LUN (или будем использовать FlexVol под хранение файлов), то производительность каждого такого FlexVol, и LUN на нем, будет равна: 30*300 IOPS = ~ 9000 IOPS.    <br /><em>Все цифры, разумеется, условные и грубоприближенные, но с сохранением порядка.</em></p>
<p>??так, начиная с Data ONTAP 7, структура хранения выглядит примерно так:</p>
<p>
<a href="/pics//diskstruct1.png"><img src="/pics//diskstruct1-300x108.png" alt="" title="diskstruct1" width="300" height="108" class="alignnone size-medium wp-image-284" /></a> </p>
<p>То есть - физические диски, над ними Aggregate, над ними RAID-ы в WAFL, на ней FlexVol-ы, на которых уже, в свою очередь, располагаются LUN-ы или &quot;сетевые папки&quot; NAS.   <br />Каждый из этих уровней немножко отнимает от raw space, и добавляет за это каких-нибудь возможностей.</p>
<p>Продолжение в следующем посте.   </p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="netapp/index.html" rel="tag">netapp</a>, <a href="technology.html" rel="tag">technology</a>, <a href="techtalk/index.html" rel="tag">techtalk</a>, <a href="usable-space.html" rel="tag">usable space</a><br />					Раздел: <a href="../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../269/trackback.html#respond" title="Комментарий к записи Проблемы (и решения) Usable Space. Часть 1. Основы.">Комментарий</a>									 </div>
			</div>
	
						
			<div class="post" id="post-236">
				<h2 class="posttitle"><a href="../236/trackback.html" rel="bookmark" title="Permanent Link to Еще несколько слов об оптимальности.">Еще несколько слов об оптимальности.</a></h2>
				<div class="postmetadata">10 Апрель 2009, 8:55 <!-- от  --></div>
				<div class="postentry">
					<p>Специально свое мнение вынесу из комментов, так как читают меня в основном из RSS, и в комменты мало кто ходит.</p>
<p>Я не считаю, что Fibre Channel это плохо. FC это замечательная технология. Но любая технология лучше всего работает на своем месте, там, где она нужнее, там, где ее преимущества наиболее проявляются.</p>
<p>Целью же моего предыдущего поста была попытка донести мысль, что в случаях, когда то или иное дорогостоящее решение не дает существенных, сравнимых с затратами на него результатов, использовать его неразумно и расточительно. Те же деньги можно потратить с гораздо большим результатом иным способом. ?? этих способов немало.<br />
Затраты должны быть соизмеримы, и решения должны быть соразмерны задачам.</p>
<p>В прошлом своем посте я не столько пытался &#8220;опустить&#8221; FC, сколько донести мысль, что когда клиент покупает на &#8220;последние деньги&#8221; какой-нибудь Xyratex или Infortrend (все совпадения с реальным торговыми марками случайны;), при этом наполняет его дисками c &#8220;митина&#8221;, потому что &#8220;нет денег на родные&#8221;, но при этом собирается половину, а то и две трети цены массива потратить просто на &#8220;провод&#8221; для подключения, то это, мне кажется, крайний случай несбалансированности. </p>
<p>Приводя аналогии из полюбившегося автопрома: человек покупает какую-нибудь вазовскую &#8220;классику&#8221;, возить тещу и помидорную рассаду на дачу. Ну что, вполне себе задача, практическая. Не гонки Формулы, но не всем же, в конце концов, нужна Формула? Вот такая наша жизнь, в ней тоже надо ездить на дачу.<br />
?? вот, вместо покупки, например, более новой и безопасной машины, или вместо того, чтобы потратить деньги, например, на перебор двигателя, юстировку колес и промывку карбюратора-инжектора, покупатель тратит деньги, выкроенные из семейного бюджета на дачный автомобиль, на установку в &#8220;классику&#8221; ксеноновых фар, гоночных &#8220;ковшей&#8221;-сидений из красной кожи, низкопрофильной резины и брызговиков Sparco, на остатки.</p>
<p>По моему мнению, FC в entry (да зачастую и не только entry) level это типичный пример гаражного тюнинга и &#8220;синих писалок&#8221; в IT. Это эффектно, но, как и дырки в глушителе, выдающие мощный рев на светофоре, нисколько не помогают с него уехать быстрее.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="fc.html" rel="tag">fc</a>, <a href="iscsi/index.html" rel="tag">iscsi</a>, <a href="technology.html" rel="tag">technology</a><br />					Раздел: <a href="../category/justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;" rel="category tag">justread</a>&nbsp;&nbsp;|&nbsp;
					<a href="../236/trackback.html#respond" title="Комментарий к записи Еще несколько слов об оптимальности.">Комментарий</a>									 </div>
			</div>
	
						
			<div class="post" id="post-234">
				<h2 class="posttitle"><a href="../234/trackback.html" rel="bookmark" title="Permanent Link to Кризис - время искать оптимальные решения. Часть 2">Кризис - время искать оптимальные решения. Часть 2</a></h2>
				<div class="postmetadata">9 Апрель 2009, 7:29 <!-- от  --></div>
				<div class="postentry">
					<p>Почти всегда, начиная разговор с клиентом по поводу использования iSCSI вместо Fibre Channel, раз за разом я сталкиваюсь с одним упорным возражением:</p>
<p><i>&#8220;Ну&#8230; хм&#8230; Это же медленно!&#8221;</i></p>
<p>Ну, казалось бы, очевидно: FC это 4Gb/s, а iSCSI - 1Gb/s, &#8220;один&#8221; ведь в четыре раза меньше, чем  &#8220;четыре&#8221; ведь так?</p>
<p>Давайте разберем что здесь на самом деле &#8220;медленно&#8221; и медленно ли.</p>
<p>Для определенности давайте рассматривать какую-нибудь реальную задачу.</p>
<p>Вот пример:<br />
Требуется система хранения данных для консолидации данных 4 серверов, 1 файловый сервер и 3 сервера баз данных. Необходимо обеспечить двухпутевое отказоустойчивое подключение.</p>
<p>Но сперва немного теории.</p>
<p>Я уже писал на тему странного спутывания в восприятии совершенно разных параметров канала передачи данных: &#8220;полосы пропускания&#8221; (анг. &#8220;bandwith&#8221;) и &#8220;скорости&#8221; (анг. &#8220;speed&#8221;).<br />
Для интересующихся подробностями просто сошлюсь на <a href="../38/trackback.html">ранее опубликованный пост</a>, а остальным перескажу вкратце.<br />
&#8220;Скорость&#8221; канала передачи данных равна скорости света в соответствующей среде, и она постоянная, вне зависимости, используем мы 10Mb/s Ethernet или 16GB/s Infiniband.<br />
Переводя на аналогии из &#8220;повседневной жизни&#8221; это ограничение скорости на дороге - 100 km/h.<br />
Все автомобили по дороге передвигаются с разрешенной скоростью, и ее не превышают по причине физического ее ограничения на уровне физических констант.</p>
<p>В чем же отличие?<br />
В полосе пропускания.<br />
Полоса пропускания - это &#8220;рядность автострады&#8221;, это способность пропустить через себя &#8220;много данных&#8221; сразу. Но многорядность автострады никак не ускоряет движение одинокого автомобиля, проезжающего раз в минуту.</p>
<p>Несколько парадоксальный вывод, который я делал в том посте требует некоторого волевого усилия для осознания.<br />
Неважно, насколько &#8220;быстрым&#8221; (с какой ширины полосой пропускания) интерфейсом соединена ваша система хранения с сервером, если объемы обработки данных этим сервером не достигают потолка имеющейся полосы пропускания.</p>
<p>Если скорость считывания и записи сервера с системы хранения, например, не превышают 10 Мбит/с, то <b>совершенно неважно для быстродействия</b>, используете ли вы 100Mbit/s Fast Ethernet, FC, Infiniband, или подставьте_любой_баззворд_из_презентации.<br />
Если вы не используете даже имеющуюся полосу пропускания целиком, то расширение ее &#8220;неиспользуемой части&#8221; в 10 раз не приведет к сколь-нибудь значимому увеличению реального быстродействия системы.</p>
<p><i>Да, я знаю про разницу в латентности разных интерфейсов, о перспективности того или иного решения в будущем, о функциональных возможностях, давайте не станем углубляться в детали для того, чтобы рассмотреть лес за деревьями, именно он в данном случае важен, а не теоретические вариации, укладывающиеся в статистический разброс 5%</i></p>
<p>Вернемся к нашей практической системе хранения для 4 серверов.<br />
В ходе предварительного анализа производительности, наиболее нагруженный сервер баз данных показал, по данным Windows Performance Monitor, следующие показатели:</p>
<p>Disk Read bytes/s   2700902/Average   63587550/Max<br />
Disk Write bytes/s   736811/Average    1616167/Max </p>
<p>То есть, самый нагруженный сервер системы, в максимуме нагрузки, достигал порога чтения всего, примерно, в 60-65 мегабайт в секунду!<br />
Это всего лишь (в пике дневной нагрузки, прошу заметить!) около 55-60% от полосы пропускания одного интерфейса Gigabit Ethernet, или, в случае типовой нагрузки в 2.5-3MB/s, всего около 2-3% от полосы пропускания GigE!</p>
<p>Возможно в данном случае мы упираемся в предел возможности локальных дисков серверов, на смену которым призвана встать система хранения, и сервер имеет большой запас по производительности, если мы обеспечим ему широкую полосу пропускания для данных? Но нет, показатель Disk Read/Write Queue редко когда превышает значение 8-9, что означает относительно слабо нагруженную дисковую подсистему, значит в дисковую производительность сервер практически не упирается.</p>
<p>??так, давайте посчитаем. В случае нашей рассмотренной выше небольшой IT-системы из четырех серверов, в случае выбора FC нам необходимы:<br />
1. по два однопортовых или по одному двухпортовому FC HBA на каждый сервер - 8 однопортовых или 4 двухпортовых (QLogic QLE2462 2port - 700$ * 4 = 2400$)<br />
2. два FC-коммутатора (недостаточно встроенных FC-портов для подключения всех 6 линков) допустим, пусть это будут массовые и недорогие Brocade 200E - 4000$ * 2 = 8000$.<br />
3. Лицензия на FC (в зависимости от выбранного массива цена варьируется, например для системы типа FAS2050 это около 1200$ для одноконтроллерной и 2400$ для двухконтроллерной, отказоустойчивой, &#8220;кластерной&#8221; системы)<br />
4. ПО поддержки многопутевости (стоит заметить, что в поставке Windows средство обеспечения многопутевости MPIO не поддерживает FC, только iSCSI, и использование MPIO с FC требует установки дополнительного программного модуля, так называемого DSM, обычно предлагаемого поставщиком решения системы хранения, он недорог, но тоже не 0$)<br />
5. Кабеля FC optical LC-LC для подключения серверов к коммутаторам (8 шт) и коммутаторов к массиву (2 шт) (LC-LC optical 5m - 50$ * 10 = 500$).<br />
6. затраты на монтаж и настройку (варьируется).<br />
Кажется ничего не забыл :)</p>
<p>??того, нетрудно видеть, только на возможность использования протокола Fibre Channel мы потратим по меньшей мере около 12-15 тысяч долларов! При этом, как я показал выше, эти 12 тысяч совершенно не увеличат производительность получившейся системы. Они потрачены исключительно &#8220;на понты&#8221;, на возможность бросить в разговоре с коллегами &#8220;а, мы тут файбер ченэл себе прикупили&#8221;. :)<br />
&#8220;Хороший понт дороже денег&#8221;, не спорю. ;) Но 12 тысяч это 12 тысяч. Тем более в наше непростое время на дворе.</p>
<p>Но если бы мы использовали эти, вполне существенные деньги, на что-нибудь действительно дающее реальный эффект, например на пару дополнительных серверов для других задач, <del>премию сисадминам</del> оплату услуг хорошего программиста-оптимизатора баз данных, или, например, в случае системы хранения данных, на дополнительные 10-12 дисков, то <b>за те же деньги</b> мы бы получили (см. ранее про IOPS дисков) систему хранения по меньшей мере на 1800-2500 IOPS быстрее!</p>
<p>?? только за счет отказа от &#8220;крутого&#8221;, &#8220;понтового&#8221;, но избыточного, и поэтому совершенно &#8220;неполезного&#8221; в данном случае Fibre Channel.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="iscsi/index.html" rel="tag">iscsi</a>, <a href="netapp/index.html" rel="tag">netapp</a>, <a href="technology.html" rel="tag">technology</a><br />					Раздел: <a href="../category/justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;" rel="category tag">justread</a>,  <a href="../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../234/trackback.html#comments" title="Комментарий к записи Кризис - время искать оптимальные решения. Часть 2">Комментарии (3)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-204">
				<h2 class="posttitle"><a href="../204/trackback.html" rel="bookmark" title="Permanent Link to Методы записи во Flash memory в SSD">Методы записи во Flash memory в SSD</a></h2>
				<div class="postmetadata">28 Январь 2009, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>В связи с нынешней активизацией на рынке SSD и Flash, возможно кому-то будет интересно посмотреть, какие продвинутые методы применяют разработчики решений, для преодоления присущей flash-memory по своей природе ограничений на число циклов записи. Ограничения сегодня уже достаточно далеко отодвинуты, но, тем не менее, совсем сбрасывать со счетов этот фактор нельзя. Основной метод, применяемый для преодоления этого недостатка, это так называемый wear-leveling. Что это, и как работает, в объяснении &#8220;на пальцах&#8221; найдено в <a href="/docs/FAQ_flash_drive_wear_leveling.pdf">FAQ компании Corsair</a> (89KB, PDF).</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="technology.html" rel="tag">technology</a>, <a href="techtalk/index.html" rel="tag">techtalk</a><br />					Раздел: <a href="../category/justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;" rel="category tag">justread</a>,  <a href="../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../204/trackback.html#comments" title="Комментарий к записи Методы записи во Flash memory в SSD">Комментарии (4)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-178">
				<h2 class="posttitle"><a href="../178/trackback.html" rel="bookmark" title="Permanent Link to Capacity guide">Capacity guide</a></h2>
				<div class="postmetadata">10 Ноябрь 2008, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>Любопытный документ найден в форумах <a href="http://communities.netapp.com/index.jspa">NetApp Communities</a> (кстати, рекомендую. Это открытый ресурс).</p>
<p>
&#8220;Обмен дисковой емкости на зашиту данных&#8221;<br />
Хотя это руководство и для StoreVault (S-series), но изложенное там верно и для FAS. ??з этого документа можно выяснить как превращается raw capacity дисков в usable capacity дискового пространства NetApp, и что вы получаете при этом взамен уменьшения пространства. </p>
<p><a href='/pics//wp-capacity-01-2008.pdf'>Trading Capacity for Data Protection – A Guide to Capacity Overhead on a StoreVault Storage System</a></p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="netapp/index.html" rel="tag">netapp</a>, <a href="technology.html" rel="tag">technology</a>, <a href="techtalk/index.html" rel="tag">techtalk</a><br />					Раздел: <a href="../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../178/trackback.html#respond" title="Комментарий к записи Capacity guide">Комментарий</a>									 </div>
			</div>
	
						
			<div class="post" id="post-157">
				<h2 class="posttitle"><a href="../157/trackback.html" rel="bookmark" title="Permanent Link to Дедупликация. Новости и слухи.">Дедупликация. Новости и слухи.</a></h2>
				<div class="postmetadata">29 Август 2008, 13:34 <!-- от  --></div>
				<div class="postentry">
					<p><em>Мне в очередной раз на хвосте мышко притащила свежие слухи о ближайшем будущем этой темы.</em></p>
<p>Во первых, многие заметили, произошел отказ от аббревиатуры <strong>A-SIS</strong>, в пользу более понятного <strong>NetApp Dedupe </strong>и просто <strong>Deduplication</strong>. Шаг естественный. Немногие сходу вспомнят, что A-SIS это <em>Advanced Single Instance Store</em>, еще меньше - поймут о чем речь. Переход от &#8220;инженерной&#8221; аббревиатуры к &#8220;самоописывающему&#8221; названию есть вполне правильный путь.</p>
<p>Во вторых, проект &#8220;Дедупликация&#8221; скоро будет иметь две ветви: <strong>FAS Deduplication</strong> (ныне существует), и <strong>VTL Deduplication</strong>, ожидаемый давно, и обещаемый в первом ограниченно доступном для клиентов виде в конце этого года (сейчас она проходит ограниченное бета-тестирование).<br />
Казалось бы, что за труд внедрить уже работающую технологию на параллельной линейке той же компании? Однако же как оказалось не все так просто. По сути под названием <strong>VTL Deduplication </strong>мы будем иметь некий принципиально новый продукт.<br />
Не зря официальные лица так настойчиво повторяли весь год про &#8220;backup-oriented&#8221; и &#8220;stream optimized&#8221;.</p>
<p>Прежде всего, это действительно, в отличие от FAS Deduplication, ориентированного более на General Purpose применение, будет специализированное решение для дискового бэкапа, специально для этого заточенное. Причем заточенное настолько, что, как у меня сложилось впечатление, это будет принципиально иной по своему &#8220;коду&#8221; продукт под уже &#8220;раскрученным&#8221; названием. В пользу этого говорит и то, насколько долго с ним возятся.</p>
<p>Так, например, в VTL Dedupe, кроме уже известного режима <strong>post-process</strong>, который сохранился, добавится и некий <strong>inline</strong>. То есть система будет пытаться проводить дедупликацию в том числе и непосредственно &#8220;в онлайне&#8221;, в процессе поступления данных на диски, аналогично online compression. </p>
<blockquote><p>Практический кейс: У меня есть 100 идентичных образов виртуальных машин по 1GB каждая (ну например 100 установленных Windows XP, отличающихся только несколькими байтами hostname). Я бэкаплю их на диски NetApp со включенной дедупликацией. Сколько понадобится выделить под это места? Нет, не 1GB. Даже несмотря на дедупликацию сперва нам нужно будет все 100GB, а затем 99GB нам вернутся, когда система завершит цикл дедупликации, происходящий в постпроцессе, в &#8220;оффлайне&#8221;.<br />
В случае VTL Dedupe скорее всего какая-то часть дедупликации пройдет уже в процессе записи. </p></blockquote>
<p>Второй момент, натолкнувший меня на мысль о принципиально ином продукте, был сведениями о том, что VTL Dedupe будет оперировать переменными размерами блока.</p>
<p>Напомню вкратце принцип работы FAS Deduplication.<br />
Система хранения NetApp FAS устроена таким образом, что для каждого блока данных WAFL &#8220;внутри системы&#8221; вычисляется и хранится некая хэш-строка. Она довольно давно используется для дополнительного контроля целостности данных при их обработке в системе. Как я понимаю, для дедупликации просто воспользовались уже существующей в системе возможностью. Следствием стало то, что включение дедупликации как таковой, почти никак не затрагивает производительность самой системы. Ведь система и так уже эту функцию имела, добавился только некий процесс с существующими данными, осуществляемый в фоне, с низким приоритетом. Это позволило использовать дедупликацию в том числе и для систем хранения &#8220;общего применения&#8221;, что на сегодня не предлагает ни один из конкурентов.</p>
<p>??так, каждый 4kb-блок WAFL сопровождается хэш-строкой, идентифицирующей, с той или иной степенью достоверности, его уникальность. Если мы находим два идентичных хэша, то мы можем предположить, что соответствующие им блоки данных также иденичны. Для того, чтобы избежать так называемой &#8220;hash collision&#8221;, когда по какой-то причине один и тот же хэш соответствует разным блокам, такое возможно при не слишком сложном алгоритме вычисления хэша (который применяется в NetApp, дабы не грузить излишне систему) система проводит для таких блоков &#8220;контрольную проверку&#8221; путем простого побайтного сравнения этих 4kb-блоков. Если блоки действительно совпали, то один из них освобождается, а в таблице размещения указатель на него переставляется на оставшийся.</p>
<p>Однако тут мы сталкиваемся с неприятной особенностью. Так как файловая система оперирует с фиксированными блоками, то смещение в блоке идентичных данных даже на один байт сделает их хэши полностью различными, и дедупликация эти блоки как дубликаты уже не найдет.</p>
<p>Это является основной причиной иногда наблюдаемой на практике невысокой эффективности дедупликации. Так, например, в случае VMFS-файлов VMware, обычно строго выровненных относительно границы блока, эффективность дедупликации будет высока. Однако, например, файлы резервных копий, создаваемых системами резервного копирования, часто имеют внутри себя то или иное смещение, при том, что физически содержимое их может быть и идентично.<br />
<i>??льдар, похоже это вот как раз твой случай.</i></p>
<p>Так вот, повторюсь, по слухам, VTL Deduplication будет не только уметь производить поиск дубликатов в окне переменной длины, но и знать некоторые популярные форматы бэкапных данных, и учитывать их свойства при работе. Это может весьма положительно сказаться на эффективности для именно бэкапных приложений.    </p>
<p>Однако, как и в случае с FAS Deduplication, NetApp сохранил очень приятную для нас, &#8220;конечников&#8221;, модель с бесплатной лицензией. То есть лицензия-то все равно есть, и для включения дедупликации она все равно нужна, но она бесплатна. Нужно ее только заказать через вашего партнера. То есть ситуация как с лицензией для iSCSI. Она есть, но она бесплатна.</p>
<blockquote><p><font color="#A0A0A0" size=1>?? еще несколько слов в заключение. Уважаемые ребята из московского представительства: Роман, Роман, Саша :). Я знаю, что вы меня читаете ;) Бога ради, если вы считаете, что я вдруг опять ненароком тут засветил какую-то Страшно Охраняемую Военную Тайну, которую Рано Показывать Публике - свяжитесь со мной, что-нибудь придумаем, исключительно из соображений доброй воли. Угум?</font></p></blockquote>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="fas.html" rel="tag">FAS</a>, <a href="netapp/index.html" rel="tag">netapp</a>, <a href="technology.html" rel="tag">technology</a>, <a href="techtalk/index.html" rel="tag">techtalk</a>, <a href="vtl.html" rel="tag">VTL</a>, <a href="deduplikaciya.html" rel="tag">дедупликация</a>, <a href="sluxi.html" rel="tag">слухи</a><br />					Раздел: <a href="../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../157/trackback.html#comments" title="Комментарий к записи Дедупликация. Новости и слухи.">Комментарии (2)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-155">
				<h2 class="posttitle"><a href="../155/trackback.html" rel="bookmark" title="Permanent Link to «Передний край» – iWARP">«Передний край» – iWARP</a></h2>
				<div class="postmetadata">20 Август 2008, 7:43 <!-- от  --></div>
				<div class="postentry">
					<p><strong>Что есть что на горизонте.</strong></p>
<p>Стремительное продвижение технологий в повседневность IT-служб иногда поразительно. Сегодня, когда интерфейсы Gigabit Ethernet устанавливаются уже даже в ноутбуки, реальностью становится 10Gigabit Ethernet, который еще пару лет назад был чем-то из области лабораторных изысканий. Что же принесет нам этот виток скоростной гонки интерфейсов – давайте посмотрим.</p>
<p><strong>RDMA</strong></p>
<p><strong>RDMA </strong>это <strong>Remote DMA</strong>. Для тех, кто за заботами сегодняшнего дня забыл об основах, позволю себе немного поликбезничать.<br />
<strong>DMA</strong>, или <strong>Direct Memory Access</strong>, это классическая технология ввода-вывода данных с помощью специального программируемого контроллера DMA – прямого доступа к памяти.</p>
<p>Ввод-вывод данных, одна из основных операций в вычислительной системе, может осуществляться разными путями. Например путем процессорных операций. Процессор берет байт из порта ввода и заносит его в ячейку памяти. ??ли наоборот, считывает его из ячейки памяти и отправляет в порт вывода. Ясно видно, что эти операции чрезвычайно загружают собой процессор, ведь такое действие надо совершить с каждым байтом (или вернее «словом», оно может быть и многобайтным).</p>
<p>Проблема с загрузкой процессора при вводе-выводе была решена использованием процедуры DMA – Direct Memory Access. Процессор единожды сообщает специальному контроллеру DMA, с какого или в какой адрес в памяти он желает осуществить перемещение данных, а контроллер исполняет, по завершении уведомляя процессор об исполнении. Получает или передает байты жестким дискам, выводит массивы данных в видеоконтроллер или превращает «цифру» в звук.<br />
Результат обычно весьма впечатляющ. IT-шники со стажем должны помнить, какой эффект давал переход жестких дисков персональных компьютеров с режима PIO (Programmed Input-Output) к DMA (и в дальнейшем к UltraDMA), степень загрузки процессора на интенсивных дисковых операциях снижалась в разы.</p>
<p>Но DMA это лишь локальные операции, проще говоря, возможные только в области памяти и устройств одного компьютера. А что если сделать технологию DMA возможной для разных и между компьютерами?<br />
Так родилась идея <strong>RDMA </strong>– <strong>Remote Direct Memory Access</strong>.</p>
<p>Технология эта отнюдь не нова. За ее разработкой следит представительный <nofollow><a href="http://www.rdmaconsortium.org/home">RDMA Consortium</a></nofollow>, куда входят многие гранды индустрии, такие как IBM, Cisco, NetApp, EMC, HP, Intel, Microsoft, общим числом около 50. Она шумела как новинка еще в 1998 году, а в 2003 году RDMA Consortium объявил о завершении всех запланированных спецификаций. Однако множество проблем в реализации ограничили ее применение high-end HPC (high-performance computing) системами. RDMA той или иной форме применялась на системах Cray, Silicon Graphics и ряде других, столь же легендарных «небожителей».<br />
Однако шли годы, и то, что было уделом экспериментальных и сверхвысокопроизводительных вычислений стало нашей повседневностью, вот и до 10G Ethernet очередь дошла.</p>
<p>Основной идеей, родившей и развивающей RDMA как концепцию, была «размещать нужные данные непосредственно в память приложения», минуя многочисленное каскадное буферирование «из буферов сетевого адаптера в буфера сетевого протокола, из него в буфера OS, из них в буфера дисков, и так далее». ??менно поэтому в приложении к RDMA часто используется термин «zero-copy», то есть «отсутствие копирования», имея ввиду, конечно же, вот такое вот многократное промежуточное копирование между источником и получателем данных.</p>
<p>Наиболее известной реализацией RDMA и его «zero-copy» в применении к системам передачи данных на сегодняшний день является Infiniband, разработанный в соответствии с этими требованиями. На сегодняшний день это наиболее известная сетевая система для высокопроизводительных кластерных интерконнектов, в свое время, за счет своей открытости и меньшей цены, вытеснившая из этой области проперитарный Myrinet. </p>
<p><strong>iSCSI – SCSI over IP</strong><br />
Я уже не раз писал о iSCSI, и останавливаться подробно наверное нет смысла. Сегодня уже все так или иначе находящиеся в теме систем хранения знают что это. <strong>iSCSI </strong>это способ передавать обычные и привычные SCSI-пакеты «упакованными» (модное словечко: «инкапсулированными») в IP-пакеты, и транспортировать их в любой среде передачи IP, например по Ethernet-сети. Тем самым между сервером и его жесткими дисками может находиться не традиционный 68-жильный кабель WideSCSI, а сетевые карты, ethernet-коммутаторы, провода Cat5, СКС, и прочие привычные скорее для «сетевиков» вещи. В наше время, когда в области передачи данных все явственнее происходит конвергенция «все в Ethernet-провод», когда даже будущее такого консервативного протокола как FibreChannel его основным локомотивом, компанией Bocade, видится, по ее заявлениям, в виде <strong>FCoE – FibreChannel-over-Ethernet</strong>, ничего удивительного, что iSCSI нашел себе сегодня широчайшее применение. </p>
<p><strong>TOE – TCP Offload Engine</strong><br />
iSCSI, как протокол в целом, состоит, по сути, из двух независимых частей. Также отдельно они, как правило, и реализуются в оборудовании. Одна часть – «SCSI», и все относящееся к этому протоколу. Вторая – «i» - TCP/IP и все касающееся его.<br />
Как известно, iSCSI может быть реализован полностью программно, и, в ряде случаев это совсем неплохой выбор, недорогой и исключительно гибкий. При этом задачи поддержки протокола осуществляет специальная программа – <strong>iSCSI Initiator</strong>, которые сейчас существуют во всех распространенных операционных системах. Эта программа создает в системе «виртуальный SCSI-адаптер», с которым могут обычным образом взаимодействовать прикладные программы. В дальнейшем она производит на центральном процессоре системы собственно задачи инкапсуляции SCSI-пакетов в IP-пакеты и отправку их драйверу сетевого интерфейса Ethernet, как обычное приложение или драйвер.</p>
<p>Такая модель дает нам беспрецедентную гибкость реализации, однако, очевидно, создает дополнительную нагрузку на центральный процессор, которую, при скоростях вплоть до Gigabit Ethernet еще можно обычно игнорировать, но на скоростях 10Gigabit Ethernet это уже становится сложно. Поэтому для 10GigE-систем как правило применяются те или иные «аппаратные» реализации.</p>
<p>«Аппаратизация» iSCSI может быть осуществлена раздельно по рассмотренным выше частям. Мы можем сделать сетевую карту, которая будет самостоятельно производить всю TCP/IP-шную рутину, такую как расчет контрольных сумм и сборка фрагментов, такое устройство называется <strong>TCP Offload Engine – TOE</strong>. При этом «SCSI-адаптер» в системе у нас остается виртуальным. </p>
<p>Либо сделать полную реализацию обоих частей протокола, то есть аппаратный SCSI-адаптер, на выходе которого будет не WideSCSI-разъем, а сетевой интерфейс, медный или оптический. Реализация же самого протокола для системы и ее приложений, как и ранее, будет для приложения и операционной системы полностью скрыта.</p>
<p>Как правило адаптеры 10Gbit Ethernet имеют в себе либо TCP Offload Engine, сохраняя программную реализацию SCSI, на CPU системы, в драйвере. Либо полную аппаратную реализацию. Такие адаптеры принято называть, как и в FibreChannel-системах – <strong>HBA – Host Bus Adapter</strong>.</p>
<p><strong>iWARP</strong><br />
<strong>iWARP </strong>это <strong>Internet Wide Area RDMA Protocol </strong>– протокол работы RDMA по IP-сетям, основанный на концепциях Virtual Inerface Architecture, и, в определенном смысле, может рассматриваться как некий «Infiniband-over-IP».</p>
<p>С того момента, когда возросшие скорости Ethernet-сетей стали явной проблемой для чисто программной реализации TCP/IP, разработчики задумались над методами разгрузки процессоров, и одним из них стал TOE – TCP Offload Engine – аппаратная реализация TCP/IP на микросхеме контроллера ethernet-адаптера. Такое решение значительно разгружает центральный процессор от задач поддержки передачи данных, которая теперь, в значительной мере, может осуществляться самим контроллером сети. Особенно это стало важно при увеличении скорости и переходе к 10Gbit Ethernet, работа над такими объемами может серьезно нагрузить и довольно мощный современный процессор. А ведь у него есть и другие задачи, кроме как считать контрольные суммы IP-пакетов. </p>
<p>Чаще всего с помощью iWARP передаются такие «вышележащие» протоколы, как <strong>SCSI RDMA Protocol </strong>(SRP), <strong>iSCSI Extensions for RDMA</strong> (iSER), <strong>Sockets Direct Protocol</strong> (SDP) и <strong>NFS-over-RDMA</strong>.<br />
Как видите, интерес Network Appliance к данной технологии понятен и объясним.</p>
<p><strong>iSER – iSCSI Extensions for RDMA</strong> - это расширение протокола iSCSI, позволяющее ему работать по сетям, предоставляющим RDMA-сервис, например по Infiniband или iWARP. Он позволяет передавать данные непосредственно из и в буфер данных SCSI, минуя многочисленные промежуточные копирования данные из одного буфера в другой при традиционной обработке и передаче данных.<br />
Целью создания <strong>iSER </strong>была попытка избежать проблемы фрагментации TCP при работе «классического» iSCSI, который, как вы помните, унаследовал от TCP/IP сетей, кроме массы полезного, и неприятную проблему фрагментации, которая, на больших скоростях передачи, характерных для 10Gbit Ethernet может приводить к заметному ухудшению latency. Суть проблемы заключается в том, что, при передаче, согласно природе TCP, пакеты могут приходить получателю в произвольном порядке, и дело получателя расставить их в нужном порядке, прежде чем передавать на обработку. Однако, пока получателю не придет пакет «номер два», он не может передать в SCSI буфер уже принятые пакеты номер «один», «три», «четыре» … «десять», которые вынуждены дожидаться прихода заплутавшего по сети «второго».<br />
Вследствие этого возможны плохопредсказуемые задержки, которые были незначительны на небольших скоростях, но уже не могут игнорироваться на высоких.<br />
Для решения этой проблемы <strong>iSER </strong>использует «zero-copy»-возможности RDMA вместо обычного способа инкапсуляции в TCP.<br />
В качестве протокола передачи на транспортном уровне может использоваться, кроме «нативного» <strong><nofollow><a href="http://en.wikipedia.org/wiki/Sockets_Direct_Protocol">SDP </a></nofollow></strong>– Socket Direct Protocol, и специально разработанный для потоковых передач протокол <strong><nofollow><a href="http://en.wikipedia.org/wiki/Stream_Control_Transmission_Protocol">SCTP </a></nofollow></strong>– Stream Control Transmission Protocol (RFC4960), являющийся функционально объединяющим преимущества TCP и UDP для целей передачи «потоковых» данных. </p>
<p>Первоначально этот протокол разрабатывался для целей передачи телефонии через IP, но прекрасно подошел и для других потоковых нужд современной Сети. Поддержка SCTP широко присутствует во множестве распространенных операционных системах, например IBM AIX v5, Cisco IOS v12, FreeBSD v7, Linux 2.4/2.6, HP-UX, Sun Solaris 10.<br />
RDMA и NetApp</p>
<p>Компанию <strong>NetApp </strong>и <strong>RDMA </strong>связывает многое. NetApp является одним из учредителей вышеупомянутого <strong>RDMA Consortium</strong>, и еще в 2002 году начала продавать любопытный продукт для своих систем хранения - <strong>DAFS Database Accelerator</strong>, решение, базирующееся на протоколе <strong>DAFS – Direct Access File System</strong>. Это RDMA-based протокол, ориентированный на работу с высокопроизводительными базами данных.<br />
Однако, несмотря на хорошие бенчмарки, согласно которым доступ к сетевому хранилищу NFSv4 через сетевой интерфейс (использовалась специальная карта Emulex VirtualInterface) превосходил по параметрам доступ к локальным дискам системы, продукт не стал бестселлером, и вскоре незаметно исчез из прайс-листа, по видимому придя на рынок слишком рано.</p>
<p>Но сегодня продукты c RDMA появляются на рынке, используя уже широко и активно распространяющиеся 10Gbit Ethernet-системы. Среди их производителей стоит назвать, например, такие имена, как <strong>Chelsio Communications</strong>, производящий такой интересный продукт, как <strong>Chelsio S310SR</strong> – 10G-адаптер с TCP Offload Engine, аппаратным iSCSI, виртуализацией и RDMA. Причем цена за пару, в так называемом <nofollow><a href="http://chelsio.com/products_10g_adapters.html">Evaluation Kit </a></nofollow>на сайте производителя, показана ниже чем 2000$ за карты с SR optical interface и ниже 1500$ за карты с «медным» CX4.<br />
Существуют и версии в «мезонинном» исполнении, для установки в blade-системы, например в HP Type II Blade Systems или IBM Blade Center H.</p>
<p>Любопытно будет также ознакомиться с тестами и бенчмарками. Они, хотя и «вендорские бенчмарки», относиться к которым надо достаточно осмотрительно, но показывают потенциальные возможности новой технологии.</p>
<p><strong><nofollow><a href="http://www.chelsio.com/assetlibrary/products/NFS_RDMA_IB_iWARP.pdf">Experiences with NFS over IB and iWARP RDMA</a></nofollow></strong><br />
<em>OpenFabric Workshop, Sonoma, CA<br />
May 1, 2007</em></p>
<p><strong><nofollow><a href="http://www.chelsio.com/assetlibrary/products/Cluster_Symposium_2005_Presenta.pdf">InfiniBand and 10-Gigabit Ethernet for I/O in Cluster Computing</a></nofollow></strong><br />
<em>July 26-28 Cluster Symposium 2005</em></p>
<p><strong><nofollow><a href="http://www.chelsio.com/assetlibrary/products/HotInterconnect_2005.pdf">Performance Characterization of a 10-Gigabit Ethernet TOE</a></nofollow></strong></p>
<p><strong><nofollow><a href="http://www.chelsio.com/assetlibrary/products/Cluster_2005_Techical_Report_OS.pdf">Head-to-TOE Evaluation of High-Performance Sockets over Protocol Ofﬂoad Engines</a></nofollow></strong></p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="10g.html" rel="tag">10G</a>, <a href="iscsi/index.html" rel="tag">iscsi</a>, <a href="netapp/index.html" rel="tag">netapp</a>, <a href="rdma.html" rel="tag">rdma</a>, <a href="technology.html" rel="tag">technology</a>, <a href="techtalk/index.html" rel="tag">techtalk</a><br />					Раздел: <a href="../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../155/trackback.html#comments" title="Комментарий к записи «Передний край» – iWARP">Комментарии (8)</a>									 </div>
			</div>
	
		
		<div class="navigation">
			<div class="alignleft"></div>
			<div class="alignright"></div>
		</div>
		
	
	</div>
	<div id="sidebar">
		<ul>
			
			
			<!-- Author information is disabled per default. Uncomment and fill in your details if you want to use it.
			<li><h2>Автор</h2>
			<p>A little something about you, the author. Nothing lengthy, just an overview.</p>
			</li>
			-->

			<li class="pagenav"><h2>Страницы</h2><ul><li class="page_item page-item-153"><a href="../../about/trackback.html" title="about">about</a></li>
<li class="page_item page-item-215"><a href="../../distributory-v-rossii/trackback.html" title="Дистрибуторы в России">Дистрибуторы в России</a></li>
<li class="page_item page-item-1327"><a href="../../disti-ua/trackback.html" title="Дистрибуторы в Украине">Дистрибуторы в Украине</a></li>
</ul></li>
			<li><h2>Рубрики</h2>
				<ul>
					<li class="cat-item cat-item-89"><a href="../category/commands/index.html" title="Просмотреть все записи в рубрике &laquo;commands&raquo;">commands</a>
</li>
	<li class="cat-item cat-item-37"><a href="../category/howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;">howto</a>
</li>
	<li class="cat-item cat-item-52"><a href="../category/justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;">justread</a>
</li>
	<li class="cat-item cat-item-51"><a href="../category/review/index.html" title="Просмотреть все записи в рубрике &laquo;review&raquo;">review</a>
</li>
	<li class="cat-item cat-item-3"><a href="../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;">techtalk</a>
</li>
	<li class="cat-item cat-item-71"><a href="../category/tricks/index.html" title="Просмотреть все записи в рубрике &laquo;tricks&raquo;">tricks</a>
</li>
	<li class="cat-item cat-item-95"><a href="../category/utilities/index.html" title="Просмотреть все записи в рубрике &laquo;utilities&raquo;">utilities</a>
</li>
	<li class="cat-item cat-item-44"><a href="../category/whoisho/index.html" title="Просмотреть все записи в рубрике &laquo;whoisho&raquo;">whoisho</a>
</li>
	<li class="cat-item cat-item-1"><a href="../category/news/index.html" title="Просмотреть все записи в рубрике &laquo;новости&raquo;">новости</a>
</li>
	<li class="cat-item cat-item-387"><a href="../category/opros.html" title="Просмотреть все записи в рубрике &laquo;опрос&raquo;">опрос</a>
</li>
	<li class="cat-item cat-item-8"><a href="../category/translations/index.html" title="Просмотреть все записи в рубрике &laquo;переводы&raquo;">переводы</a>
</li>
	<li class="cat-item cat-item-40"><a href="../category/citaty/index.html" title="Просмотреть все записи в рубрике &laquo;цитаты&raquo;">цитаты</a>
</li>
				</ul>
			</li>

			<li><h2>Архивы</h2>
				<ul>
					<li><a href='../date/2018/01.html' title='Январь 2018'>Январь 2018</a></li>
	<li><a href='../date/2015/10.html' title='Октябрь 2015'>Октябрь 2015</a></li>
	<li><a href='../date/2015/04.html' title='Апрель 2015'>Апрель 2015</a></li>
	<li><a href='../date/2015/03.html' title='Март 2015'>Март 2015</a></li>
	<li><a href='../date/2015/01.html' title='Январь 2015'>Январь 2015</a></li>
	<li><a href='../date/2014/12.html' title='Декабрь 2014'>Декабрь 2014</a></li>
	<li><a href='../date/2014/11.html' title='Ноябрь 2014'>Ноябрь 2014</a></li>
	<li><a href='../date/2014/10.html' title='Октябрь 2014'>Октябрь 2014</a></li>
	<li><a href='../date/2014/09.html' title='Сентябрь 2014'>Сентябрь 2014</a></li>
	<li><a href='../date/2014/08.html' title='Август 2014'>Август 2014</a></li>
	<li><a href='../date/2014/07.html' title='Июль 2014'>Июль 2014</a></li>
	<li><a href='../date/2014/06.html' title='Июнь 2014'>Июнь 2014</a></li>
	<li><a href='../date/2014/05.html' title='Май 2014'>Май 2014</a></li>
	<li><a href='../date/2014/04.html' title='Апрель 2014'>Апрель 2014</a></li>
	<li><a href='../date/2014/03.html' title='Март 2014'>Март 2014</a></li>
	<li><a href='../date/2014/02.html' title='Февраль 2014'>Февраль 2014</a></li>
	<li><a href='../date/2014/01.html' title='Январь 2014'>Январь 2014</a></li>
	<li><a href='../date/2013/12.html' title='Декабрь 2013'>Декабрь 2013</a></li>
	<li><a href='../date/2013/11.html' title='Ноябрь 2013'>Ноябрь 2013</a></li>
	<li><a href='../date/2013/10.html' title='Октябрь 2013'>Октябрь 2013</a></li>
	<li><a href='../date/2013/09.html' title='Сентябрь 2013'>Сентябрь 2013</a></li>
	<li><a href='../date/2013/08.html' title='Август 2013'>Август 2013</a></li>
	<li><a href='../date/2013/07.html' title='Июль 2013'>Июль 2013</a></li>
	<li><a href='../date/2013/06.html' title='Июнь 2013'>Июнь 2013</a></li>
	<li><a href='../date/2013/05.html' title='Май 2013'>Май 2013</a></li>
	<li><a href='../date/2013/04.html' title='Апрель 2013'>Апрель 2013</a></li>
	<li><a href='../date/2013/03.html' title='Март 2013'>Март 2013</a></li>
	<li><a href='../date/2013/02.html' title='Февраль 2013'>Февраль 2013</a></li>
	<li><a href='../date/2013/01.html' title='Январь 2013'>Январь 2013</a></li>
	<li><a href='../date/2012/12.html' title='Декабрь 2012'>Декабрь 2012</a></li>
	<li><a href='../date/2012/11.html' title='Ноябрь 2012'>Ноябрь 2012</a></li>
	<li><a href='../date/2012/10.html' title='Октябрь 2012'>Октябрь 2012</a></li>
	<li><a href='../date/2012/09.html' title='Сентябрь 2012'>Сентябрь 2012</a></li>
	<li><a href='../date/2012/08.html' title='Август 2012'>Август 2012</a></li>
	<li><a href='../date/2012/07.html' title='Июль 2012'>Июль 2012</a></li>
	<li><a href='../date/2012/06.html' title='Июнь 2012'>Июнь 2012</a></li>
	<li><a href='../date/2012/05.html' title='Май 2012'>Май 2012</a></li>
	<li><a href='../date/2012/04.html' title='Апрель 2012'>Апрель 2012</a></li>
	<li><a href='../date/2012/03.html' title='Март 2012'>Март 2012</a></li>
	<li><a href='../date/2012/02.html' title='Февраль 2012'>Февраль 2012</a></li>
	<li><a href='../date/2012/01.html' title='Январь 2012'>Январь 2012</a></li>
	<li><a href='../date/2011/12.html' title='Декабрь 2011'>Декабрь 2011</a></li>
	<li><a href='../date/2011/11.html' title='Ноябрь 2011'>Ноябрь 2011</a></li>
	<li><a href='../date/2011/10/index.html' title='Октябрь 2011'>Октябрь 2011</a></li>
	<li><a href='../date/2011/09/index.html' title='Сентябрь 2011'>Сентябрь 2011</a></li>
	<li><a href='../date/2011/08.html' title='Август 2011'>Август 2011</a></li>
	<li><a href='../date/2011/07/index.html' title='Июль 2011'>Июль 2011</a></li>
	<li><a href='../date/2011/06/index.html' title='Июнь 2011'>Июнь 2011</a></li>
	<li><a href='../date/2011/05/index.html' title='Май 2011'>Май 2011</a></li>
	<li><a href='../date/2011/04/index.html' title='Апрель 2011'>Апрель 2011</a></li>
	<li><a href='../date/2011/03/index.html' title='Март 2011'>Март 2011</a></li>
	<li><a href='../date/2011/02.html' title='Февраль 2011'>Февраль 2011</a></li>
	<li><a href='../date/2011/01.html' title='Январь 2011'>Январь 2011</a></li>
	<li><a href='../date/2010/12.html' title='Декабрь 2010'>Декабрь 2010</a></li>
	<li><a href='../date/2010/11/index.html' title='Ноябрь 2010'>Ноябрь 2010</a></li>
	<li><a href='../date/2010/10/index.html' title='Октябрь 2010'>Октябрь 2010</a></li>
	<li><a href='../date/2010/09/index.html' title='Сентябрь 2010'>Сентябрь 2010</a></li>
	<li><a href='../date/2010/08.html' title='Август 2010'>Август 2010</a></li>
	<li><a href='../date/2010/07/index.html' title='Июль 2010'>Июль 2010</a></li>
	<li><a href='../date/2010/06.html' title='Июнь 2010'>Июнь 2010</a></li>
	<li><a href='../date/2010/05.html' title='Май 2010'>Май 2010</a></li>
	<li><a href='../date/2010/04/index.html' title='Апрель 2010'>Апрель 2010</a></li>
	<li><a href='../date/2010/03/index.html' title='Март 2010'>Март 2010</a></li>
	<li><a href='../date/2010/02.html' title='Февраль 2010'>Февраль 2010</a></li>
	<li><a href='../date/2010/01.html' title='Январь 2010'>Январь 2010</a></li>
	<li><a href='../date/2009/12/index.html' title='Декабрь 2009'>Декабрь 2009</a></li>
	<li><a href='../date/2009/11/index.html' title='Ноябрь 2009'>Ноябрь 2009</a></li>
	<li><a href='../date/2009/10.html' title='Октябрь 2009'>Октябрь 2009</a></li>
	<li><a href='../date/2009/09.html' title='Сентябрь 2009'>Сентябрь 2009</a></li>
	<li><a href='../date/2009/08/index.html' title='Август 2009'>Август 2009</a></li>
	<li><a href='../date/2009/07/index.html' title='Июль 2009'>Июль 2009</a></li>
	<li><a href='../date/2009/06.html' title='Июнь 2009'>Июнь 2009</a></li>
	<li><a href='../date/2009/05.html' title='Май 2009'>Май 2009</a></li>
	<li><a href='../date/2009/04.html' title='Апрель 2009'>Апрель 2009</a></li>
	<li><a href='../date/2009/03.html' title='Март 2009'>Март 2009</a></li>
	<li><a href='../date/2009/02.html' title='Февраль 2009'>Февраль 2009</a></li>
	<li><a href='../date/2009/01.html' title='Январь 2009'>Январь 2009</a></li>
	<li><a href='../date/2008/12.html' title='Декабрь 2008'>Декабрь 2008</a></li>
	<li><a href='../date/2008/11.html' title='Ноябрь 2008'>Ноябрь 2008</a></li>
	<li><a href='../date/2008/10.html' title='Октябрь 2008'>Октябрь 2008</a></li>
	<li><a href='../date/2008/09.html' title='Сентябрь 2008'>Сентябрь 2008</a></li>
	<li><a href='../date/2008/08.html' title='Август 2008'>Август 2008</a></li>
	<li><a href='../date/2008/03.html' title='Март 2008'>Март 2008</a></li>
	<li><a href='../date/2008/02.html' title='Февраль 2008'>Февраль 2008</a></li>
	<li><a href='../date/2007/12.html' title='Декабрь 2007'>Декабрь 2007</a></li>
	<li><a href='../date/2007/11.html' title='Ноябрь 2007'>Ноябрь 2007</a></li>
	<li><a href='../date/2007/10.html' title='Октябрь 2007'>Октябрь 2007</a></li>
	<li><a href='../date/2007/09.html' title='Сентябрь 2007'>Сентябрь 2007</a></li>
	<li><a href='../date/2007/08.html' title='Август 2007'>Август 2007</a></li>
	<li><a href='../date/2007/07/index.html' title='Июль 2007'>Июль 2007</a></li>
	<li><a href='../date/2007/06.html' title='Июнь 2007'>Июнь 2007</a></li>
	<li><a href='../date/2007/05.html' title='Май 2007'>Май 2007</a></li>
				</ul>
			</li>

			
					</ul>
	</div>

</div> <!-- wrapper -->
<div id="footer">
	<a href="../../feed">Entries (RSS)</a> and <a href="../../comments/feed">Comments (RSS)</a>. Valid <a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional"><abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a> and <a href="http://jigsaw.w3.org/css-validator/check/referer"><abbr title="Cascading Style Sheets">CSS</abbr></a>.<br />
	Powered by <a href="http://wordpress.org/" title="Powered by WordPress.">WordPress</a> and <a href="http://srinig.com/wordpress/themes/fluid-blue/">Fluid Blue theme</a>.<br />
	<!-- 15 queries. 0.111 seconds. -->
	</div>
</div> <!-- page -->
</body>
</html>
