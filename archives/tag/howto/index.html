<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="ru-RU">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>about NetApp   &raquo; howto</title>

<link rel="stylesheet" href="../../../wp-content/themes/fluid-blue/style.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../wp-content/themes/fluid-blue/print.css" type="text/css" media="print" />
<link rel="alternate" type="application/rss+xml" title="about NetApp RSS Feed" href="../../../feed" />
<link rel="pingback" href="../../../xmlrpc.php.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 2.6" />

</head>

<body>
<div id="page">
<div id="header">
	<div id="headertitle">
		<h1><a href="../../../index.html" title="about NetApp: Системы хранения данных как предмет разговора">about NetApp</a></h1>
		<p>Системы хранения данных как предмет разговора</p>
	</div> 
	<!-- Search box (If you prefer having search form as a sidebar widget, remove this block) -->
	<div class="search">
		<form method="get" id="searchform" action="../../../index.html">
<input type="text" size="20" name="s" id="s" value="Поиск..."  onblur="if(this.value=='') this.value='Поиск...';" onfocus="if(this.value=='Поиск...') this.value='';"/>
</form>
	</div> 
	<!-- Search ends here-->
		
</div>

<div id="navbar">
<ul id="nav">
	<li><a href="../../../index.html">Home</a></li>
	<li class="page_item page-item-153"><a href="../../../about/trackback.html" title="about">about</a></li>
<li class="page_item page-item-215"><a href="../../../distributory-v-rossii/trackback.html" title="Дистрибуторы в России">Дистрибуторы в России</a></li>
<li class="page_item page-item-1327"><a href="../../../disti-ua/trackback.html" title="Дистрибуторы в Украине">Дистрибуторы в Украине</a></li>
</ul>
</div>
<div id="wrapper">

	<div id="content">

	
			<p>Posts tagged &#8216;howto&#8217;</p>

	 		
		<div class="navigation">
			<div class="alignleft"><a href="page/2.html">&laquo; Previous Entries</a></div>
			<div class="alignright"></div>
		</div>

						
			<div class="post" id="post-1232">
				<h2 class="posttitle"><a href="../../1232/trackback.html" rel="bookmark" title="Permanent Link to Data ONTAP Simulator 8.1.1 в VirtualBox">Data ONTAP Simulator 8.1.1 в VirtualBox</a></h2>
				<div class="postmetadata">12 Ноябрь 2012, 10:38 <!-- от  --></div>
				<div class="postentry">
					<p>О том что такое симулятор Data ONTAP я не буду повторяться в пятый, кажется, раз, отсылая к <a href="../simulator.html">более ранним постам на эту тему</a>. Сегодня – о возможности поставить Simulator под гипервизором, отличным от рекомендуемой NetApp VMware. Ну, допустим, у вас Linux, Solaris, или еще что-то, и поставить VMware Player вы не можете. ??ли просто больше любите VirtualBox. Если для симуляторов версии 7 все было просто, там, фактически, это была задача под обычным Linux, то теперь, для симуляторов v8, это стало чуть сложнее, так как он идет уже готовой VM с FreeBSD внутри.</p>
<p>Описание того, как настроить VM в VirtualBox для запуска в нем Simulator 8.1.1 было недавно опубликовано в Community NetApp.</p>
<ol>
<li>Установите VirtualBox обычным образом.     <br />&#160; </li>
<li>Скачайте и распакуйте Симулятор 8.1.1 <br />&#160; </li>
<li>Создайте новую VM с типом OS – “BSD”, версией “FreeBSD (64bit)”. Выделите памяти 1600MB, не выбирайте создание виртуальных дисков, они у нас уже есть и мы подключим их позже в готовую VM. <br />&#160; </li>
<li>Откройте настройки VM (Settings), и на странице System, на табе Processor установите количество CPU – 2.<br />&#160;  </li>
<li>В настройках Storage удалите CDROM с IDE-контроллера. Затем добавьте 4 виртуальных жестких диска, для каждого диска выберите уже существующий vmdk симулятора, по порядку: “DataONTAP.vmdk”, “DataONTAP-var.vmdk”, “DataONTAP-nvram.vmdk” и “DataONTAP-sim.vmdk”. Добавьте контроллер floppy drive с одним пустым floppy. Получившиеся настройки должны выглядеть так: <br />&#160;
<p><img src="https://communities.netapp.com/servlet/JiveServlet/downloadImage/2-94337-17566/450-127/sim-storage.png" /> </p>
<p>&#160;   </li>
<li>На странице <em>Audio</em> уберите отметку в чекбоксе Enable Audio. <br />&#160; </li>
<li>На странице <em>Network</em> добавьте четыре сетевых адаптера (любого нужного вам режима: “host only”, “bridged”, “internal”, “NAT”). В каждом из четырех добавленных NIC откройте секцию Advanced, и выберите в ней тип адаптера “Intel Pro/1000MT Server (82545EM)”. В симуляторе есть драйвер только для этой карты. Выглядит в итоге все так: <br />&#160;
<p><img src="https://communities.netapp.com/servlet/JiveServlet/downloadImage/2-94337-17567/450-330/sim-network.png" /> </p>
<p>&#160;    </li>
<li>В стандартной установке виртуальная машина использует подключенные пайпы Windows для двух последовательных портов: стандартной консоли и дебага. Выможете перенаправить их в обычные последовательные порты, но это не обязательно. <br />&#160; </li>
<li>На странице <em>USB</em> снимите отметку в чекбоксе “Enable USB Controller” <br />&#160; </li>
<li>На странице <em>Shared Folder</em> не устанавливайте shared folder. <br />&#160; </li>
<li>Запишите все изменения в VM. <br />&#160; </li>
<li>Убедитесь, что имеете 1600MB физической свободной памяти для запуска VM, иначе запуск прервется в произвольном месте. <br />&#160; </li>
<li>Запустим VM. <br />&#160; </li>
<li>Во время 10-секундной паузы нажмите любую клавишу КРОМЕ Enter, чтобы прервать нормальную загрузку. <br />&#160; </li>
<li>??змените настройки, запретив запуск установленных в виртуальной машине VMware Tools командой: <em>“setenv bootarg.vm.run_vmtools false”        <br /></em><br />&#160; </li>
<li>Тут же можно изменить и серийный номер симулятора, если вы собираете многосимуляторную конфигурацию, чтобы избежать конфликта при их одновременной работе. <br />&#160; </li>
<li>Введите команду <em>“boot”</em> для нормальной загрузки <br />&#160; </li>
<li>Когда появится сообщение <em>“Press Ctrl-C for menu”</em>, нажмите Ctrl-C и дождитесь появления boot menu. Первая загрузка может занять порой довольно значительное время. <br />&#160; </li>
<li>В появившемся boot menu выберите пункт 4, и подтвердите очистку всех дисков и конфигурации. <br />&#160; </li>
<li>Затем симулятор перезагрузится, эту загрузку уже не нужно прерывать. После окончания загрузки вы увидите стандартную подсказку мастера начальной установки параметров системы, следуйте этой установке и введите все необходимые параметры. Откажитесь от предложения “продолжить в графическом режиме” где-то в середине мастера (в 8.1.1 FilerView уже нет), и дойдите до конца. Если вы сбились, то просто введите setup в качестве команды в консоли, после завершения мастера, и вы сможете повторить настройку с уже введенными данными и изменить какие-то из них. <br />&#160; </li>
</ol>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="index.html" rel="tag">howto</a>, <a href="../netapp/index.html" rel="tag">netapp</a>, <a href="../simulator.html" rel="tag">simulator</a>, <a href="../virtualbox.html" rel="tag">virtualbox</a><br />					Раздел: <a href="../../category/howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;" rel="category tag">howto</a>,  <a href="../../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../1232/trackback.html#comments" title="Комментарий к записи Data ONTAP Simulator 8.1.1 в VirtualBox">Комментарии (5)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1215">
				<h2 class="posttitle"><a href="../../1215/trackback.html" rel="bookmark" title="Permanent Link to Data ONTAP 8.1.x 7-mode Cookbook">Data ONTAP 8.1.x 7-mode Cookbook</a></h2>
				<div class="postmetadata">1 Октябрь 2012, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>В этом блоге я уже как-то <a href="../../718/trackback.html">рассказывал </a>про прекрасный документ, под названием Data ONTAP Cookbook. Словом &#8220;Cookbook&#8221;, или, по русски, &#8220;поваренной книгой&#8221; обычно в IT называют сборники &#8220;рецептов&#8221;, как сделать то-то и то-то. Крайне полезные документы с пошаговыми инструкциями &#8220;как&#8221;: настроить экспорты NFS и поддержку для NFSv4, изменить размеры тома, провести траблшутинг проблем подключения клиента по CIFS, настроить репликацию между системами, включить и настроить компрессию, настроить BMC или RLM, подключить LUN по iSCSI, и так далее.<br />
Раньше подобный Cookbook был выпущен <a href="https://communities.netapp.com/docs/DOC-8121">для Data ONTAP 7.x</a>, и многие им пользовались, как &#8220;настольной книгой админа&#8221;, а вот теперь у нас есть и версия <a href="https://communities.netapp.com/docs/DOC-8121">для Data ONTAP 8.x 7-mode</a>.</p>
<p>Если вы по каким-то этическим причинам не имеете логина на communities.netapp.com, необходимого для скачивания оттуда кукбуков по приведенным выше ссылкам, то можете взять версию на момент публикации отсюда:<br />
<a href="https://www.box.com/s/jdvkjmtqns1i5xuhnaxc">https://www.box.com/s/jdvkjmtqns1i5xuhnaxc</a><br />
<a href="https://www.box.com/s/qzxdsyc0g3fi4znlrf8a">https://www.box.com/s/qzxdsyc0g3fi4znlrf8a</a></p>
<p>Ну и, пользуясь случаем, напоминаю, что NetApp Innovation 2012 в Москве - послезавтра!</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../cookbook.html" rel="tag">cookbook</a>, <a href="index.html" rel="tag">howto</a>, <a href="../netapp/index.html" rel="tag">netapp</a><br />					Раздел: <a href="../../category/howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;" rel="category tag">howto</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../1215/trackback.html#comments" title="Комментарий к записи Data ONTAP 8.1.x 7-mode Cookbook">1 комментарий</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1124">
				<h2 class="posttitle"><a href="../../1124/trackback.html" rel="bookmark" title="Permanent Link to Организация работы с данными в 8.x Cluster-mode">Организация работы с данными в 8.x Cluster-mode</a></h2>
				<div class="postmetadata">27 Февраль 2012, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>??так, в постах о том, как работает Cluster-mode я уже упоминал то, как работает доступ к данным на кластере. А сейчас давайте рассмотрим подробнее процесс создания LUN-а на кластере, для обычного блочного подключения его с хост-сервера Windows.</p>
<p>Несмотря на то, что System Manager 2.0 уже умеет работать с системами в Cluster-mode, мы посмотрим на то, как создаются объекты хранения данных Data ONTAP 8.1 Cluster-mode из консоли. Это нагляднее и проще заскриншотить.</p>
<p>Создадим Vserver. В предыдущем посте я рассказывал что это и зачем нужно в Cluster-mode. А вот как он создается.</p>
<p>Создадим Vserver под названием MyVserver на aggregate с именем aggr1:</p>
<p><img src="https://communities.netapp.com/servlet/JiveServlet/showImage/38-7877-14481/fig1_2012jan27.PNG" /></p>
<p>Допустим, мы хотим обращаться к данным, хранимым на MyVserver по протоколу FCP, для версии 8.1 у нас уже есть возможность работать с данными в Cluster-mode по блочным протоколам. Для этого, включим для Vserver протокол FCP (и проверим его включение):</p>
<p><img src="https://communities.netapp.com/servlet/JiveServlet/showImage/38-7877-14482/fig2_2012jan27.PNG" /></p>
<p>Target Name это физическое имя (nodename) соответствующего контроллера.</p>
<p>Далее нам нужно создать так называемый LIF – Logical Interface, о котором я уже также упоминал в посте ранее. LIF – это логический интерфейс, который динамически мапится на физический интерфейс того или иного узла кластера, на котором работает Vserver, и через который обеспечивается ввод-вывод данных. Создадим и посмотрим на то, что у нас получилось.</p>
<p><img src="https://communities.netapp.com/servlet/JiveServlet/showImage/38-7877-14483/fig3_2012jan27.PNG" /></p>
<p>Network Address/Mask эквивалентен физическому WWPN у порта контроллера.</p>
<p>Создадим igroup – специальную группу, в которую включим нужные нам сервера, чтобы ограничить доступ и видимость LUN-ов только необходимыми серверами. Для этого нам понадобится знать имена WWPN тех портов серверов, которых мы назначим в группу, именно по WWPN и будем определять, наш сервер это или нет.</p>
<p><img src="https://communities.netapp.com/servlet/JiveServlet/showImage/38-7877-14484/fig4_2012jan27.PNG" /></p>
<p>Создадим группу MyIGroup и включим туда FCP WWPN initiator-ов с соответствующих портов.</p>
<p><img src="https://communities.netapp.com/servlet/JiveServlet/showImage/38-7877-14485/fig5_2012jan27.PNG" /></p>
<p>Наконец, создадим том FlexVol под названием MyVol:</p>
<p><img src="https://communities.netapp.com/servlet/JiveServlet/showImage/38-7877-14486/fig6_2012jan27.PNG" /></p>
<p>Теперь создадим LUN по имени MyLUN на этом томе:</p>
<p><img src="https://communities.netapp.com/servlet/JiveServlet/showImage/38-7877-14489/fig7_2012jan27.PNG" /></p>
<p>Смапим LUN соответствующей igroup</p>
<p><img src="https://communities.netapp.com/servlet/JiveServlet/showImage/38-7877-14487/fig8_2012jan27.PNG" /></p>
<p>А теперь подключаем созданный LUN обычным образом на сервер Windows, с помощью стандартной оснастки Disk Management.</p>
<p><img src="https://communities.netapp.com/servlet/JiveServlet/showImage/38-7877-14488/fig9_2012jan27.PNG" /></p>
<p>Готово. У нас на сервере подключен LUN по FCP, расположенный в кластере контроллеров NetApp под управлением Data ONTAP 8.1 Cluster-mode.</p>
<p>За основу поста взят <a href="https://communities.netapp.com/community/netapp-blogs/pseudo_benchmark/blog/2012/01/28/serving-data-in-cluster-mode">пост</a> из блога специалиста NetApp “Pseudo Benchmark”, из которого я позаимствовал скриншоты.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../81.html" rel="tag">8.1</a>, <a href="../cluster-mode/index.html" rel="tag">cluster-mode</a>, <a href="index.html" rel="tag">howto</a>, <a href="../netapp/index.html" rel="tag">netapp</a>, <a href="../vserver.html" rel="tag">vserver</a><br />					Раздел: <a href="../../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../1124/trackback.html#comments" title="Комментарий к записи Организация работы с данными в 8.x Cluster-mode">Комментарии (2)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1099">
				<h2 class="posttitle"><a href="../../1099/trackback.html" rel="bookmark" title="Permanent Link to Настраиваем Data Ontap Simulator 8">Настраиваем Data Ontap Simulator 8</a></h2>
				<div class="postmetadata">12 Декабрь 2011, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>В предыдущей статье я показал, как поставить виртуальную машину, в виде которой сейчас идет симулятор 8.0.1 на сервер VMware ESX. А сейчас попробуем начать с ним работу.</p>
<p>Как я уже рассказывал в предыдущем посте, <a href="../../40/trackback.html">Data Ontap Simulator</a> это виртуальная машина, в которой работает версия Data ONTAP 8 для выполнения в среде VM. Data ONTAP 8 базируется на OS FreeBSD, однако, вопреки распространенному (ошибочному) мнению, <a href="../../12/trackback.html">Data ONTAP 8 это НЕ FreeBSD</a>. Это даже не программа под FreeBSD. Это самостоятельная OS, которая использует FreeBSD как загрузчик своего kernel space code, а также использует некоторые ее ресурсы, например driver model, и драйвера оборудования. Ситуация была примерно та же, что с гипервизором VMware ESX-не-i, если вы помните, там сперва грузился RedHat, под которым затем запускался как модуль собственно ESX, который уже Linux не являлся. ??менно этим объясняется то, что мы в прошлой статье создали VM типа “FreeBSD 64-bit”, действительно, сперва VM загружается с использованием loader FreeBSD, а затем использует ее драйверную модель для внешних устройств.</p>
<p>Симулятор, как я уже рассказывал выше, это полноценная версия Data ONTAP, за некоторым исключением: установлено ограничение по поддерживаемой емкости, не работает протокол FC (но работает iSCSI) и, в настоящий момент, реализована только одноконтроллерная конфигурация. Но для экспериментов и обучения этого будет вполне достаточно.</p>
<p>Давайте, для начала, отключим на симуляторе <a href="http://habrahabr.ru/company/netapp/blog/111916/">Autosupport</a>. Симулятор это экспериментальная площадка, и лучше будет не беспокоить поддержку NetApp странными сообщениями, которые будет при наших экспериментах посылать”в центр” служба Autosupport. Войдя в консоль даем команду:</p>
<p><code>options autosupport.enable off</code></p>
<p>Штатным образом Simulator приходит с набором из 28 “как-бы дисков” размером 1GB (как я уже сказал, для экспериментов этого объема достаточно). ??значально, только 3 диска назначены (assigned) контроллеру, и на них создан root volume на RAID-DP. Остальные диски помечены как unassigned. Назначим оставшиеся диски нашему симулятору:</p>
<p><code>disk assign all</code></p>
<p>Теперь добавим ключи-лицензии. Эти ключи предназначены только для симулятора, и не будут работать на физической системе. Можно установить только то, что используется на вашей продакшн-системе, или поставить дополнительные лицензии, чтобы посмотреть “что это и как работает”, или же просто все, и экспериментировать со всеми возможными фичами.</p>
<ul>
<li>a_sis MTVVGAF </li>
<li>cifs DZDACHD </li>
<li>disk_sanitization PZKEAZL </li>
<li>http NAZOMKC </li>
<li>flex_clone ANLEAZL </li>
<li>iscsi BSLRLTG </li>
<li>multistore NQBYFJJ </li>
<li>nearstore_option ELNRLTG </li>
<li>nfs BQOEAZL </li>
<li>smdomino RKBAFSN </li>
<li>smsql HNGEAZL </li>
<li>snapmanagerexchange BCJEAZL </li>
<li>snapmirror DFVXFJJ </li>
<li>snapmirror_sync XJQIVFK </li>
<li>snaprestore DNDCBQH </li>
<li>snapvalidator JQAACHD </li>
<li>sv_linux_pri ZYICXLC </li>
<li>sv_ontap_pri PVOIVFK </li>
<li>sv_ontap_sec PDXMQMI </li>
<li>sv_unix_pri RQAYBFE </li>
<li>sv_windows_ofm_pri ZOFNMID </li>
<li>sv_windows_pri ZOPRKAM </li>
<li>syncmirror_local RIQTKCL </li>
</ul>
<p>Лицензионный ключ – это 7 заглавных букв после имени функции. Для того, чтобы ввести лицензионный ключ дайте команду:</p>
<p><code>license add XXXXXXX</code></p>
<p>Допустим, мы решили оставить 3 уже назначенных диска в отдельном root aggregate (так рекомендуется по ряду причин), однако если ваша реальная система мала, то вам, возможно, не захочется терять эти 3 диска и их IOPS-ы, тогда возможен вариант с единым общим aggregate, не выделенным под root volume, а общим с пользовательстими данными. Тогда вам нужно будет создать из имеющихся дисков новый aggregate, перенести root volume на него, затем удалить старый том и aggregate, и освободившиеся 3 диска добавить к созданному вами “большому” aggregate. Как это сделать я уже <a href="../../922/trackback.html">писал в блоге ранее</a>.</p>
<p>Если же мы собираемся оставить 3 диска root vol в отдельном aggregate, то просто создавайте новый aggregate на оставшихся 25 дисках. Однако тут имеет смысле сделать небольшие изменения в опциях системы. Дело в том, что размер RAID-группы по умолчанию в Data ONTAP равен 16 дискам (а максимальный для дисков FC, SAS и виртуальных дисков симулятора – 28). Если вы создаете большой единый aggregate на всех 25 дисках, то, при установленном размере RAID-группы равной 16, он создастся так:</p>
<p>Сперва будет взято 16 дисков, из которых 2 будут RAID-DP parity и dparity, а остальные 14 будут data в RAID-группе rg0. Затем на оставшихся будет создана вторая RAID-группа (rg1), из оставшихся 9 дисков, которые, в свою очередь, станут двумя parity и 7 data. В дальнейшем, если в aggregate добавляются новые диски они добавляются в “неполную” RAID-группу, пока она не достигнет заданного в опциях размера в 16 дисков, а следующие создадут еще одну новую “неполную” группу.</p>
<p>Логично было бы, особенно на небольшом числе дисков, не полагаться на такую автоматику, а самостоятельно расчитать и создать RAID-группы, по возможности равного размера. То есть, с точки зрения порядка, аккуратности (да и производительности) вариант 12+12+1 hot spare будет лучше, чем 16+8+1hs. А в нашем случае мы поступим еще лучше, мы просто увеличим заданный размер RAID-группы до максимума (28), или, хотя бы до 25. Тогда все наши диски поместятся в одну группу. Дадим в консоли команду:</p>
<p><code>aggr options aggr1 raidsize 28</code></p>
<p>Теперь добавим оставшиеся unassigned диски в созданный aggr0</p>
<p><code>aggr add aggr1 24</code></p>
<p>Мы оставим один диск под spare, это требование Data ONTAP. Для того, чтобы в логах не валились сообщения о нехватке spares, проверьте значение опции:</p>
<p><code>options raid.min_spare_count 1</code></p>
<p>Здесь 1 – количество spare для данного контроллера. Одного будет вполне достаточно, а при количестве дисков более 16 поставить 0 система не даст.</p>
<p>??меет смысл также уменьшить резерв под snapshots уровня aggregate. Что это я уже тоже писал в блоге, есл вкратце и в двух словах – это вам не надо, это для Metrocluster, синхронной репликации, и может помочь для ремонта сильно поврежденной WAFL. Если у вас этого всег нет, то можете этот резерв убрать и выключить расписание создания их. </p>
<p><code>snap reserve -A aggr1 0      <br />snap sched -A aggr1 0</code></p>
<p>Отдельно отмечу, это ТОЛЬКО для специальных, внутренних снэпшотов уровня aggregate, на обычные и привычные пользовательские снэпшоты уровня volume и файлов это не влияет, они буду работать по-прежнему, и вы по-прежнему сможете их использовать.</p>
<p>Вот теперь все готово к созданию томов и экспериментам. Можете начать из консоли, или же подключить к симулятору System Manager, если вам в GUI привычнее. Симулятор, повторюсь, работает и ведет себя идентично реальной системе хранения (за вычетом FC, SnapLock и ограничения по объему хранения). К нему можно подключить любой софтовый продукт (System/Operations/Protection/Provision Manager, SnapManager, VSC), настроить на него репликацию, использовать его как получатель (secondary) или источник (primary) для SnapVault, и так далее.</p>
<p>В основу этого поста легла статья <a href="http://mtellin.com/2011/01/03/getting-started-with-the-netapp-ontap-8-0-1-simulator/">http://mtellin.com/2011/01/03/getting-started-with-the-netapp-ontap-8-0-1-simulator/</a>.</p>
<p>В следующей статье я покажу, как можно добавить диски симулятору, сверх предустановленных 28, а также добавить serial console или изменить предустановленный серийный номер и SystemID, если вы планируете использовать несколько разных симуляторов в одной сети.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../801.html" rel="tag">8.0.1</a>, <a href="index.html" rel="tag">howto</a>, <a href="../netapp/index.html" rel="tag">netapp</a>, <a href="../simulator.html" rel="tag">simulator</a><br />					Раздел: <a href="../../category/howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;" rel="category tag">howto</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../1099/trackback.html#comments" title="Комментарий к записи Настраиваем Data Ontap Simulator 8">Комментарии (3)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1084">
				<h2 class="posttitle"><a href="../../1084/trackback.html" rel="bookmark" title="Permanent Link to Как передать диск в системе от одного контроллера другому">Как передать диск в системе от одного контроллера другому</a></h2>
				<div class="postmetadata">3 Ноябрь 2011, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>Как вы знаете, каждый контроллер в HA-паре системы хранения NetApp владеет собственным набором дисков. Когда-то, много лет назад, еще до систем серии 3000, использовался так называемый hardware ownership, при котором привязка к контроллеру происходила “физически”, на уровне полки и петли FCAL. Начиная с 3020 в системах NetApp применяется так называмый sowtware ownership, при котором владелец диска назначается согласно WWN этого диска, и появилась возможность более гибко назначать владельца и разделять диски между контроллерами. Например, можно даже имея одну дисковую полку произвольно назначить диски из нее разным контроллерам.</p>
<p>??ногда же возникает задача перераспределить диски, например передать часть дисков от одного контроллера-владельца другому.</p>
<p>Как это сделать показывает статья в Knowledge Base</p>
<p><em>KB ID: 1011998 Version: 3.0 Published date: 01/13/2011 </em></p>
<p><strong>Описание</strong></p>
<p>Приведенная процедура смены контроллера-владельца диска применима к любой системе, поддерживающей software-based ownership (на сегодняшний день все выпускаемые системы используют software-based ownership).</p>
<p><strong>Процедура</strong></p>
<p>В разбираемом примере, FilerA владеет spare-диском, который мы хотим передать контроллеру FilerB.</p>
<p>1. Получим Disk ID   </p>
<p><code>FilerA&gt; vol status -s    <br />
Spare disks    <br />
RAID Disk Device HA SHELF BAY CHAN Pool Type RPM Used (MB/blks) Phys (MB/blks)    <br />
&#8212;&#8212;&#8212; &#8212;&#8212; &#8212;&#8212;&#8212;&#8212;- &#8212;- &#8212;- &#8212;- &#8212;&#8211; &#8212;&#8212;&#8212;&#8212;&#8211; &#8212;&#8212;&#8212;&#8212;&#8211;    <br />
Spare disks for block or zoned checksum traditional volumes or aggregates    <br />
spare 0b.22 0b 1 6 FC:B - FCAL 10000 68000/139264000 69536/142410400</code></p>
<p>2. Перейдем в режим повышенных привилегий (advanced mode)   </p>
<p><code>FilerA*&gt; priv set advanced    <br />
Warning: These advanced commands are potentially dangerous; use them only when directed to do so by NetApp personnel.</code></p>
<p>3. Удалим текущего владельца диска   </p>
<p><code>FilerA*&gt; disk remove_ownership 0b.22    <br />
Volumes must be taken offline. Are all impacted volumes offline(y/n)?? yes    <br />
FilerA*&gt; Sat Jan 14 17:46:42 GMT [FilerA: raid.config.spare.disk.missing:info]: Spare Disk 0b.22 Shelf 1 Bay 6 [NETAPP X272_HJURE073F10 NA14] S/N [xxxxxx] is missing.</code></p>
<p><strong>Внимание:</strong></p>
<ul>
<li>Команду <code>disk remove_ownership</code> можно дать сразу на группу дисков, разделив их имена пробелами, <code>disk remove_ownership 6c.64 6c.65 6c.66</code> снимет владельца со всех перечисленных дисков.</li>
<li>В случае систем серии 30&#215;0, проверьте установку опции <code>options disk.auto_assign</code>. Если она установлена в <strong>on</strong>, то когда вы снимете владельца с дисков, система автоматически назначит их назад. По этой причине убедитесь, что перед началом операции эта опция установлена в <strong>off</strong>. Можно ее включить назад, после передачи диска контроллеру.</li>
<li>Сообщение <code>volumes must be taken offline</code> это предохранительная мера, вы должны подтвердить, что не удаляете диск с данными из активного тома/aggregate. В данном примере мы перемещаем spare-диск, а не диск, уже назначенный в RAID. </li>
</ul>
<p>4. Подключаемся к контроллеру FilerB и переходим в advanced mode   </p>
<p><code>FilerB*&gt; priv set advanced    <br />
Warning: These advanced commands are potentially dangerous; use    <br />
them only when directed to do so by NetApp    <br />
personnel.</code></p>
<p>5. Назначаем нового владельца   </p>
<p><code>FilerB*&gt; disk assign 0b.22    <br />
Sat Jan 14 17:47:32 GMT [FilerB: diskown.changingOwner:info]: changing ownership for disk 0b.22 (S/N xxxxxx) from unowned (ID -1) to FilerB (ID xxxxxx)</code></p>
<p>6. Проверяем, что диск теперь spare у нового контроллера   </p>
<p><code>FilerB*&gt; vol status -s    <br />
Spare disks    <br />
RAID Disk Device HA SHELF BAY CHAN Pool Type RPM Used (MB/blks) Phys (MB/blks)    <br />
&#8212;&#8212;&#8212; &#8212;&#8212; &#8212;&#8212;&#8212;&#8212;- &#8212;- &#8212;- &#8212;- &#8212;&#8211; &#8212;&#8212;&#8212;&#8212;&#8211; &#8212;&#8212;&#8212;&#8212;&#8211;    <br />
Spare disks for block or zoned checksum traditional volumes or aggregates    <br />
spare 0b.22 0b 1 8 FC:B - FCAL 10000 68000/139264000 69536/142410400</code></p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../disk-ownership.html" rel="tag">disk ownership</a>, <a href="index.html" rel="tag">howto</a>, <a href="../netapp/index.html" rel="tag">netapp</a><br />					Раздел: <a href="../../category/howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;" rel="category tag">howto</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../1084/trackback.html#comments" title="Комментарий к записи Как передать диск в системе от одного контроллера другому">Комментарии (7)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-920">
				<h2 class="posttitle"><a href="../../920/trackback.html" rel="bookmark" title="Permanent Link to Network boot">Network boot</a></h2>
				<div class="postmetadata">13 Июнь 2011, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>Как вы, возможно, слышали, загрузить систему хранения NetApp можно по сети, сравнительно традиционным для UNIX-систем способом загрузки OS (ядра и rootfs) через TFTP. Это может помочь, например, если из за неисправности имеющегося ядра, которое располагается в системах NetApp на внутренней CF-карточке.</p>
<p>Для того, чтобы загрузиться с TFTP необходимо при загрузке прервать обычное выполнение процедуры загрузки нажав при включении системы Ctrl-C (или в случае повреждения собственного загрузочного ядра OS система окажется там сама), оставшись в “биосе”. В качестве “биоса” в системах хранения NetApp используется специальный загрузчик, под названием LOADER (в более ранних системах, например FAS270 или FAS3020/3050 использовался немного другой метод – CFE – Common Firmware Environment).</p>
<p>Как для LOADER, так и для CFE для загрузки системы хранения с помошью netboot вам нужно скачать с сайта NetApp netboot-версию OS Data ONTAP нужной вам версии и типа платформы (для современных систем это всегда версия с индексом платформы Q, для FAS3020/3050 индекс платформы будет E, для старых, MIPS-based систем, например FAS270 – M). </p>
<p>Netboot-версия Data ONTAP 7.3.5.1 (наиболее свежей 7.х на момент написания этого поста) имеет размер 27,4MB (7351_netboot.q), версия Data ONTAP 8.0.1 – 144,6MB (801_netboot_q.tgz) и представляют собой kernel и rootfs завернутые в tar.gz, загружающиеся традиционным образом в память.</p>
<p>Далее вам следует установить и настроить в сети, доступной системе хранения, сервер TFTP, и положить туда скачанный образ.</p>
<p>В подсказке LOADER необходимо настроить сетевой интерфейс и запустить сетевую загрузку.</p>
<p><code>LOADER&gt; ifconfig e0a -addr=192.168.1.10 -mask=255.255.255.0 -gw=192.168.1.1     <br />e0a: Link speed: 1000BaseT FDX       <br />Device e0a:&#160; hwaddr 00-A0-98-03-48-AB, ipaddr 192.168.1.10, mask 255.255.255.0       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; gateway 192.168.1.1, nameserver not set</code></p>
<p>Доступные опции для команды ifconfig можно посмотреть введя в подсказке LOADER команду <code>help ifconfig</code></p>
<p>Проверяем работу сети пингуя default gateway:</p>
<p><code>LOADER&gt; ping 192.168.1.1      <br />192.168.1.1 (192.168.1.1) is alive       <br />192.168.1.1 (192.168.1.1): 1 packets sent, 1 received</code></p>
<p>Запускаем команду netboot</p>
<p><code>LOADER&gt; netboot tftp://192.168.1.11/tftproot/netapp_7.2.3_x86_64      <br />Loading:. . . . . . . . . . . </code></p>
<p>Далее Data ONTAP загружается обычным образом. Если /etc , хранящийся на root volume, при этом доступен, то система запустится штатным образом, восстановив все рабочие настройки, если же система повреждена значительно, и, например /etc также&#160; недоступен, то можно попробовать загрузиться без /etc (выбрав соответствующую опцию в boot menu) инициализировать диски, создать новый aggregate, и запустить установку OS “начисто”.</p>
<p>Обратите внимание, что для netboot доступны только встроенные ethernet-порты, не те, что возможно у вас на системе установлены на карте расширения, которая в момент начальной загрузки еще недоступна. </p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="index.html" rel="tag">howto</a>, <a href="../netapp/index.html" rel="tag">netapp</a>, <a href="../netboot.html" rel="tag">netboot</a>, <a href="../tricks/index.html" rel="tag">tricks</a><br />					Раздел: <a href="../../category/howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;" rel="category tag">howto</a>,  <a href="../../category/tricks/index.html" title="Просмотреть все записи в рубрике &laquo;tricks&raquo;" rel="category tag">tricks</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../920/trackback.html#comments" title="Комментарий к записи Network boot">Комментарии (2)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-709">
				<h2 class="posttitle"><a href="../../709/trackback.html" rel="bookmark" title="Permanent Link to Распределение дисков по RAID groups в aggregate">Распределение дисков по RAID groups в aggregate</a></h2>
				<div class="postmetadata">27 Сентябрь 2010, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>Несколько слов о такой теме, которая, как я заметил, часто вызывает замешательство и непонимание.</p>
<p>Для начала кратко о том, что такое aggregate и как они соотносятся с RAID-группами <em>(например для тех, кто тут впервые, пришел из поисковика, и еще не разглядел, что тут порядка двух сотен постов, в которых о многом написано не по разу)</em>.</p>
<p>Aggregate это “уровень виртуализации” для физических дисков в системах хранения NetApp, это своеобразный виртуальный мета-том, на котором можно размещать уже непосредственно адресуемые пользователем тома, сетевые шары для NAS или LUN для SAN. ??спользование такого уровня виртуализации, например, позволяет равномерно распределять операции ввода-вывода по всем нижележащим дискам, увеличивая общую произвдительность, а также с легкостью увеличивать и уменьшать в объемах лежашие поверх него ресурсы – тем самые тома, LUN, сетевые шары, и так далее. Aggregate это одна из самых полезных и эффктивных “фич” систем хранения NetApp.</p>
<p>Однако вопросы возникают вокруг темы создания, и дальнейшего увеличения самого aggregate, путем добавления в его структуру физических дисков. Как это делать правильно, и почему часто это проделывается неправильно – об этом сегодня и пойдет речь.</p>
<p>В физической иерархии aggregate находится на уровне, на котором в традиционных системах хранения находится volume. Ниже него лежат непосредственно физические диски, на которых организованы RAID-группы. Каждый aggregate может занимать одну или, обычно, несколько сконкатенированных RAID-групп, причем размер этих групп в количестве дисков может быть разным. NetApp рекомендует, если нет каких-то особых причин, создавать минимально возможное количество максимально “длинных” aggregate. Это повышает производительность ввода-вывода всех лежащих на них томов и LUN.</p>
<p>Для OS Data ONTAP семейства G7 (версий 7.х.x) максимальный размер aggregate был равен 16TB.    <br />В версиях семейства G8 (8.x.x), для нового формата, под названием 64-bit aggregate, его размер варьируется в зависимости от мощности контроллера, и достигает 100TB для систем FAS6080, самых мощных на сегодня.</p>
<p>Подходить к созданию aggregate следует очень вдумчиво и аккуратно, так как то, что aggregate это фундамент в основе всех вышележащих структур, накладывает на его создание большую ответственность. Просчеты при создании aggregate будут влиять на все использующие его структуры выше. Кроме того, добавленные в aggregate диски нельзя из него извлечь не уничтожая весь aggregate вместе со всеми вышележащими структурами – LUN-ами, томами и сетевыми шарами, вместе со всем их содержимым.</p>
<p>Для того, чтобы создать aggregate, надо отдать команду в командной строке админской консоли, или запустить мастер в FilerView web-GUI. ?? там и там от нас потребуется задать величину RAID-групп.</p>
<p>Какой же должна быть величина этих RAID-групп в количестве дисков?    <br />На сегодня, максимальный размер RAID-групп для дисков FC и SAS равен 28 дискам (то есть, например, для RAID-DP это 26 дисков данных и 2 диска parity), а для дисков SATA – 16 дисков (в версии 8.0.1 будет увеличена до 20).     <br />Однако “рекомендованные величины”, выбранные “по умолчанию”, несколько меньше, это 16 и 14 дисков соответственно. (Все для типа RAID – RAID-DP).</p>
<p>“Если не знаете что делать – не делайте ничего” гласит по легенде главное правило в учебнике по пилотированию самолетов. Последуем ему и мы. Если вы не знаете, какие параметры при создании aggregate нужно выбрать, например размер RAID-групп – рекомендую вам оставить параметры по умолчанию.</p>
<p>Однако какие параметры стоит рассмотреть в том случае, если мы хотим разобраться и создать максимально оптимизированную структуру RAID?</p>
<p>Прежде всего, рекомендуется создавать RAID-группы, на которых лежит aggregate, по возможности равного размера. Причины этому понятны. Сильный дисбаланс в размерах может ограничить производительность aggregate производительностью самой маленькой RAID-группы.</p>
<p>То есть&#160; между вариантами распределения 26 дисков в виде: 22 диска (RAID-DP 20+2) и 4 (RAID-DP 2+2) или же 13 и 13 (RAID-DP 11+2), следует предпочесть второе, несмотря на то, что в первом случае одна из групп будет значительно крупнее, второй вариант будет иметь в целом гораздо более стабильное быстродйствие в IOPS.</p>
<p>Создавать группы равного размера в принципе дело несложное в том случае, если количество дисков, которыми мы располагаем, заранее определено. Но что делать, если нам понадобится добавить дисков в aggregate, причем количество добавляемых дисков <strong>не</strong> 13, а заметно меньше, то есть создать из добавляемых дисков целую новую RAID-группу и растянуть на нее aggregate у нас не выйдет?</p>
<p>Допустим, у нас есть 6 дисков, на которые мы хотим увеличить наш aggregate, лежащий на двух группах RAID-DP по 13 дисков каждый.</p>
<p>У нас есть два варианта: </p>
<p>Вариант 1. Мы може просто, не особо думая, добавить эти диски командой <code>aggr add &lt;aggrname&gt; 8a.1, 8a.2, 8a.3</code> (и прочие необходимые нам диски), или соответствующим GUI-мастером. Если ранее мы задали, что наш aggregate имеет размер RAID – 13 дисков, то вновь добавленные диски образуют третью RAID-группу rg2 (вдобавок к имещимся rg0 и rg1) размером 6 дисков (RAID-DP 4+2). Если в дальнейшем мы будем добавлять в этот aggregate еще дисков, то диски автоматически станут наращивать эту группу, пока она не достигнет размера 13 дисков, после чего начнется новая группа rg3.     <br />Результат в целом простой, но не совсем для нас желательный. Для системы с высокими требованиями по производительности мы можем столкнуться с ситуацией, когда производительность ввода-вывода системы будет заметно колебаться в зависимости от того, какая порция данных на каком RAID окажется.     <br />Хотя этот эффект часто не слшком ярко выражен, и часто переоценивается, но мы хотели бы его избежать.</p>
<p>Вариант 2. Несколько более хитрый. Как я уже сказал выше, мы не можем вывести уже введенные в aggregate диски. Также мы не можем <em>уменьшить</em> уже установленный в aggregate размер RAID-групп (ведь на дисках уже могут располагаться данные). Однако мы можем <em>увеличивать</em> размер RAID-группы в параметре входящих в нее дисков, вплоть до максимального размера, равного 28 для SAS/FC и 16/20 для SATA. Как вы уже знаете, особенностью использованного у NetApp типа RAID, как RAID-4, так и RAID-DP, является то, что добавление в них новых дисков и увличение RAID производится без необходимости полного перестроения RAID, как это привычно при использовании, например, RAID-5. Новый диск добавляется в RAID-4 или RAID-DP, и сразу же на него можно писать, расширив RAID-группу на размер этого диска.</p>
<p>Начнем с того, что зададим в свойствах aggregate размер его RAID-групп больше, чем было установлено ранее (13), в случае необходимости добавления 6 дисков зададим их величину в 16 дисков.</p>
<p><code>fas1&gt; aggr options aggr1 raidsize 16</code></p>
<p>После выполнения этой команды мы получаем тот же aggregate, только теперь вместо двух заполненных RAID-групп на 13 (11d+2p) дисков, мы имеем две неполных RAID-группы по 13 дисков (11d+2p), с максимальным размером 16 (13d+2p). Слдующей командой мы добавляем 6 наших дисков в aggr1:</p>
<p><code>fas1&gt; aggr add aggr1 8a.1, 8a.2, 8a.3, 8a.4, 8a.5, 8a.6</code></p>
<p>Логика добавления дисков неполные RAID-группы проста. Если в aggregate имеются неполные группы, то сперва системе следует заполнить эти группы до максимального зачения, начиная с самой младшей, затем переходя к следующей. Таким образом диски 1, 2, 3 добавятся RAID-группе rg0, а 4, 5, 6 – группе rg1. При необходимости можно и вручную задать какой диск в какую группу будет добавляться.</p>
<p>В итоге мы добились нужного нам. Мы добавили 6 дисков, расширили aggregate, и избежали создания неравномерно разбитых RAID в этом aggregate. Обратите внимание, что все эти действия по изменению размеров RAID-группы и добавлнию дисков осуществляются “на ходу”, не прерывая работы системы, перестроения RAID не требуется, и емкость добавленных дисков становится немеленно доступна системе.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../aggregates.html" rel="tag">aggregates</a>, <a href="index.html" rel="tag">howto</a>, <a href="../netapp/index.html" rel="tag">netapp</a>, <a href="../tipstricks/index.html" rel="tag">tips&amp;tricks</a><br />					Раздел: <a href="../../category/howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;" rel="category tag">howto</a>,  <a href="../../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>,  <a href="../../category/tricks/index.html" title="Просмотреть все записи в рубрике &laquo;tricks&raquo;" rel="category tag">tricks</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../709/trackback.html#comments" title="Комментарий к записи Распределение дисков по RAID groups в aggregate">Комментарии (5)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-485">
				<h2 class="posttitle"><a href="../../485/trackback.html" rel="bookmark" title="Permanent Link to Тестирование с помощью программы IOmeter">Тестирование с помощью программы IOmeter</a></h2>
				<div class="postmetadata">28 Декабрь 2009, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>Когда я, еще в 2007 году писал <a href="../../37/trackback.html">небольшой обзор программы IOmeter</a>, которой как раз незадолго до этого измерял показатели производительности некоторых моделей систем хранения NetApp, я не предполагал, что эта небольшая заметка станет с той поры &#8220;бестселлером&#8221; блога. Неожиданно для себя я обнаружил, что подробного описания работы с таким популярным средством тестирования и измерения на русском языке просто нет.  Не так давно коллега track написал гораздо более подробное описание настройки и работы с IOmeter, и c его любезного согласия, я публикую этот текст у себя в блоге.</p>
<p><img src="http://www.divshare.com/direct/9812494-1eb.png" border="0" /></p>
<p>Программа <strong>IOmeter</strong> - это популярный тест для тестирования производительности дисковой подсистемы и локальной сети. Тест является &#8220;100% синтетикой&#8221;.<br />
К сожалению, некоторая неочевидность процесса тестирования в нем, устаревший внешний вид, отсутствие полноценного онлайн-хелпа, и документации, а также русскоязычного описания, часто вызывают затруднения при попытках его использовать. Также в интернете практически отсутствует подробное описание методики работы с ним, и описание используемых терминов и фич.<br />
 <a href="../../485/trackback.html#more-485" class="more-link"><small>Continue reading &#8216;Тестирование с помощью программы IOmeter&#8217; &raquo;</small></a></p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../benchmark/index.html" rel="tag">benchmark</a>, <a href="index.html" rel="tag">howto</a>, <a href="../iometer.html" rel="tag">iometer</a><br />					Раздел: <a href="../../category/howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;" rel="category tag">howto</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../485/trackback.html#comments" title="Комментарий к записи Тестирование с помощью программы IOmeter">Комментарии (4)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-445">
				<h2 class="posttitle"><a href="../../445/trackback.html" rel="bookmark" title="Permanent Link to FTPd в NetApp">FTPd в NetApp</a></h2>
				<div class="postmetadata">9 Ноябрь 2009, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>Вы уже знаете, что системы хранения NetApp - мультипротокольны. В зависимости от введенных лицензий они позволяют работать с данными по протоколам CIFS и NFS (как NAS), а также по &quot;блочным&quot; протоколам, таким как FC, FCoE и iSCSI (IP-SAN). Но немногие знают, что кроме перечисленных протоколов, данные с NetApp также могут быть также доступны по протоколам HTTP (WebDAV) и FTP.</p>
<p>По умолчанию работа демона ftpd выключена. Для его включения введите в командной строке консоли контроллера команду:</p>
<p>&gt; options ftpd</p>
<p>Вы увидите список опций, относящихся к ftpd:</p>
<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/pics//image18.png" width="736" height="354" /></p>
</p>
<p>Как вы видите, изначально ftpd остановлен <strong>(ftpd.enable off</strong>),вы можете включить его командой <strong>options ftpd.enable on</strong>. </p>
<p>Далее вы можете установить параметр <strong>ftpd.dir.override</strong> на директорию, которую вы хотите отдавать по FTP (<strong>options ftpd.dir.override /vol/vol1/my-home/my-shared-directory/</strong>). Теперь можно попробовать войти с помощью ftp-клиента и скорее всего вы увидите что-то типа <em>530 Login incorrect - User has no home directory.</em>, если директория, указанная в <strong>ftpd.dir.override</strong> это не корень тома. Это может означать, что пользователь, которым вы входите, не имеет так называемых traversal rights для директории, отдаваемой по FTP, поэтому вам нужно исправить это, либо если вы используете Data ONTAP 7.3.0 или старше, то в можете включить опцию <strong>ftpd.bypass_traverse_checking</strong> (<strong>options ftpd.bypass_traverse_checking on</strong>).</p>
<p>В заключение хочу напомнить, что протокол ftp это довольно простой и даже примитивный, в особенности с точки зрения безопасности данных, протокол. Все логины и пароли, а также содержимое файлов данных пересылается &quot;открытым текстом&quot;, а реализованные в более современных и совершенных серверах ftp методы безопасного подключения и передачи данных в имеющемся в Data ONTAP ftpd не используются. Кроме того, надо понимать, что протокол ftp, как и сервер ftpd в системах NetApp никогда не планировался для напряженной и интенсивной работы, и, наверняка, не тестировался как следует ни на безопасность, ни на стабильность работы, играя сугубо вспомогательную роль, поэтому организовывать на нем &quot;рапидшару&quot;, открытую во внешний интернет, наверное все же не стоит.</p>
<p>??сточник: <a href="http://www.m4r3k.org/english/netapp/ftp-services-on-netapp/">http://www.m4r3k.org/english/netapp/ftp-services-on-netapp/ </a></p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="index.html" rel="tag">howto</a>, <a href="../netapp/index.html" rel="tag">netapp</a>, <a href="../tipstricks/index.html" rel="tag">tips&amp;tricks</a><br />					Раздел: <a href="../../category/howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;" rel="category tag">howto</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../445/trackback.html#respond" title="Комментарий к записи FTPd в NetApp">Комментарий</a>									 </div>
			</div>
	
						
			<div class="post" id="post-443">
				<h2 class="posttitle"><a href="../../443/trackback.html" rel="bookmark" title="Permanent Link to Как избежать работы с LUN через &ldquo;чужой&rdquo; контроллер кластера.">Как избежать работы с LUN через &ldquo;чужой&rdquo; контроллер кластера.</a></h2>
				<div class="postmetadata">2 Ноябрь 2009, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>Одной из ошибок настройки при работе кластерной системы NetApp FAS является проблема подключения к LUN через “неродной” для этого LUN-а контроллер.</p>
<p>Кластер контроллеров FAS работает таким образом, что каждый LUN имеет некий preferred path для доступа, будучи “привязанным” к какому-то из контроллеров кластерной пары.</p>
<p>Однако доступ к данным возможен и при работе через вторую ноду кластера, LUN “виден” с обоих нодов кластера, вне зависимости от того, какому из контроллеров он выдан. Это необходимо, в том числе, для обеспечения отказоустойчивости. Однако, доступ через “чужой” для LUN узел, это“нештатный” способ подключения, так как при этом данные пойдут с порта “неродного” контроллера, через кластерный интерконнект, в “родной” котроллер, а из него в LUN, соответственно, обратным путем пойдут данные с LUN.</p>
<p>Этот процесс снижает производительность, нагружает оба контроллера, загружает ненужным трафиком кластерный интерконнект, и ухудшает responce time и latency, поэтому работы через “чужой” узел кластерной пары следует избегать.</p>
<p>Для того, чтобы диагностировать и устранить проблему доступа к LUN через путь на “чужой” контроллер, следует сделать следующее жирным шрифтом выделены команды в консоли (в скобках – соответствующие пункты меню веб-интерфейса FilerView).</p>
<ol>
<li>Определите, к какому из LUN доступ осуществляется через порт FCP target партнерской (“чужой”) ноды.      <br />a.<strong> lun stats -o</strong>&#160; (LUN STATISTICS) </li>
<li>Определите какой из хостов получает доступ к этому LUN через канал партнерской ноды      <br />a.<strong> lun config_check -A</strong>&#160; (LUN CONFIG CHECK)       <br />b.<strong> lun show -v</strong>&#160; (LUN CONFIGURATION)       <br />c.<strong> igroup show -v</strong>&#160; (INITIATOR GROUPS) </li>
<li>Определите порт FCP target основной ноды кластера, который должно использовать для доступа к этому LUN.      <br />a. <strong>fcp show cfmode</strong>&#160; (FCP CFMODE)       <br />b.<strong> fcp show adapters</strong>&#160; (FCP TARGET ADAPTERS) </li>
<li>Проверьте соединение инициатора хоста с основным портом FCP target и конфигурацию MPIO на хосте. </li>
<li>Убедитесь, что доступ по партнерскому пути вместо основного прекращен на обоих узлах кластера.      <br />a.<strong> sysstat -b 1</strong> </li>
</ol>
<p>Убедитесь также, что настройки MPIO правильны, и не влияют на выбор пути доступа. Рекомендуется на каждом из хостов установить соответствующий host utility kit.</p>
<p>Оригинал текста, на основе которого сделан пост взят там:&#160; <br /><a href="http://ibmnseries.blog.com/2009/10/13/partner-path-misconfigured/">http://ibmnseries.blog.com/2009/10/13/partner-path-misconfigured/</a></p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="index.html" rel="tag">howto</a>, <a href="../netapp/index.html" rel="tag">netapp</a>, <a href="../tips.html" rel="tag">tips</a><br />					Раздел: <a href="../../category/howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;" rel="category tag">howto</a>,  <a href="../../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../443/trackback.html#comments" title="Комментарий к записи Как избежать работы с LUN через &ldquo;чужой&rdquo; контроллер кластера.">Комментарии (2)</a>									 </div>
			</div>
	
		
		<div class="navigation">
			<div class="alignleft"><a href="page/2.html">&laquo; Previous Entries</a></div>
			<div class="alignright"></div>
		</div>
		
	
	</div>
	<div id="sidebar">
		<ul>
			
			
			<!-- Author information is disabled per default. Uncomment and fill in your details if you want to use it.
			<li><h2>Автор</h2>
			<p>A little something about you, the author. Nothing lengthy, just an overview.</p>
			</li>
			-->

			<li class="pagenav"><h2>Страницы</h2><ul><li class="page_item page-item-153"><a href="../../../about/trackback.html" title="about">about</a></li>
<li class="page_item page-item-215"><a href="../../../distributory-v-rossii/trackback.html" title="Дистрибуторы в России">Дистрибуторы в России</a></li>
<li class="page_item page-item-1327"><a href="../../../disti-ua/trackback.html" title="Дистрибуторы в Украине">Дистрибуторы в Украине</a></li>
</ul></li>
			<li><h2>Рубрики</h2>
				<ul>
					<li class="cat-item cat-item-89"><a href="../../category/commands/index.html" title="Просмотреть все записи в рубрике &laquo;commands&raquo;">commands</a>
</li>
	<li class="cat-item cat-item-37"><a href="../../category/howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;">howto</a>
</li>
	<li class="cat-item cat-item-52"><a href="../../category/justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;">justread</a>
</li>
	<li class="cat-item cat-item-51"><a href="../../category/review/index.html" title="Просмотреть все записи в рубрике &laquo;review&raquo;">review</a>
</li>
	<li class="cat-item cat-item-3"><a href="../../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;">techtalk</a>
</li>
	<li class="cat-item cat-item-71"><a href="../../category/tricks/index.html" title="Просмотреть все записи в рубрике &laquo;tricks&raquo;">tricks</a>
</li>
	<li class="cat-item cat-item-95"><a href="../../category/utilities/index.html" title="Просмотреть все записи в рубрике &laquo;utilities&raquo;">utilities</a>
</li>
	<li class="cat-item cat-item-44"><a href="../../category/whoisho/index.html" title="Просмотреть все записи в рубрике &laquo;whoisho&raquo;">whoisho</a>
</li>
	<li class="cat-item cat-item-1"><a href="../../category/news/index.html" title="Просмотреть все записи в рубрике &laquo;новости&raquo;">новости</a>
</li>
	<li class="cat-item cat-item-387"><a href="../../category/opros.html" title="Просмотреть все записи в рубрике &laquo;опрос&raquo;">опрос</a>
</li>
	<li class="cat-item cat-item-8"><a href="../../category/translations/index.html" title="Просмотреть все записи в рубрике &laquo;переводы&raquo;">переводы</a>
</li>
	<li class="cat-item cat-item-40"><a href="../../category/citaty/index.html" title="Просмотреть все записи в рубрике &laquo;цитаты&raquo;">цитаты</a>
</li>
				</ul>
			</li>

			<li><h2>Архивы</h2>
				<ul>
					<li><a href='../../date/2018/01.html' title='Январь 2018'>Январь 2018</a></li>
	<li><a href='../../date/2015/10.html' title='Октябрь 2015'>Октябрь 2015</a></li>
	<li><a href='../../date/2015/04.html' title='Апрель 2015'>Апрель 2015</a></li>
	<li><a href='../../date/2015/03.html' title='Март 2015'>Март 2015</a></li>
	<li><a href='../../date/2015/01.html' title='Январь 2015'>Январь 2015</a></li>
	<li><a href='../../date/2014/12.html' title='Декабрь 2014'>Декабрь 2014</a></li>
	<li><a href='../../date/2014/11.html' title='Ноябрь 2014'>Ноябрь 2014</a></li>
	<li><a href='../../date/2014/10.html' title='Октябрь 2014'>Октябрь 2014</a></li>
	<li><a href='../../date/2014/09.html' title='Сентябрь 2014'>Сентябрь 2014</a></li>
	<li><a href='../../date/2014/08.html' title='Август 2014'>Август 2014</a></li>
	<li><a href='../../date/2014/07.html' title='Июль 2014'>Июль 2014</a></li>
	<li><a href='../../date/2014/06.html' title='Июнь 2014'>Июнь 2014</a></li>
	<li><a href='../../date/2014/05.html' title='Май 2014'>Май 2014</a></li>
	<li><a href='../../date/2014/04.html' title='Апрель 2014'>Апрель 2014</a></li>
	<li><a href='../../date/2014/03.html' title='Март 2014'>Март 2014</a></li>
	<li><a href='../../date/2014/02.html' title='Февраль 2014'>Февраль 2014</a></li>
	<li><a href='../../date/2014/01.html' title='Январь 2014'>Январь 2014</a></li>
	<li><a href='../../date/2013/12.html' title='Декабрь 2013'>Декабрь 2013</a></li>
	<li><a href='../../date/2013/11.html' title='Ноябрь 2013'>Ноябрь 2013</a></li>
	<li><a href='../../date/2013/10.html' title='Октябрь 2013'>Октябрь 2013</a></li>
	<li><a href='../../date/2013/09.html' title='Сентябрь 2013'>Сентябрь 2013</a></li>
	<li><a href='../../date/2013/08.html' title='Август 2013'>Август 2013</a></li>
	<li><a href='../../date/2013/07.html' title='Июль 2013'>Июль 2013</a></li>
	<li><a href='../../date/2013/06.html' title='Июнь 2013'>Июнь 2013</a></li>
	<li><a href='../../date/2013/05.html' title='Май 2013'>Май 2013</a></li>
	<li><a href='../../date/2013/04.html' title='Апрель 2013'>Апрель 2013</a></li>
	<li><a href='../../date/2013/03.html' title='Март 2013'>Март 2013</a></li>
	<li><a href='../../date/2013/02.html' title='Февраль 2013'>Февраль 2013</a></li>
	<li><a href='../../date/2013/01.html' title='Январь 2013'>Январь 2013</a></li>
	<li><a href='../../date/2012/12.html' title='Декабрь 2012'>Декабрь 2012</a></li>
	<li><a href='../../date/2012/11.html' title='Ноябрь 2012'>Ноябрь 2012</a></li>
	<li><a href='../../date/2012/10.html' title='Октябрь 2012'>Октябрь 2012</a></li>
	<li><a href='../../date/2012/09.html' title='Сентябрь 2012'>Сентябрь 2012</a></li>
	<li><a href='../../date/2012/08.html' title='Август 2012'>Август 2012</a></li>
	<li><a href='../../date/2012/07.html' title='Июль 2012'>Июль 2012</a></li>
	<li><a href='../../date/2012/06.html' title='Июнь 2012'>Июнь 2012</a></li>
	<li><a href='../../date/2012/05.html' title='Май 2012'>Май 2012</a></li>
	<li><a href='../../date/2012/04.html' title='Апрель 2012'>Апрель 2012</a></li>
	<li><a href='../../date/2012/03.html' title='Март 2012'>Март 2012</a></li>
	<li><a href='../../date/2012/02.html' title='Февраль 2012'>Февраль 2012</a></li>
	<li><a href='../../date/2012/01.html' title='Январь 2012'>Январь 2012</a></li>
	<li><a href='../../date/2011/12.html' title='Декабрь 2011'>Декабрь 2011</a></li>
	<li><a href='../../date/2011/11.html' title='Ноябрь 2011'>Ноябрь 2011</a></li>
	<li><a href='../../date/2011/10/index.html' title='Октябрь 2011'>Октябрь 2011</a></li>
	<li><a href='../../date/2011/09/index.html' title='Сентябрь 2011'>Сентябрь 2011</a></li>
	<li><a href='../../date/2011/08.html' title='Август 2011'>Август 2011</a></li>
	<li><a href='../../date/2011/07/index.html' title='Июль 2011'>Июль 2011</a></li>
	<li><a href='../../date/2011/06/index.html' title='Июнь 2011'>Июнь 2011</a></li>
	<li><a href='../../date/2011/05/index.html' title='Май 2011'>Май 2011</a></li>
	<li><a href='../../date/2011/04/index.html' title='Апрель 2011'>Апрель 2011</a></li>
	<li><a href='../../date/2011/03/index.html' title='Март 2011'>Март 2011</a></li>
	<li><a href='../../date/2011/02.html' title='Февраль 2011'>Февраль 2011</a></li>
	<li><a href='../../date/2011/01.html' title='Январь 2011'>Январь 2011</a></li>
	<li><a href='../../date/2010/12.html' title='Декабрь 2010'>Декабрь 2010</a></li>
	<li><a href='../../date/2010/11/index.html' title='Ноябрь 2010'>Ноябрь 2010</a></li>
	<li><a href='../../date/2010/10/index.html' title='Октябрь 2010'>Октябрь 2010</a></li>
	<li><a href='../../date/2010/09/index.html' title='Сентябрь 2010'>Сентябрь 2010</a></li>
	<li><a href='../../date/2010/08.html' title='Август 2010'>Август 2010</a></li>
	<li><a href='../../date/2010/07/index.html' title='Июль 2010'>Июль 2010</a></li>
	<li><a href='../../date/2010/06.html' title='Июнь 2010'>Июнь 2010</a></li>
	<li><a href='../../date/2010/05.html' title='Май 2010'>Май 2010</a></li>
	<li><a href='../../date/2010/04/index.html' title='Апрель 2010'>Апрель 2010</a></li>
	<li><a href='../../date/2010/03/index.html' title='Март 2010'>Март 2010</a></li>
	<li><a href='../../date/2010/02.html' title='Февраль 2010'>Февраль 2010</a></li>
	<li><a href='../../date/2010/01.html' title='Январь 2010'>Январь 2010</a></li>
	<li><a href='../../date/2009/12/index.html' title='Декабрь 2009'>Декабрь 2009</a></li>
	<li><a href='../../date/2009/11/index.html' title='Ноябрь 2009'>Ноябрь 2009</a></li>
	<li><a href='../../date/2009/10.html' title='Октябрь 2009'>Октябрь 2009</a></li>
	<li><a href='../../date/2009/09.html' title='Сентябрь 2009'>Сентябрь 2009</a></li>
	<li><a href='../../date/2009/08/index.html' title='Август 2009'>Август 2009</a></li>
	<li><a href='../../date/2009/07/index.html' title='Июль 2009'>Июль 2009</a></li>
	<li><a href='../../date/2009/06.html' title='Июнь 2009'>Июнь 2009</a></li>
	<li><a href='../../date/2009/05.html' title='Май 2009'>Май 2009</a></li>
	<li><a href='../../date/2009/04.html' title='Апрель 2009'>Апрель 2009</a></li>
	<li><a href='../../date/2009/03.html' title='Март 2009'>Март 2009</a></li>
	<li><a href='../../date/2009/02.html' title='Февраль 2009'>Февраль 2009</a></li>
	<li><a href='../../date/2009/01.html' title='Январь 2009'>Январь 2009</a></li>
	<li><a href='../../date/2008/12.html' title='Декабрь 2008'>Декабрь 2008</a></li>
	<li><a href='../../date/2008/11.html' title='Ноябрь 2008'>Ноябрь 2008</a></li>
	<li><a href='../../date/2008/10.html' title='Октябрь 2008'>Октябрь 2008</a></li>
	<li><a href='../../date/2008/09.html' title='Сентябрь 2008'>Сентябрь 2008</a></li>
	<li><a href='../../date/2008/08.html' title='Август 2008'>Август 2008</a></li>
	<li><a href='../../date/2008/03.html' title='Март 2008'>Март 2008</a></li>
	<li><a href='../../date/2008/02.html' title='Февраль 2008'>Февраль 2008</a></li>
	<li><a href='../../date/2007/12.html' title='Декабрь 2007'>Декабрь 2007</a></li>
	<li><a href='../../date/2007/11.html' title='Ноябрь 2007'>Ноябрь 2007</a></li>
	<li><a href='../../date/2007/10.html' title='Октябрь 2007'>Октябрь 2007</a></li>
	<li><a href='../../date/2007/09.html' title='Сентябрь 2007'>Сентябрь 2007</a></li>
	<li><a href='../../date/2007/08.html' title='Август 2007'>Август 2007</a></li>
	<li><a href='../../date/2007/07/index.html' title='Июль 2007'>Июль 2007</a></li>
	<li><a href='../../date/2007/06.html' title='Июнь 2007'>Июнь 2007</a></li>
	<li><a href='../../date/2007/05.html' title='Май 2007'>Май 2007</a></li>
				</ul>
			</li>

			
					</ul>
	</div>

</div> <!-- wrapper -->
<div id="footer">
	<a href="../../../feed">Entries (RSS)</a> and <a href="../../../comments/feed">Comments (RSS)</a>. Valid <a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional"><abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a> and <a href="http://jigsaw.w3.org/css-validator/check/referer"><abbr title="Cascading Style Sheets">CSS</abbr></a>.<br />
	Powered by <a href="http://wordpress.org/" title="Powered by WordPress.">WordPress</a> and <a href="http://srinig.com/wordpress/themes/fluid-blue/">Fluid Blue theme</a>.<br />
	<!-- 15 queries. 0.100 seconds. -->
	</div>
</div> <!-- page -->
</body>
</html>
