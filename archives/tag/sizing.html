<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="ru-RU">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>about NetApp   &raquo; sizing</title>

<link rel="stylesheet" href="../../wp-content/themes/fluid-blue/style.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../wp-content/themes/fluid-blue/print.css" type="text/css" media="print" />
<link rel="alternate" type="application/rss+xml" title="about NetApp RSS Feed" href="../../feed" />
<link rel="pingback" href="../../xmlrpc.php.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 2.6" />

</head>

<body>
<div id="page">
<div id="header">
	<div id="headertitle">
		<h1><a href="../../index.html" title="about NetApp: Системы хранения данных как предмет разговора">about NetApp</a></h1>
		<p>Системы хранения данных как предмет разговора</p>
	</div> 
	<!-- Search box (If you prefer having search form as a sidebar widget, remove this block) -->
	<div class="search">
		<form method="get" id="searchform" action="../../index.html">
<input type="text" size="20" name="s" id="s" value="Поиск..."  onblur="if(this.value=='') this.value='Поиск...';" onfocus="if(this.value=='Поиск...') this.value='';"/>
</form>
	</div> 
	<!-- Search ends here-->
		
</div>

<div id="navbar">
<ul id="nav">
	<li><a href="../../index.html">Home</a></li>
	<li class="page_item page-item-153"><a href="../../about/trackback.html" title="about">about</a></li>
<li class="page_item page-item-215"><a href="../../distributory-v-rossii/trackback.html" title="Дистрибуторы в России">Дистрибуторы в России</a></li>
<li class="page_item page-item-1327"><a href="../../disti-ua/trackback.html" title="Дистрибуторы в Украине">Дистрибуторы в Украине</a></li>
</ul>
</div>
<div id="wrapper">

	<div id="content">

	
			<p>Posts tagged &#8216;sizing&#8217;</p>

	 		
		<div class="navigation">
			<div class="alignleft"></div>
			<div class="alignright"></div>
		</div>

						
			<div class="post" id="post-953">
				<h2 class="posttitle"><a href="../953/trackback.html" rel="bookmark" title="Permanent Link to Проблемы производительности при использовании Autotiering и Megacaching">Проблемы производительности при использовании Autotiering и Megacaching</a></h2>
				<div class="postmetadata">20 Июль 2011, 7:00 <!-- от  --></div>
				<div class="postentry">
					<p>Сегодня в переводах – статья одного из моих любимых блогоавторов – уже знакомого вам Димитриса Крековкиаса, работающего в NetApp, и ведущего автономный блог <a href="http://recovermonkey.org">recovermonkey.org</a>. Обратите внимание, что, несмотря на то, что автор и является сотрудником NetApp, текст поста в равной мере относится и к системам NetApp, и его стоит внимательно прочесть также и партнерам NetApp, продающих их (и проводящих сайзинг) своим клиентам.</p>
<p>В этой статье я буду использовать общепринятый в нашей отрасли термин &quot;сайзинг&quot; (sizing). Если вы далеки от нашего отраслевого &quot;птичьего языка&quot;, то поясню, что &quot;сайзинг&quot; - это процедура &quot;количественной оценки&quot; и анализа, которые делаются для системы хранения для того, чтобы убедиться в том, что система хранения данной конфигурации (с таким набором дисков, мощностью контроллера и интерфейсов ввода-вывода, с определенным набором опций) удовлетворяет требованиям клиента, например по емкости, производительности на заданном профиле ввода-вывода, и так далее. Правильно проведенный сайзинг дает определенную гарантию того, что покупаемая система удовлетворит предъявляемым к ней требованиям заказчика. По крайней мере в идеальном случае. Об отличиях от &quot;идеального случая&quot;, и о сложностях при проведении сайзинга, а также о рекомендациях по получению правильно &quot;сайзенной&quot; системы, говорит идущая ниже статья.</p>
<h2><a href="http://recoverymonkey.org/2011/06/29/buyer-beware-is-your-storage-vendor-sizing-properly-for-performance-or-are-they-under-sizing-technologies-like-megacaching-and-autotiering/">Покупатель, будь внимателен: верно ли вендор вашей системы хранения делает сайзинг по производительности, или они полагаются только на свои супер-технологии, типа Megacaching и Autotiering?</a></h2>
<p>Posted on <a href="http://recoverymonkey.org/2011/06/29/buyer-beware-is-your-storage-vendor-sizing-properly-for-performance-or-are-they-under-sizing-technologies-like-megacaching-and-autotiering/">June 29, 2011</a> by <a href="http://recoverymonkey.org/author/admin/">Dimitris</a></p>
<p>С появлением новых технологий, <em>влияющих на производительность</em> (отметьте выбор слов), сайзинг, или количественный анализ проектируемой системы хранения становится не тем, каким он был раньше.</p>
<p>Я написал этот пост, потому что вижу все больше и больше вендоров, которые сегодня НЕ используют научные методы для количественной оценки (сайзинга) производительности и емкости своих решений, вместо этого они стремятся удовлетворить клиента ценой, надеясь, что технологии обеспечат нужную клиенту производительность (а если нет, то не беда, сторадж-то уже продан, квартальный план продаж закрыт, а если производительности системы клиенту не хватает - что-ж, клиент ведь всегда может докупить дисков, памяти, или еще чего, правда?)</p>
<p>Раньше, в &quot;старые добрые времена&quot;, с традиционными системами хранения, вы могли получить (и получали, обычно) хорошо детерминированную, и легко предсказуемую производительность, зная только характер вашей рабочей нагрузки, тип используемого RAID и количество дисков. Вы могли быть уверенными в том, что эта система будет соответствовать вашей нагрузке, если контроллер и шина его не будут перегружены.</p>
<p>С современными системами, полными разнообразных опций, используемыми для того, чтобы выжать еще немного производительности на той же системе, или же, напротив, получить тот же уровень производительности на меньшем, или более дешевом железе, это уже не так.</p>
<p>Новые &quot;умные технологии&quot; делают сайзинг системы хранения более сложным, чем раньше.</p>
<p>Например, набирающая популярность концепция <a href="http://storagewithoutborders.com/2010/08/17/data-storage-for-vdi-part-10-megacaches/">Megacaches</a> может использоваться для <a href="http://www.youtube.com/watch?v=7FJMNG5VdI8">значительного уменьшения объемов ввода-вывода</a>, который добирается до бэкэнда и дисков системы хранения. Например на системах NetApp FAS вы можете использовать до 16TB интеллектуального, сверх-гранулярного (4K) и использующего дедупликацию данных кэша чтения. Это на самом деле гигантский размер, больший, чем обычно может понадобиться подавляющему большинству использующих системы хранения (и даже больший, чем многие системы хранения в целом). Другие вендоры также последовали за NetApp, и предлагают сегодня похожие технологии. ??мея такой объемный кэш, расположенный перед дисками, и перехватывающий на себя значительную часть ввода-вывода, многие вендоры имеют соблазн рекомендовать использовать в таких системах хранения диски SATA, имеющие большую удельную емкость, но, обычно, невысокую производительность, ведь производительность в данном случае планируется обеспечивать с помощью того или иного &quot;мегакэша&quot;.</p>
<p>Но, если в системе хранения с таким &quot;мегакэшем&quot; планируется, для снижения ее стоимости, уменьшение количества дисковых шпинделей, или использование медленных дисков SATA, принципиально важно дополнительно позаботиться о правильно выполненном сайзинге для такого решения.</p>
<p>Как я показал выше, кэш хорошо работает в том случае, если значительная часть данных, которые мы называем &quot;рабочим набором данных&quot; (active working set), помещается в него. Но помните, что &quot;рабочий набор данных&quot; это не все ваши данные, это подмножество ваших данных, к которому обращаются на протяжении какого-то периода времени.</p>
<p>Для пользователя, у которого, допустим, база данных размером 20TB, реальный рабочий набор данных этой базы может составлять всего 5% — то есть этот набор вполне может целиком поместиться в 1TB кэша. Таким образом, кэш размером 1TB может обеспечить большинство потребностей в вводе-выводе базы данных. Диски же в бэкэнде вполне могут при этом быть недорогими SATA, просто чтобы удовлетворить необходимости разместить объем хранения всей базы данных.</p>
<p>Но как быть с тем периодом времени, когда характер ввода-вывода отличается от типового и ожидаемого? Например, это может быть период переиндексации, или объемного экспорта базы, или период конца месяца, или квартала, когда нагрузка на базу часто резко возрастает? Такие операции сильно изменяют объем рабочего набора данных, он может быстро вырасти от 5% до куда более значительных величин. При этом наша рассмотренная выше ситуация, с 1TB кэша и SATA в бэкэнде уже может перестать нас удовлетворять.</p>
<p><strong>Вот почему при сайзинге сегодня надо анализировать различные возможные профили нагрузки, а не просто какой-то один &quot;усредненный&quot; или &quot;наихудший случай&quot;.</strong></p>
<p>Давайте снова возьмем базу данных для примера (просто потому, что для базы данных характер ввода-вывода может резко меняться). Вы легко можете получить вот такие варианты ввода-вывода:</p>
<ol>
<li>Типичное использование – 20 000 IOPS, 100% random, 8K I/O-блок, 80% чтения</li>
<li>Экспорт DB — высокие значения MB/s, в основном sequential write, большой размер I/O-блока, относительно немного IOPS</li>
<li>Последовательное чтение после произвольной записи — например данные добавляются в DB в произвольном порядке, затем делается большое последовательное чтение, или даже несколько чтений параллельно</li>
</ol>
<p>Как вы видите, профиль ввода-вывода не просто меняется, он становится принципиально другой. Если вы берете в расчет только вариант 1, у вас может не оказаться достаточно дисков в бэкэнде для стабильного потока при экспорте DB или параллельного sequential table scans. Если вы считаете только вариант 2, вы сочтете, что вам не нужно много кэша, так как ваш профиль ввода-вывода в основном последовательные (sequential) операции (а в большинстве случаев такие операции не кэшируются). Но ваша оценка будет полностью неверна для операций типичного использования.</p>
<p>Если вендор говорит вам, что проведенный ими сайзинг показал, что их предложение соответствует большинству ваших требований по вводу-выводу, то ваш вопрос должен быть: о каких типах ввода-вывода шла речь?</p>
<p><strong>Другая новая модная технология (и судя по всему - переоцененная) это Autotiering.</strong></p>
<p>Autotiering, если по-простому, позволяет перемещать на системе хранения фрагменты данных, так называемые &quot;чанки&quot; (chunks), в соответствии с активностью доступа к ним. Чанки, содержащие максимально активные данные постепенно перемещаются на SSD, в то время, как остальные, менее активные, могут спокойно оставаться на SATA.</p>
<p>Различные дисковые массивы используют разные методы выполнения Autotiering, обычно реализованных с помощью нижележащих архитектурных возможностей систем хранения, и имеют различные ограничения и характеристики. Например, EMC Symmetrix имеет размер чанка около 7.5MB. На HDS VSP, чанк имеет размер около 40MB. На IBM DS8000, SVC или EMC Clariion/VNX, он равен 1GB.</p>
<p>При использовании Autotiering, как и в случае использования кэширования, чем меньше размер чанка, тем эффективнее получается конечный результат. Например, чанк размером 7.5MB требует всего 3-5% пространства сверхбыстрых дисков как &quot;верхнего tier&quot;, однако в случае чанков размером 1GB потребуется уже 10-15%, просто по причине того, что чанк большего размера содержит в себе не только &quot;горячие&quot; данные, но и &quot;холодные&quot;, перемешанные, на протяжении этого гигабайта, с активными, &quot;горячими&quot; данными.</p>
<p>Так как большинство дисковых массивов записывают данные в &quot;геометрическом&quot; расположении на диске (то есть на определенные, заданные непосредственно хранимыми данными места, напротив, NetApp использует <a href="http://bit.ly/kbUcOP">и &quot;геометрический&quot; и &quot;темпоральный&quot; метод размещения</a>), то с большими чанками это приводит к тому, что &quot;горячие&quot; блоки будут всегда соседствовать с &quot;холодными&quot; в таких протяженных чанках. Это объясняет, почему чем меньше чанк, тем лучше эта ситуация.</p>
<p>Поэтому с большими чанками ситуация выглядит примерно так (красные квадратики - самые горячие блоки данных, оранжевые и зеленые - более &quot;холодные&quot;):</p>
<p><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/pics//image106.png" width="395" height="273" /></p>
<p>Массив будет пытаться закэшировать максимум возможного, и, затем, переместить чанки, в соответствии с тем, насколько активно к ним обращение. Но переместить можно только весь чанк целиком, не просто активную часть этого чанка… и это работает, пока у вас есть достаточно места для их размещения.</p>
<p><strong>??так, что же следует сделать, чтобы получить правильный сайзинг?</strong></p>
<p>Существует несколько моментов, которые следует принять во внимание, для того, чтобы получить точный сайзинг с использованием современных технологий.</p>
<ol>
<li>Предоставьте вендору подробную статистику производительности — чем подробнее она будет, тем лучше. Если мы не будем знать, что происходит на хранилище, то трудно создать по настоящему хорошо спроектированную для вашей задачи систему хранения.</li>
<li>Предоставьте ваши ожидания в области производительности — например &quot;Мне бы хотелось, чтобы запросы в Oracle завершались за 1/4 нынешнего времен их выполнения&quot; — и увяжите ваши ожидания по производительности с бизнес-целями (будет проще их оценивать).</li>
<li><strong>Попросите вендора показать его инструмент сайзинга и описать , каким именно образом делается математическая оценка и получается результат — <em>тут нет и не может быть никакой магии!</em></strong></li>
<li>Спросите вендора, проанализровали ли они все возможные сценарии нагрузок, которые у вас имеются (не просто &quot;для разных приложений&quot; но <em>разные нагрузки для каждого вашего приложения</em>) — и как именно они это сделали.</li>
<li>Попросите его показать вам каков по размеру, по его оценке, ваш &quot;рабочий набор&quot; данных, и какой объем его поместится в кэш.</li>
<li><font style="background-color: #ffff00"></font><font style="style">Попросите его объяснить вам, как ваши данные будут располагаться на Autotiered-системе. Каким образом определяется то, на каком tier-е будут располагаться те или иные фрагменты данных. Как это вычисляется? Какие моменты геометрии хранилища следует принять во внимание?</font></li>
<li>Есть ли достаточно пространства для каждого уровня хранения (tier)? Для архитектуры Autotiering с большими чанками, есть ли у вас объем, равный 10-15% емкости общего стораджа, на SSD?</li>
<li>Учтена ли дополнительная нагрузка на RAM и CPU контроллера во время работы кэширования и autotiering? Такие технологии обязательно нагружают CPU и RAM при работе. Спросите, каков этот оверхед (чем меньше чанк при Autotiering, тем больше оверхед на обработку метаданных, например). Ничто не дается на халяву.</li>
<li>Остерегайтесь сайзинга, сделанного устно или &quot;на салфетке&quot;, на калькуляторе, или даже в простой электронной таблице – Я еще ни разу не видел точную модель расчета производительности системы хранения в виде электронной таблицы.</li>
<li>Остерегайтесь сайзинга, рассчитанного исходя из примитивного &quot;диск 15K дает 180 IOPS&quot;— на практике все куда сложнее!</li>
<li>Разберитесь с разницей между последовательным (sequential) и произвольным (random) доступом к данным, режимом чтения (reads), записи (writes), а также размером оперируемого блока ввода-вывода (I/O size) для каждой оцениваемой архитектуры — в зависимости от платформы различие в способах работы ввода-вывода может сделать сравнение очень трудным для корректного сравнения между собой <a href="http://bit.ly/lJVXDh">при различных требованиях к дисковой подсистеме</a>.</li>
<li>Разберитесь с тем, какую дополнительную нагрузку по вводу-выводу и емкости хранения создают решения Continuous Data Protection и репликации <a href="http://bit.ly/mHFDww">в ряде случаев это может утроить ее</a>.</li>
<li>Какой тип RAID предполагает использовать вендор? Учтено ли огромное дополнительное влияние на производительность у RAID-5 и RAID-6, при <a href="http://nt-ap.com/mgHc8K">большой нагрузке на запись</a> (плюс известный аспект надежности).</li>
<li>Если вы получили предложение за необычно низкую цену, поинтересуйтесь стоимостью дальнейшего апгрейда системы. Принцип &quot;Первый раз - бесплатно&quot; используется очень многими отраслями бизнеса.</li>
<li>??, наконец, совсем немаловажное — <strong>спросите, исходя из какой нагрузки на контроллер системы хранения исходил вендор при сайзинге! </strong>Я с большим удивлением видел попытки продать систему, которая обеспечивала обслуживание рабочей нагрузки клиента с запланированным уровнем загрузки CPU контроллера на уровне 90%. Вы считаете, что такого запаса по производительности вам хватит? Помните – дисковая система хранения это просто компьютер с большим количеством дисков, и со специализированным аппаратным и программным содержимым, и здесь процессор может &quot;затыкаться&quot; точно также, как и в любой другой вычислительной системе.</li>
</ol>
<p>Все это, возможно, кажется трудным, да, откровенно говоря, это так и есть. Но вам все равно придется этим заниматься для вашей компании. Уверен, вы не захотите получить неправильно рассчитанный под ваши реальные задачи сторадж, с которым вам потом придется мучиться следующие 3-5 лет только оттого, что цена, по которой вам его предложили, была так привлекательна…</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="autotiering.html" rel="tag">autotiering</a>, <a href="megacache.html" rel="tag">megacache</a>, <a href="netapp/index.html" rel="tag">netapp</a>, <a href="sizing.html" rel="tag">sizing</a><br />					Раздел: <a href="../category/justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;" rel="category tag">justread</a>,  <a href="../category/translations/index.html" title="Просмотреть все записи в рубрике &laquo;переводы&raquo;" rel="category tag">переводы</a>&nbsp;&nbsp;|&nbsp;
					<a href="../953/trackback.html#comments" title="Комментарий к записи Проблемы производительности при использовании Autotiering и Megacaching">Комментарии (18)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-388">
				<h2 class="posttitle"><a href="../388/trackback.html" rel="bookmark" title="Permanent Link to О &#8220;дешевизне&#8221; SATA-дисков">О &#8220;дешевизне&#8221; SATA-дисков</a></h2>
				<div class="postmetadata">7 Сентябрь 2009, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>Ранее, в посте <a href="../373/trackback.html">про надежность RAID-5</a> я уже писал про такой аспект дисков SATA, как надежность и величину UER (Unrecoverable Error Rate, иногда также называется UBE - Unrecoverable Bit Error).<br />
Величина эта почти на порядок (в 10 раз) хуже, чем для дисков SAS/FC, причем причина тут конструктивная, а не просто в интерфейсе.<br />
Однако, для небольших систем &#8220;начинающих&#8221;, в первую очередь роль играет цена.</p>
<p>Жесткий диск (и система хранения) характеризуется, в общем случае, двумя параметрами: емкостью (измеряется в <strong>Мегабайтах/Гигабайтах (MB/GB)</strong>), и быстродействием (измеряется в <strong>IOPS </strong>- Input-Output Operations per Second - Операций ввода-вывода в секунду ). ?? если емкости дисков непрерывно растут вот уже несколько лет, то показатели по IOPS замерли уже довольно давно.<br />
Принято считать, что диск SATA дает <strong>80-100 IOPS</strong>, диски SAS/FC - <strong>140-160</strong> для 10KRPM, <strong>180-200</strong> - 15KRPM.</p>
<p>Стоимость за мегабайт для дисков SATA весьма низка, на сегодня она составляет<strong> 0,17$/MB</strong> для диска SATA 1TB, однако около <strong>0.83$/MB</strong> для диска SAS 300GB. (я оперирую ценами, взятыми из price.ru: SATA WD RE3 1TB 7200 - <strong>170$</strong>, SAS Hitachi 300GB 15K - <strong>250$</strong>)</p>
<p>??ная картина будет, если мы посчитаем стоимость IOPS-ов. Диск SATA при этом будет стоить <strong>2,1$ за IOPS</strong>, а 15K SAS - <strong>1.38$/IOPS</strong></p>
<p>Допустим, перед нами стоит задача создать сторадж на <strong>3 TB</strong>, при этом быстродействие его должно быть не хуже <strong>3000 IOPS</strong>.</p>
<p>Рассмотрим два варианта:<br />
Если мы рассматриваем только емкость, то будет все просто:<br />
SATA 1TB нужно три штуки, при цене за диск в 170$ общая сумма хранилища заданного размера, без учета RAID будет <strong>510$</strong><br />
Дисков SAS на 15KRPM емкостью 300GB будет нужно 10 штук, при цене за диск 250$ такая емкость будет стоить <strong>2500$</strong></p>
<p>Казалось бы вывод очевиден, SATA дешевле, причем раз в пять.<br />
Но мы пока не учли второе требование, про 3000 IOPS.</p>
<p>Для быстродействия системы емкостью 3TB в 3000 IOPS, из расчета в 80 IOPS с каждого диска SATA, нам нужно распараллелить ввод-вывод не менее чем на 38 дисков. 38 дисков SATA, это будет стоить уже <strong>6460$</strong>.<br />
Однако для дисков SAS те же 3000 IOPS достижимы на всего 17 дисках, что стоит <strong>4250$</strong></p>
<p>??того, для удовлетворения обоих заданных требований, и по емкости, и по быстродействию, система, изначально построенная на более дешевых дисках оказывается почти в полтора раза дороже, и с увеличением требований по быстродействию это разрыв будет только расти.</p>
<p>Этот момент часто не учитывают люди, планирующие использование SATA на задачах primary storage.</p>
<p>Если перед вами стоит задача не просто создать емкость хранения, без учета показателей по быстродействию, что, вообще говоря имеет только одно применение - хранилище архивных и резервных копий, а систему хранения, обеспечивающую приемлемую скорость работы приложения его использующего, то вам следует забыть про гигабайты, и ориентироваться, в первую очередь, на производительность дисков, на IOPS. Необходимый объем вы получите &#8220;автоматичски&#8221;.<br />
Сегодня, во многих случаях, при планировании системы хранения, производительность есть ее &#8220;первичное&#8221;, ключевое свойство .<br />
??ли, иначе говоря: &#8220;GB are free, IOPS cost you money&#8221; - &#8220;Гигабайты бесплатно, вы платите только за <del>доставку</del> ??ОПСы&#8221;</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="iops.html" rel="tag">iops</a>, <a href="sas.html" rel="tag">sas</a>, <a href="sata.html" rel="tag">sata</a>, <a href="sizing.html" rel="tag">sizing</a>, <a href="techtalk/index.html" rel="tag">techtalk</a><br />					Раздел: <a href="../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../388/trackback.html#comments" title="Комментарий к записи О &#8220;дешевизне&#8221; SATA-дисков">Комментарии (10)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-337">
				<h2 class="posttitle"><a href="../337/trackback.html" rel="bookmark" title="Permanent Link to ??спользование STATSPACK для Oracle">??спользование STATSPACK для Oracle</a></h2>
				<div class="postmetadata">22 Июль 2009, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>Сайзинг под базы Oracle есть критически важный параметр для создания системы хранения достаточной производительности. Сбор данных perfstat* и Oracle STATSPACK позволит выбрать правильно сконфигурированную систему хранения NetApp, как в плане размера, так и производительности.</p>
<p>Важно помнить несколько вещей, когда вы собираете статистику системы:</p>
<ul>
<li>Собирайте данные, когда система под большой нагрузкой</li>
<li>Собирайте данные со всех хостов инфраструктуры</li>
<li>Собирайте данные в perfstat и STATSPACK за один период времени</li>
</ul>
<p><strong>Установка Oracle STATSPACK.</strong></p>
<p>STATSPACK это утилита диагностики произвдительности СУБД, которая доступна начиная с  Oracle8i. STATSPACK это дальнейшее развитие утилит BSTAT и ESTAT. Рекомендуется установить timed_statistics в true. Для установки STATSPACK выполните следующие шаги:</p>
<p>1. Создайте PERFSTAT Tablespace:</p>
<p><code>SQL> CREATE TABLESPACE statspack<br />
     DATAFILE &#8216;/path_to_file.dbf&#8217; SIZE 200M REUSE<br />
     EXTENT MANAGEMENT LOCAL UNIFORM SIZE 512K<br />
     SEGMENT SPACE MANAGEMENT AUTO<br />
     PERMANENT<br />
     ONLINE;</code></p>
<p>2. Запустите catdbsyn.sql и dbmspool.sql как SYS из SQLPLUS</p>
<p><code>$ sqlplus "/ as sysdba"</p>
<p>SQL> @?/rdbms/admin/catdbsyn.sql</p>
<p>SQL> @?/rdbms/admin/dbmspool.sql</code></p>
<p>3. Запустите скрипт</p>
<p><code>$ sqlplus "/ as sysdba"</p>
<p>SQL> @?/rdbms/admin/spcreate</code></p>
<p>Можете начинать пользоваться Oracle STATSPACK.</p>
<p><strong>Сбор Oracle Statspack с помощью Perfstat с хоста Unix.</strong></p>
<p><em>Как я могу собирать данные Oracle Statspack и Perfstat одновременно?</em> </p>
<p>Для Perfstat версии 6.28 или позднее мы можем собирать данные Oracle Statspack из Perfstat используя единую команду Perfstat. Это работает для версии perfstat под unix, и не работает для версии perfstat под Windows.</p>
<p>Небольшая выжимка их манов к Perfstat:</p>
<p>Требования:</p>
<p>1. Perfstat может собирать данные Oracle STATSPACK только с одного хоста.<br />
2. ??нстанс Oracle должен быть запущен до того, как будет вызван Perfstat.<br />
3. ??спользуйте флаг <strong>-o</strong> чтобы передать специфические опции statspack в perfstat.</p>
<p>Опции и значения по умолчанию:</p>
<p><code>oracle_host=`hostname`<br />
sqlplus=&#8221;sqlplus&#8221;<br />
oracle_login=&#8221;perfstat/perfstat&#8221;<br />
runas=&#8221;"<br />
sysdba=&#8221;false&#8221;</code></p>
<p><strong><code>-oracle_host </code></strong> - умолчание для localhost, может быть одним из хостов, определенных с помощью -h из команд perfstat</p>
<p><strong><code>-sqlplus</code></strong> - может быть использован для того, чтобы определить абсолтный путь к команде &#8217;sqlplus&#8217;</p>
<p><strong><code>-runas</code></strong> - может использоваться для запуска sqlplus от имени другого пользователя (то есть пользователь Unix, где установлен Oracle, обычно не root.)</p>
<p><strong><code>-sysdba</code></strong> - может использоваться для подключения к oracle как sysdba, игнорируя параметр oracle_login. Ключ sysdba вводит следующие команды в логин к sqlplus:</p>
<ul>
<li>a. sqlplus /nolog </li>
<li>b. connect / as sysdba.</li>
</ul>
<p>Примеры:</p>
<p><code>perfstat.sh -a oracle<br />
perfstat.sh -h host1 -a oracle -o oracle_host=host1<br />
perfstat.sh -h host1 -a oracle -o oracle_host=host1,sqlplus=/oracle/bin/sqlplus/<br />
perfstat.sh -a oracle -o oracle_login=user/pass<br />
perfstat.sh -a oracle -o runas=oracle,sysdba=true</code></p>
<p>Более сложные примеры:</p>
<p><code>perfstat.sh -a oracle -t 5 -i 5 -f filer -o runas=oracle, sysdba=true >/opt/perfstat.out</code></p>
<p>Note: Для того, чтобы собирать статистику самого файлера вместе с данными статистики Oracle, должен быть использован ключ <strong>-f</strong>.</p>
<p>Пример приведенный выше запускает perfstat и statspack 5 раз по 5 минут. Он переключает пользователя в oracle (с помощью команды su - oracle), и входит в sqlplus с помощью:</p>
<ul>
<li>a. sqlplus /nolog </li>
<li>b. connect / as sysdba.</li>
</ul>
<p>Еще почитать:<br />
<a href="http://www.akadia.com/services/ora_statspack_survival_guide.html">http://www.akadia.com/services/ora_statspack_survival_guide.html</a><br />
<a href="https://now.netapp.com/Knowledgebase/solutionarea.asp?id=kb9096">https://now.netapp.com/Knowledgebase/solutionarea.asp?id=kb9096</a><br />
<a href="http://www.dba-oracle.com/art_statspack.htm">http://www.dba-oracle.com/art_statspack.htm</a><br />
<a href="http://www.datadisk.co.uk/html_docs/oracle/awr.htm">http://www.datadisk.co.uk/html_docs/oracle/awr.htm</a></p>
<p>Взято тут:<br />
<a href="http://blogs.netapp.com/databases/2009/07/gathering-oracle-statspack-data-for-netapp.html">http://blogs.netapp.com/databases/2009/07/gathering-oracle-statspack-data-for-netapp.html</a></p>
<p>* perfstat - собственная утилита - shell-script NetApp для сбора статистики, может быть скачана с вебсайта NOW:  <a href="http://now.netapp.com/NOW/download/tools/perfstat/">http://now.netapp.com/NOW/download/tools/perfstat/</a></p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="howto/index.html" rel="tag">howto</a>, <a href="netapp/index.html" rel="tag">netapp</a>, <a href="oracle/index.html" rel="tag">oracle</a>, <a href="performance/index.html" rel="tag">performance</a>, <a href="sizing.html" rel="tag">sizing</a><br />					Раздел: <a href="../category/howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;" rel="category tag">howto</a>&nbsp;&nbsp;|&nbsp;
					<a href="../337/trackback.html#respond" title="Комментарий к записи ??спользование STATSPACK для Oracle">Комментарий</a>									 </div>
			</div>
	
		
		<div class="navigation">
			<div class="alignleft"></div>
			<div class="alignright"></div>
		</div>
		
	
	</div>
	<div id="sidebar">
		<ul>
			
			
			<!-- Author information is disabled per default. Uncomment and fill in your details if you want to use it.
			<li><h2>Автор</h2>
			<p>A little something about you, the author. Nothing lengthy, just an overview.</p>
			</li>
			-->

			<li class="pagenav"><h2>Страницы</h2><ul><li class="page_item page-item-153"><a href="../../about/trackback.html" title="about">about</a></li>
<li class="page_item page-item-215"><a href="../../distributory-v-rossii/trackback.html" title="Дистрибуторы в России">Дистрибуторы в России</a></li>
<li class="page_item page-item-1327"><a href="../../disti-ua/trackback.html" title="Дистрибуторы в Украине">Дистрибуторы в Украине</a></li>
</ul></li>
			<li><h2>Рубрики</h2>
				<ul>
					<li class="cat-item cat-item-89"><a href="../category/commands/index.html" title="Просмотреть все записи в рубрике &laquo;commands&raquo;">commands</a>
</li>
	<li class="cat-item cat-item-37"><a href="../category/howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;">howto</a>
</li>
	<li class="cat-item cat-item-52"><a href="../category/justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;">justread</a>
</li>
	<li class="cat-item cat-item-51"><a href="../category/review/index.html" title="Просмотреть все записи в рубрике &laquo;review&raquo;">review</a>
</li>
	<li class="cat-item cat-item-3"><a href="../category/techtalk/index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;">techtalk</a>
</li>
	<li class="cat-item cat-item-71"><a href="../category/tricks/index.html" title="Просмотреть все записи в рубрике &laquo;tricks&raquo;">tricks</a>
</li>
	<li class="cat-item cat-item-95"><a href="../category/utilities/index.html" title="Просмотреть все записи в рубрике &laquo;utilities&raquo;">utilities</a>
</li>
	<li class="cat-item cat-item-44"><a href="../category/whoisho/index.html" title="Просмотреть все записи в рубрике &laquo;whoisho&raquo;">whoisho</a>
</li>
	<li class="cat-item cat-item-1"><a href="../category/news/index.html" title="Просмотреть все записи в рубрике &laquo;новости&raquo;">новости</a>
</li>
	<li class="cat-item cat-item-387"><a href="../category/opros.html" title="Просмотреть все записи в рубрике &laquo;опрос&raquo;">опрос</a>
</li>
	<li class="cat-item cat-item-8"><a href="../category/translations/index.html" title="Просмотреть все записи в рубрике &laquo;переводы&raquo;">переводы</a>
</li>
	<li class="cat-item cat-item-40"><a href="../category/citaty/index.html" title="Просмотреть все записи в рубрике &laquo;цитаты&raquo;">цитаты</a>
</li>
				</ul>
			</li>

			<li><h2>Архивы</h2>
				<ul>
					<li><a href='../date/2018/01.html' title='Январь 2018'>Январь 2018</a></li>
	<li><a href='../date/2015/10.html' title='Октябрь 2015'>Октябрь 2015</a></li>
	<li><a href='../date/2015/04.html' title='Апрель 2015'>Апрель 2015</a></li>
	<li><a href='../date/2015/03.html' title='Март 2015'>Март 2015</a></li>
	<li><a href='../date/2015/01.html' title='Январь 2015'>Январь 2015</a></li>
	<li><a href='../date/2014/12.html' title='Декабрь 2014'>Декабрь 2014</a></li>
	<li><a href='../date/2014/11.html' title='Ноябрь 2014'>Ноябрь 2014</a></li>
	<li><a href='../date/2014/10.html' title='Октябрь 2014'>Октябрь 2014</a></li>
	<li><a href='../date/2014/09.html' title='Сентябрь 2014'>Сентябрь 2014</a></li>
	<li><a href='../date/2014/08.html' title='Август 2014'>Август 2014</a></li>
	<li><a href='../date/2014/07.html' title='Июль 2014'>Июль 2014</a></li>
	<li><a href='../date/2014/06.html' title='Июнь 2014'>Июнь 2014</a></li>
	<li><a href='../date/2014/05.html' title='Май 2014'>Май 2014</a></li>
	<li><a href='../date/2014/04.html' title='Апрель 2014'>Апрель 2014</a></li>
	<li><a href='../date/2014/03.html' title='Март 2014'>Март 2014</a></li>
	<li><a href='../date/2014/02.html' title='Февраль 2014'>Февраль 2014</a></li>
	<li><a href='../date/2014/01.html' title='Январь 2014'>Январь 2014</a></li>
	<li><a href='../date/2013/12.html' title='Декабрь 2013'>Декабрь 2013</a></li>
	<li><a href='../date/2013/11.html' title='Ноябрь 2013'>Ноябрь 2013</a></li>
	<li><a href='../date/2013/10.html' title='Октябрь 2013'>Октябрь 2013</a></li>
	<li><a href='../date/2013/09.html' title='Сентябрь 2013'>Сентябрь 2013</a></li>
	<li><a href='../date/2013/08.html' title='Август 2013'>Август 2013</a></li>
	<li><a href='../date/2013/07.html' title='Июль 2013'>Июль 2013</a></li>
	<li><a href='../date/2013/06.html' title='Июнь 2013'>Июнь 2013</a></li>
	<li><a href='../date/2013/05.html' title='Май 2013'>Май 2013</a></li>
	<li><a href='../date/2013/04.html' title='Апрель 2013'>Апрель 2013</a></li>
	<li><a href='../date/2013/03.html' title='Март 2013'>Март 2013</a></li>
	<li><a href='../date/2013/02.html' title='Февраль 2013'>Февраль 2013</a></li>
	<li><a href='../date/2013/01.html' title='Январь 2013'>Январь 2013</a></li>
	<li><a href='../date/2012/12.html' title='Декабрь 2012'>Декабрь 2012</a></li>
	<li><a href='../date/2012/11.html' title='Ноябрь 2012'>Ноябрь 2012</a></li>
	<li><a href='../date/2012/10.html' title='Октябрь 2012'>Октябрь 2012</a></li>
	<li><a href='../date/2012/09.html' title='Сентябрь 2012'>Сентябрь 2012</a></li>
	<li><a href='../date/2012/08.html' title='Август 2012'>Август 2012</a></li>
	<li><a href='../date/2012/07.html' title='Июль 2012'>Июль 2012</a></li>
	<li><a href='../date/2012/06.html' title='Июнь 2012'>Июнь 2012</a></li>
	<li><a href='../date/2012/05.html' title='Май 2012'>Май 2012</a></li>
	<li><a href='../date/2012/04.html' title='Апрель 2012'>Апрель 2012</a></li>
	<li><a href='../date/2012/03.html' title='Март 2012'>Март 2012</a></li>
	<li><a href='../date/2012/02.html' title='Февраль 2012'>Февраль 2012</a></li>
	<li><a href='../date/2012/01.html' title='Январь 2012'>Январь 2012</a></li>
	<li><a href='../date/2011/12.html' title='Декабрь 2011'>Декабрь 2011</a></li>
	<li><a href='../date/2011/11.html' title='Ноябрь 2011'>Ноябрь 2011</a></li>
	<li><a href='../date/2011/10/index.html' title='Октябрь 2011'>Октябрь 2011</a></li>
	<li><a href='../date/2011/09/index.html' title='Сентябрь 2011'>Сентябрь 2011</a></li>
	<li><a href='../date/2011/08.html' title='Август 2011'>Август 2011</a></li>
	<li><a href='../date/2011/07/index.html' title='Июль 2011'>Июль 2011</a></li>
	<li><a href='../date/2011/06/index.html' title='Июнь 2011'>Июнь 2011</a></li>
	<li><a href='../date/2011/05/index.html' title='Май 2011'>Май 2011</a></li>
	<li><a href='../date/2011/04/index.html' title='Апрель 2011'>Апрель 2011</a></li>
	<li><a href='../date/2011/03/index.html' title='Март 2011'>Март 2011</a></li>
	<li><a href='../date/2011/02.html' title='Февраль 2011'>Февраль 2011</a></li>
	<li><a href='../date/2011/01.html' title='Январь 2011'>Январь 2011</a></li>
	<li><a href='../date/2010/12.html' title='Декабрь 2010'>Декабрь 2010</a></li>
	<li><a href='../date/2010/11/index.html' title='Ноябрь 2010'>Ноябрь 2010</a></li>
	<li><a href='../date/2010/10/index.html' title='Октябрь 2010'>Октябрь 2010</a></li>
	<li><a href='../date/2010/09/index.html' title='Сентябрь 2010'>Сентябрь 2010</a></li>
	<li><a href='../date/2010/08.html' title='Август 2010'>Август 2010</a></li>
	<li><a href='../date/2010/07/index.html' title='Июль 2010'>Июль 2010</a></li>
	<li><a href='../date/2010/06.html' title='Июнь 2010'>Июнь 2010</a></li>
	<li><a href='../date/2010/05.html' title='Май 2010'>Май 2010</a></li>
	<li><a href='../date/2010/04/index.html' title='Апрель 2010'>Апрель 2010</a></li>
	<li><a href='../date/2010/03/index.html' title='Март 2010'>Март 2010</a></li>
	<li><a href='../date/2010/02.html' title='Февраль 2010'>Февраль 2010</a></li>
	<li><a href='../date/2010/01.html' title='Январь 2010'>Январь 2010</a></li>
	<li><a href='../date/2009/12/index.html' title='Декабрь 2009'>Декабрь 2009</a></li>
	<li><a href='../date/2009/11/index.html' title='Ноябрь 2009'>Ноябрь 2009</a></li>
	<li><a href='../date/2009/10.html' title='Октябрь 2009'>Октябрь 2009</a></li>
	<li><a href='../date/2009/09.html' title='Сентябрь 2009'>Сентябрь 2009</a></li>
	<li><a href='../date/2009/08/index.html' title='Август 2009'>Август 2009</a></li>
	<li><a href='../date/2009/07/index.html' title='Июль 2009'>Июль 2009</a></li>
	<li><a href='../date/2009/06.html' title='Июнь 2009'>Июнь 2009</a></li>
	<li><a href='../date/2009/05.html' title='Май 2009'>Май 2009</a></li>
	<li><a href='../date/2009/04.html' title='Апрель 2009'>Апрель 2009</a></li>
	<li><a href='../date/2009/03.html' title='Март 2009'>Март 2009</a></li>
	<li><a href='../date/2009/02.html' title='Февраль 2009'>Февраль 2009</a></li>
	<li><a href='../date/2009/01.html' title='Январь 2009'>Январь 2009</a></li>
	<li><a href='../date/2008/12.html' title='Декабрь 2008'>Декабрь 2008</a></li>
	<li><a href='../date/2008/11.html' title='Ноябрь 2008'>Ноябрь 2008</a></li>
	<li><a href='../date/2008/10.html' title='Октябрь 2008'>Октябрь 2008</a></li>
	<li><a href='../date/2008/09.html' title='Сентябрь 2008'>Сентябрь 2008</a></li>
	<li><a href='../date/2008/08.html' title='Август 2008'>Август 2008</a></li>
	<li><a href='../date/2008/03.html' title='Март 2008'>Март 2008</a></li>
	<li><a href='../date/2008/02.html' title='Февраль 2008'>Февраль 2008</a></li>
	<li><a href='../date/2007/12.html' title='Декабрь 2007'>Декабрь 2007</a></li>
	<li><a href='../date/2007/11.html' title='Ноябрь 2007'>Ноябрь 2007</a></li>
	<li><a href='../date/2007/10.html' title='Октябрь 2007'>Октябрь 2007</a></li>
	<li><a href='../date/2007/09.html' title='Сентябрь 2007'>Сентябрь 2007</a></li>
	<li><a href='../date/2007/08.html' title='Август 2007'>Август 2007</a></li>
	<li><a href='../date/2007/07/index.html' title='Июль 2007'>Июль 2007</a></li>
	<li><a href='../date/2007/06.html' title='Июнь 2007'>Июнь 2007</a></li>
	<li><a href='../date/2007/05.html' title='Май 2007'>Май 2007</a></li>
				</ul>
			</li>

			
					</ul>
	</div>

</div> <!-- wrapper -->
<div id="footer">
	<a href="../../feed">Entries (RSS)</a> and <a href="../../comments/feed">Comments (RSS)</a>. Valid <a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional"><abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a> and <a href="http://jigsaw.w3.org/css-validator/check/referer"><abbr title="Cascading Style Sheets">CSS</abbr></a>.<br />
	Powered by <a href="http://wordpress.org/" title="Powered by WordPress.">WordPress</a> and <a href="http://srinig.com/wordpress/themes/fluid-blue/">Fluid Blue theme</a>.<br />
	<!-- 15 queries. 0.080 seconds. -->
	</div>
</div> <!-- page -->
</body>
</html>
