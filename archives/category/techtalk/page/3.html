<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="ru-RU">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>about NetApp   &raquo; techtalk</title>

<link rel="stylesheet" href="../../../../wp-content/themes/fluid-blue/style.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../../wp-content/themes/fluid-blue/print.css" type="text/css" media="print" />
<link rel="alternate" type="application/rss+xml" title="about NetApp RSS Feed" href="../../../../feed" />
<link rel="pingback" href="../../../../xmlrpc.php.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../../xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 2.6" />

</head>

<body>
<div id="page">
<div id="header">
	<div id="headertitle">
		<h1><a href="../../../../index.html" title="about NetApp: Системы хранения данных как предмет разговора">about NetApp</a></h1>
		<p>Системы хранения данных как предмет разговора</p>
	</div> 
	<!-- Search box (If you prefer having search form as a sidebar widget, remove this block) -->
	<div class="search">
		<form method="get" id="searchform" action="../../../../index.html">
<input type="text" size="20" name="s" id="s" value="Поиск..."  onblur="if(this.value=='') this.value='Поиск...';" onfocus="if(this.value=='Поиск...') this.value='';"/>
</form>
	</div> 
	<!-- Search ends here-->
		
</div>

<div id="navbar">
<ul id="nav">
	<li><a href="../../../../index.html">Home</a></li>
	<li class="page_item page-item-153"><a href="../../../../about/trackback.html" title="about">about</a></li>
<li class="page_item page-item-215"><a href="../../../../distributory-v-rossii/trackback.html" title="Дистрибуторы в России">Дистрибуторы в России</a></li>
<li class="page_item page-item-1327"><a href="../../../../disti-ua/trackback.html" title="Дистрибуторы в Украине">Дистрибуторы в Украине</a></li>
</ul>
</div>
<div id="wrapper">

	<div id="content">

	
			<p>Archive for the &#8216;techtalk&#8217; Category.</p>

 				
		<div class="navigation">
			<div class="alignleft"><a href="4.html">&laquo; Previous Entries</a></div>
			<div class="alignright"><a href="2.html">Next Entries &raquo;</a></div>
		</div>

						
			<div class="post" id="post-1240">
				<h2 class="posttitle"><a href="../../../1240/trackback.html" rel="bookmark" title="Permanent Link to О кэшировании в SSD для E-Series">О кэшировании в SSD для E-Series</a></h2>
				<div class="postmetadata">24 Январь 2013, 9:00 <!-- от  --></div>
				<div class="postentry">
					<p>Как вы знаете, я мало и редко пишу тут про отдельное семейство продуктов NetApp - так называемые системы хранения E-series (они же знакомы многим из вас как IBM DS3500/3700, и ряд других), это продукты бывшего LSI Engenio, пару лет назад перешедшего &#8220;под крыло&#8221; NetApp. ?? хотя под этим самым крылом развитие их не остановилось, напротив, даже закоренелые скептики вынуждены были признать, что ресурсы NetApp сильно помогли Engenio в разработке новых фич и продвижении продукта, для меня эти системы довольно сторонний продукт, и пишу я о нем тут редко.</p>
<p><img src="https://communities.netapp.com/servlet/JiveServlet/downloadImage/38-9802-18176/299-168/E5400.jpg" alt="E5400" /></p>
<p>Причин этому две. Во-первых ни их самих, ни задач под них у меня нет нигде рядом, во-вторых сами по себе они мне не особенно интересны. </p>
<p>Последнее стоит чуть более развернуто объяснить.<br />
Дело в том, что, если системы линейки FAS, это стораджи &#8220;широкого профиля&#8221; применения, создаваемые для использования под различные задачи, с широким набором разнообразной функциональности, как встроенной, так и дополнительной, то системы E-Series это крайне &#8220;узкопрофильный&#8221; сторадж. Это система хранения, строго говоря, под одну задачу: &#8220;скорость, скорость и ничего кроме скорости&#8221;. Причем &#8220;ничего кроме&#8221; это почти не фигура речи. Как следствие (а вы знаете мою позицию по данному вопросу), это системы хранения довольно ограниченны по своей области применения.<br />
Это &#8220;болиды Формулы 1&#8243;, быстрые в условиях гоночного трека, но не очень полезные в городе или, например, на стройке.</p>
<p>Да, действительно есть задачи, где нужна &#8220;скорость любой ценой&#8221;, но в большинстве случаев <strong>кроме</strong> скорости в реальной, практической жизни нужна еще и надежность, широкий набор поддерживаемых фич, возможности защиты данных, эффективность хранения, масштабируемость, и прочее, и прочее.</p>
<p>Поэтому, по моему мнению (и по мнению NetApp), E-series это нишевое решение, для специализированных применений, таких как хранилища для Big Data под Hadoop, высокопроизводительные grid-системы, <a href="http://www.netapp.com/us/media/wp-7163.pdf">стораджи под Lustre для HPC</a>, промышленных масштабов Video Surveillance, реалтайм аналитика, особо критичные к времени выполнения запросов OLTP-базы, и прочие подобные области применения.</p>
<p>Вот почему я так мало пишу тут о E-Series, и поэтому применяемые там технологии так отличаются от того, что использует NetApp в своих стораджах FAS, и не стремится сливать эти линейки.</p>
<p>Вот и <a href="http://www.netapp.com/us/media/ds-3395.pdf">кэширование в SSD</a> (Performance Read Cache), поверхностно похожее на аналогичную функцию у NetApp FAS, довольно значительно отличается от NetApp Flash Pool (Hybrid Aggregate).</p>
<p>Во-первых, значительным отличием является использование переменного размера блока. Так как E-series это не-WAFL-based системы, они не привязаны к блоку &#8220;файловой системы&#8221; (в случае WAFL это 4 килобайта), и могут варьировать размер оперируемого блока от 2K до 8K. В ряде случаев это может дать эффект при специфических нагрузках ввода-вывода, прежде всего при процессе &#8220;прогрева кэша&#8221;, то есть первоначальном заполнении его данными. ??сследование NetApp утверждает, что правильная настройка размеров блока для Performance Read Cache на E-series может дать до 500% увеличения скорости первоначального наполнения кэша. А как вы понимаете, чем быстрее наполнится этот, довольно объемистый кэш на SSD, тем скорее он даст отдачу по ускорению работы с данными.</p>
<p>Во-вторых, это возможность настройки политики размещения записываемых данных - в кэше, или же сразу на HDD. Первый вариант может дать значительный эффект для приложений, интенсивно читающих только что записанные данные.</p>
<p>Наконец, значительным отличием от Flash Pool является то, что карта блоков кэша у E-series хранится в оперативной памяти контроллера, а не на диске, как у FAS. Это, конечно, позволяет ускорить выборку (по утверждению NetApp возможно до 700% ускорения), но значительно нагружает память контроллера и занимает в нем много места. Это оправданно для purpose-build стораджа, в котором производительности отдано все, но расточительно для стораджа, в котором память контроллера используется под множество различных задач и функций.</p>
<p>Минимальный доступный объем SSD cache для E-series это один SSD, а максимальный на сегодня - 5TB на сторадж. Причем предлагаются SSD объемом 800GB за &#8220;диск&#8221;.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../../../tag/cache.html" rel="tag">cache</a>, <a href="../../../tag/e-series.html" rel="tag">e-series</a>, <a href="../../../tag/netapp/index.html" rel="tag">netapp</a>, <a href="../../../tag/ssd/index.html" rel="tag">ssd</a><br />					Раздел: <a href="../../review/index.html" title="Просмотреть все записи в рубрике &laquo;review&raquo;" rel="category tag">review</a>,  <a href="../index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../../1240/trackback.html#comments" title="Комментарий к записи О кэшировании в SSD для E-Series">1 комментарий</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1232">
				<h2 class="posttitle"><a href="../../../1232/trackback.html" rel="bookmark" title="Permanent Link to Data ONTAP Simulator 8.1.1 в VirtualBox">Data ONTAP Simulator 8.1.1 в VirtualBox</a></h2>
				<div class="postmetadata">12 Ноябрь 2012, 10:38 <!-- от  --></div>
				<div class="postentry">
					<p>О том что такое симулятор Data ONTAP я не буду повторяться в пятый, кажется, раз, отсылая к <a href="../../../tag/simulator.html">более ранним постам на эту тему</a>. Сегодня – о возможности поставить Simulator под гипервизором, отличным от рекомендуемой NetApp VMware. Ну, допустим, у вас Linux, Solaris, или еще что-то, и поставить VMware Player вы не можете. ??ли просто больше любите VirtualBox. Если для симуляторов версии 7 все было просто, там, фактически, это была задача под обычным Linux, то теперь, для симуляторов v8, это стало чуть сложнее, так как он идет уже готовой VM с FreeBSD внутри.</p>
<p>Описание того, как настроить VM в VirtualBox для запуска в нем Simulator 8.1.1 было недавно опубликовано в Community NetApp.</p>
<ol>
<li>Установите VirtualBox обычным образом.     <br />&#160; </li>
<li>Скачайте и распакуйте Симулятор 8.1.1 <br />&#160; </li>
<li>Создайте новую VM с типом OS – “BSD”, версией “FreeBSD (64bit)”. Выделите памяти 1600MB, не выбирайте создание виртуальных дисков, они у нас уже есть и мы подключим их позже в готовую VM. <br />&#160; </li>
<li>Откройте настройки VM (Settings), и на странице System, на табе Processor установите количество CPU – 2.<br />&#160;  </li>
<li>В настройках Storage удалите CDROM с IDE-контроллера. Затем добавьте 4 виртуальных жестких диска, для каждого диска выберите уже существующий vmdk симулятора, по порядку: “DataONTAP.vmdk”, “DataONTAP-var.vmdk”, “DataONTAP-nvram.vmdk” и “DataONTAP-sim.vmdk”. Добавьте контроллер floppy drive с одним пустым floppy. Получившиеся настройки должны выглядеть так: <br />&#160;
<p><img src="https://communities.netapp.com/servlet/JiveServlet/downloadImage/2-94337-17566/450-127/sim-storage.png" /> </p>
<p>&#160;   </li>
<li>На странице <em>Audio</em> уберите отметку в чекбоксе Enable Audio. <br />&#160; </li>
<li>На странице <em>Network</em> добавьте четыре сетевых адаптера (любого нужного вам режима: “host only”, “bridged”, “internal”, “NAT”). В каждом из четырех добавленных NIC откройте секцию Advanced, и выберите в ней тип адаптера “Intel Pro/1000MT Server (82545EM)”. В симуляторе есть драйвер только для этой карты. Выглядит в итоге все так: <br />&#160;
<p><img src="https://communities.netapp.com/servlet/JiveServlet/downloadImage/2-94337-17567/450-330/sim-network.png" /> </p>
<p>&#160;    </li>
<li>В стандартной установке виртуальная машина использует подключенные пайпы Windows для двух последовательных портов: стандартной консоли и дебага. Выможете перенаправить их в обычные последовательные порты, но это не обязательно. <br />&#160; </li>
<li>На странице <em>USB</em> снимите отметку в чекбоксе “Enable USB Controller” <br />&#160; </li>
<li>На странице <em>Shared Folder</em> не устанавливайте shared folder. <br />&#160; </li>
<li>Запишите все изменения в VM. <br />&#160; </li>
<li>Убедитесь, что имеете 1600MB физической свободной памяти для запуска VM, иначе запуск прервется в произвольном месте. <br />&#160; </li>
<li>Запустим VM. <br />&#160; </li>
<li>Во время 10-секундной паузы нажмите любую клавишу КРОМЕ Enter, чтобы прервать нормальную загрузку. <br />&#160; </li>
<li>??змените настройки, запретив запуск установленных в виртуальной машине VMware Tools командой: <em>“setenv bootarg.vm.run_vmtools false”        <br /></em><br />&#160; </li>
<li>Тут же можно изменить и серийный номер симулятора, если вы собираете многосимуляторную конфигурацию, чтобы избежать конфликта при их одновременной работе. <br />&#160; </li>
<li>Введите команду <em>“boot”</em> для нормальной загрузки <br />&#160; </li>
<li>Когда появится сообщение <em>“Press Ctrl-C for menu”</em>, нажмите Ctrl-C и дождитесь появления boot menu. Первая загрузка может занять порой довольно значительное время. <br />&#160; </li>
<li>В появившемся boot menu выберите пункт 4, и подтвердите очистку всех дисков и конфигурации. <br />&#160; </li>
<li>Затем симулятор перезагрузится, эту загрузку уже не нужно прерывать. После окончания загрузки вы увидите стандартную подсказку мастера начальной установки параметров системы, следуйте этой установке и введите все необходимые параметры. Откажитесь от предложения “продолжить в графическом режиме” где-то в середине мастера (в 8.1.1 FilerView уже нет), и дойдите до конца. Если вы сбились, то просто введите setup в качестве команды в консоли, после завершения мастера, и вы сможете повторить настройку с уже введенными данными и изменить какие-то из них. <br />&#160; </li>
</ol>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../../../tag/howto/index.html" rel="tag">howto</a>, <a href="../../../tag/netapp/index.html" rel="tag">netapp</a>, <a href="../../../tag/simulator.html" rel="tag">simulator</a>, <a href="../../../tag/virtualbox.html" rel="tag">virtualbox</a><br />					Раздел: <a href="../../howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;" rel="category tag">howto</a>,  <a href="../index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../../1232/trackback.html#comments" title="Комментарий к записи Data ONTAP Simulator 8.1.1 в VirtualBox">Комментарии (5)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1225">
				<h2 class="posttitle"><a href="../../../1225/trackback.html" rel="bookmark" title="Permanent Link to В последний раз о фрагментации файлов и производительности">В последний раз о фрагментации файлов и производительности</a></h2>
				<div class="postmetadata">23 Октябрь 2012, 10:56 <!-- от  --></div>
				<div class="postentry">
					<p>Я много раз в этом блоге трогал тему о влиянии фрагментации на производительность работы системы хранения (см. например <a href="../../../221/trackback.html">раз</a>, <a href="../../../225/trackback.html">два</a>, <a href="../../../881/trackback.html">три</a>). Но как-то все это были слова, а как насчет “покажь логи”? Так как я до недавних пор был “безлошадный”, а все мои знакомые “с оборудованием” все как на подбор были “ленивы и нелюбопытны”, чтобы дать документальный ответ на этот вопрос, то поэтому пришлось отвечать самому.</p>
<p>Тут вот, как вы уже заметили, я, наконец, <em>обзавелся на хозяйстве </em>маленьким нетаппчиком, и, пока мы его в продакшн не ввели, гоняю в хвост и в гриву, в том числе <em>отвечаю на назревшие вопросы</em>. ?? первый – о том, влияет ли фрагментация данных на производительность доступа к ним при рандомном характере доступа.</p>
<p>Выше в постах, на которые я сослался, я уже ответил на этот вопрос и прояснил свою позицию. Вкратце: <strong>при рандомном доступе производительность от фрагментации данных не зависит</strong>. Так как система хранения обращается к данным рандомно, в произвольном, случайном порядке, то нет никакой особенной разницы в том, будут ли блоки данных лежать упорядоченно, или беспорядочно – их всегда будут читать “беспорядочно”. А рандомность обращения, помноженная на рандомность размещения не дает “рандомность в квадрате”, она остается обычной рандомностью, “в первой степени”.</p>
<p>Надеюсь не нужно дополнительно объяснять, почему для современных многозадачных систем, для баз OLTP, для виртуализованных серверных сред почти 100% доступа к данным является рандомным? Последовательный, “секвентальный” доступ встречается в очень узком сегменте, это бэкапы (а у NetApp, к слову, задача бэкапа, как вы помните, решается другим способом, а не последовательным копированием и передачей данных), это базы с характером доступа DSS, и это, отчасти, логи баз данных. Вот, в общем, и все использование секвентального доступа. Остальное все – более или менее чистый рандом.</p>
<p>Поэтому я взял паттерн доступа <strong>VM-сервер</strong> (40%-write/60%-read, 45%-sequental/55%-random, 4KB block). Секвентальность в последнем случае берется вследствие работы локального кэша хоста. Паттерны эти определил не я, они довольно широко распространены. Вот его и будем <strike>кушать</strike> мерять.</p>
<p>Тестировал я с помощью IOmeter, который, несмотря на некоторые его недостатки, знаю и люблю. В качестве load-generator использовались виртуальные машины, работающие с достаточно мощного хоста (IBM 3850 X5), который был подключен к стораджу по NFS. Для OS в VM диск выглядел “физическим” LUN без файловой системы, который делался MBR-разделом и форматировался в NTFS со стандартным размером блока (4KB). Раздел делался размером 40GB, на нем создавался тестовый файл IOmeter (iobw.tst), размером 16GB (для гарантированного “пробоя кэша”). На каждой VM делался 4-процессорный vCPU, и, соответственно, запускались 4 Worker, на каждом из которых пускался тестовый паттерн на созданный диск, в 16 потоков ввода-вывода (Outstanding IOs) на каждый Worker, то есть 64 одновременных потока ввода-вывода на диски (контроллер NetApp). Загрузка хост-сервера тестом не превышала при этом 15% (мощная зверюга этот 3850), загрузка стораджа колебалась, но также не превышала 80%. То есть заведомо мы в “потолки” нигде не упирались.</p>
<p>Для минимизации эффектов “прогрева WAFL” (о котором еще будет пост, это также была одна из тем “исследовательской недели”) я делал длинный ramp-up (10 минут), а затем начинался собственно измеряемый тест, длиной 30 минут. Я брал для оценки значение в steady state, ближе к концу теста, и для оценки параллельно проверяемого эффекта “падения производительности” при прогреве – ближе к его началу.</p>
<p>Однако, перед исследователем, в моем лице, встала проблема: как обеспечить “фрагментацию” файла тестирования? Если создать последовательный, упорядоченный файл просто: запускай IOmeter на пустом диске – вот он и создаст свой iobw.tst, то с фрагментацией “на заказ” сложнее.</p>
<p>Для того, чтобы сделать фрагментированный файл я нашел любопытную утилитку, под названием MyDefragmenter, которая, как ясно из названия – дефрагментатор. Но у нее в комплекте есть также программка MyFragmenter :). Она делает вполне ожидаемую из названия вещь :)</p>
<p>Я взял созданный IOmeter тестовый файл и <em>качественно замесил</em> его с помощью этой утилитки. Я фрагментировал с ее помощью этот файл на 250 тысяч кусочков по 64KB каждый (ну, чтоб не было претензий, что <em>гранаты у нас не той системы</em>;), а потом повторно провел тестирование описанными выше паттернами.</p>
<p>Также я проанализировал ситуацию с фрагментацией не только файла на NTFS, но и в WAFL, а затем измерил эффект от работы reallocate в WAFL.</p>
<p>Хочу отдельно отметить, что в данном случае измеренные “попугаи”&#160; не могут рассматриваться по абсолютной величине, я не проводил никакого (необходимого) тюнинга системы, и настройки ее “по уму” и по best practices (это я&#160; сделаю позже, ту у меня есть некоторые бюрократические процедуры для этого). Целью теста было сравнить два достигнутых параметра производительности: “А” и”Б”, то есть их соотношение, а не достижение абсолютного рекорда, поэтому реплики с мест “чота как-то иопсев маловата!” мы отметем как неорганизованные ;).</p>
<p>Вот какие результаты я получил:</p>
<p>   <a href="../../../1225/trackback.html#more-1225" class="more-link"><small>Continue reading &#8216;В последний раз о фрагментации файлов и производительности&#8217; &raquo;</small></a></p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../../../tag/fragmentation.html" rel="tag">fragmentation</a>, <a href="../../../tag/netapp/index.html" rel="tag">netapp</a>, <a href="../../../tag/performance/index.html" rel="tag">performance</a>, <a href="../../../tag/reallocate.html" rel="tag">reallocate</a>, <a href="../../../tag/wafl/index.html" rel="tag">wafl</a><br />					Раздел: <a href="../../justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;" rel="category tag">justread</a>,  <a href="../index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../../1225/trackback.html#comments" title="Комментарий к записи В последний раз о фрагментации файлов и производительности">Комментарии (13)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1220">
				<h2 class="posttitle"><a href="../../../1220/trackback.html" rel="bookmark" title="Permanent Link to Замена &ldquo;головы&rdquo; в сторадже: disk ownership change">Замена &ldquo;головы&rdquo; в сторадже: disk ownership change</a></h2>
				<div class="postmetadata">8 Октябрь 2012, 11:11 <!-- от  --></div>
				<div class="postentry">
					<p>Вы уже наверняка знаете, что, в принципе, замена контроллера на установленной системе хранения NetApp процедура довольно несложная. Так как все контроллеры, всех семейств, используют одну и ту же OS Data ONTAP, отличаясь только&#160; внутренним аппаратным устройством, а индивидуальные настройки контроллера системы (файловая система /etc, если кто понимает UNIX-style) находится отдельно от контроллера, на дисках дисковых полок, то вообще говоря замена контроллера на новый, даже другой системы, сводится к простому перетыканию кабелей, после чего новый контроллер с OS внутри подмонтирует свои индивидуальные настройки и поднимется с сохранением настроек и данных на дисках. Но следует не забыть про software ownership. Дело в том, что в этой схеме, ныне общепринятой, диски “приписаны” к определенному контроллеру по его SystemID (а не по подключенным портам, как было когда-то, во времена FAS3020 и старше). Соответственно, чтобы старые диски увиделись новым контроллером нужно на них записи их владельца поменять на нового. делается это из Maintenance mode:</p>
<p><code>
<p>=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2012.10.08 09:26:06 =~=~=~=~=~=~=~=~=~=~=~=      <br />login as: root       <br /><a href="mailto:root@192.168.99.161's">root@192.168.99.161&#8217;s</a> password:       <br />=== OEMCLP v1.0.0 BMC v1.3 ===       <br />bmc shell -&gt; system power cycle       <br />This will cause a dirty shutdown of your appliance. Continue? [y/N] y       <br />bmc shell -&gt;       <br />bmc shell -&gt; system console       <br />Press ^G to enter BMC command shell</p>
<p>AMI BIOS8 Modular BIOS      <br />Copyright (C) 1985-2009,&#160; American Megatrends, Inc. All Rights Reserved       <br />Portions Copyright (C) 2009 NetApp, Inc. All Rights Reserved       <br />BIOS Version 6.1       <br />+++++++++++++++++++++++++++++++++++</p>
<p>Boot Loader version 2.1      <br />Copyright (C) 2000-2003 Broadcom Corporation.       <br />Portions Copyright (C) 2002-2008 NetApp</p>
<p>4096MB RAM installed      <br />CPU Type: Intel(R) Xeon(R) CPU&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; @ 1.66GHz</p>
<p>Starting AUTOBOOT press Ctrl-C to abort&#8230;      <br />Loading X86/freebsd/image2/kernel:..0&#215;200000/7916668 0&#215;98cc7c/708860 0xa3a000/573440 Entry at 0&#215;00248390       <br />Loading X86/freebsd/image2/platform.ko:0xac6000/380544 0xb23000/28000 0xb29d60/109976       <br />Starting program at 0&#215;00248390       <br />NetApp Data ONTAP 8.1.1 7-ModeCopyright (C) 1992-2012 NetApp.       <br />All rights reserved.       <br />md1.uzip: 26368 x 16384 blocksmd2.uzip: 3584 x 16384 blocks</p>
<p>*******************************      <br />*&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; *       <br />* Press Ctrl-C for Boot Menu. *       <br />*&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; *       <br />*******************************       <br />^C</p>
<p>Boot Menu will be available.</p>
<p>Please choose one of the following:</p>
<p>(1) Normal Boot.      <br />(2) Boot without /etc/rc.       <br />(3) Change password.       <br />(4) Clean configuration and initialize all disks.       <br />(5) Maintenance mode boot.       <br />(6) Update flash from backup config.       <br />(7) Install new software first.       <br />(8) Reboot node.       <br />Selection (1-8)? 5</p>
<p>You have selected the maintenance boot option:      <br />the system has booted in maintenance mode allowing the       <br />following operations to be performed:</p>
<p>?&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; disk&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />key_manager&#160;&#160;&#160;&#160;&#160;&#160; fcadmin&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />fcstat&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; sasadmin&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />sasstat&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; acpadmin&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />halt&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; help&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />ifconfig&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; raid_config&#160;&#160;&#160;&#160;&#160;&#160; <br />storage&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; sesdiag&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />sysconfig&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; vmservices&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />version&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; vol&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />aggr&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; sldiag&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />dumpblock&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; environment&#160;&#160;&#160;&#160;&#160;&#160; <br />systemshell&#160;&#160;&#160;&#160;&#160;&#160; vol_db&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />led_on&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; led_off&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />sata&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; acorn&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />stsb&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; scsi&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />nv8&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; disk_list&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />fctest&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; disktest&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />diskcopy&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; vsa&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />xortest&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; disk_mung&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </p>
<p>Type &quot;help &lt;command&gt;&quot; for more details.</p>
<p>In a High Availablity configuration, you MUST ensure that the      <br />partner node is (and remains) down, or that takeover is manually       <br />disabled on the partner node, because High Availability       <br />software is not started or fully enabled in Maintenance mode.</p>
<p>FAILURE TO DO SO CAN RESULT IN YOUR FILESYSTEMS BEING DESTROYED</p>
<p>NOTE: It is okay to use &#8217;show/status&#8217; sub-commands such as      <br />&#8216;disk show or aggr status&#8217; in Maintenance mode while the partner is up       <br />Continue with boot?Please answer yes or no.       <br />Continue with boot? yes</p>
<p>*&gt; disk ?      <br />usage: disk &lt;options&gt;</p>
<p>Options are:&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; assign {&lt;disk_name&gt; | all | [-T &lt;storage type&gt; | -shelf &lt;shelf name&gt;] [-n &lt;count&gt;] | auto} [-p &lt;pool&gt;] [-o &lt;ownername&gt;] [-s &lt;sysid&gt;] [-c block|zoned] [-f] - assign a disk to a filer or all unowned disks by specifying &quot;all&quot;&#160; or &lt;count&gt; number of unowned disks       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ddr_label {repair | print | delete | dumpraw | modify [-c] -o &lt;offset&gt; -v &lt;value&gt; | start_scan | pause_scan | resume_scan | error_scan} [-d all | &lt;disk_list&gt;]       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; encrypt { lock | rekey | destroy | sanitize | show } - perform tasks specific to self-encrypting disks       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; power_cycle [ -f ] { [-d &lt;disk_list&gt;] | [ -c &lt;channel_name&gt; [ -s &lt;shelf_number&gt; ] ] } - power-cycle one or more disks       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <strong>reassign</strong> {-o &lt;old_name&gt; | -s &lt;old_sysid&gt;} [-n &lt;new_name&gt;] [-d &lt;new_sysid&gt;] - reassign disks from old filer       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; remove_ownership [&lt;disk_name&gt; | all | -s &lt;sysid&gt;] [-f] - revert/remove disk ownership       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; sanown_stats {start| stop| show }- collect sanown event stats       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; show [-o &lt;ownername&gt; | -s &lt;sysid&gt; | -n | -v | -a]&#160; - lists disks and owners       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; unfail [-s] &lt;disk_name&gt;&#160;&#160;&#160;&#160; - unfail a disk&#160; (-s&#160; not valid in maintenance mode)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; upgrade_ownership&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; - upgrade disks to new ownership scheme</p>
<p>*&gt;</p>
<p>*&gt; disk reassign -s xxxxxxxxxxx -d yyyyyyyyyyy</p>
<p>Partner node must not be in Takeover mode during disk reassignment      <br />from maintenance mode.       <br />Serious problems could result!!       <br />Are you sure partner is NOT in takeover mode (y/n)? n</p>
<p>*&gt; halt      </p>
<p>Oct 08 01:34:22 [localhost:kern.cli.cmd:debug]: Command line input: the command is &#8216;halt&#8217;. The full command line is &#8216;halt&#8217;. </p>
<p>Uptime: 6m54sSystem halting&#8230; </p>
</p>
<p></code></p>
<p>Выше я прервал переназначение disk ownership, сама же эта процедура делается довольно быстро, и если нигде не ошибиться, и все иметь подготовленным и смонтированным, то можно уложить процедуру замены контроллера системы хранения в 15-20 минут.</p>
<p>Впрочем, если вы используете NetApp как SAN-устройство, и храните на нем LUN-ы, есть еще одна тонкость, связанная со сменой serial id этих LUN при замене NVRAM (отдельно, или в составе контроллера целиком), о которой поговорим в четверг.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../../../tag/change.html" rel="tag">change</a>, <a href="../../../tag/disk-ownership.html" rel="tag">disk ownership</a>, <a href="../../../tag/netapp/index.html" rel="tag">netapp</a>, <a href="../../../tag/ownership.html" rel="tag">ownership</a>, <a href="../../../tag/upgrade.html" rel="tag">upgrade</a><br />					Раздел: <a href="../../howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;" rel="category tag">howto</a>,  <a href="../index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../../1220/trackback.html#comments" title="Комментарий к записи Замена &ldquo;головы&rdquo; в сторадже: disk ownership change">Комментарии (11)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1206">
				<h2 class="posttitle"><a href="../../../1206/trackback.html" rel="bookmark" title="Permanent Link to SMB 3.0">SMB 3.0</a></h2>
				<div class="postmetadata">20 Сентябрь 2012, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>Для начала терминологическое вступление. Вокруг файлового протокола Microsoft довольно много путаницы, начнем с ее распутывания.</p>
<ul>
<li><strong>SMB</strong> – <em>“Server Message Block”</em> – первоначальная версия протокола, разработанная еще во времена MS LAN manager 1.0(почти уже никто не застал те времена, и не помнит что это, совсем каменный век IT, середина 80-х). Некоторый отголосок этой аббревиатуры остался в названии опенсорсного продукта SAMBA, реализации файлового протокола SMB путем его реверс-инжиниринга. </li>
<li><strong>CIFS</strong> – (он же SMB-“просто” или SMB 1.0) – <em>“Common Internet File System”</em> – название CIFS появилось, когда Microsoft в 1996 году начала процесс стандартизации уже существовавшего протокола, в качестве RFC в IETF. Процесс стандартизации этот застопорился где-то на начальном этапе, и MS решила не продолжать его, остановившись на проведении в RFC первой версии драфта (сегодня его статус уже expired). Тем не менее название CIFS в индустрии закрепилось, и постепенно почти вытеснило SMB. </li>
<li><strong>SMB 2.0</strong> – протокол, появившийся в Windows Server 2008, Vista, и поддерживающийся в более поздних OS. Microsoft осознала в какой-то момент, что файловый протокол, разработанный в середине 80-х, пусть и весьма совершенный на тот момент, и имеющий возможности постепенного расширения и добавления возможностей на уровне протокола, страшно отстал от современности (ситуация как примерно с Internet Explorer), страдает рядом существенных проблем, которые стали более заметны с годами. ?? вот в компании дошли руки до начала глубокой модернизации протокола SMB. Обратите внимание, что SMB 2.0 уже некорректно называть “CIFS”. <strong><em>CIFS это только SMB 1.0</em></strong>, поэтому постепенно название CIFS будет уходить. Я, в свою очередь, в этом блоге также буду постепенно избавляться от термина “CIFS”. Если мы говорим о новых версиях файлового протокола Microsoft, то мы будем называть его SMB (v2.0, v2.1, v2.2 AKA v3.0). В SMB 2.0 (и последующих его модификациях: 2.1, 2.2) были улучшены многие насущно важные аспекты, мешавшие SMB 1.0. Протокол был значительно упрощен, и, вместе с тем, улучшен. Появилась возможность кэширования и объединения нескольких команд в одну “цепочку”. Улучшилась работа по “длинным” сетям с большими уровнями задержек, что позволили использовать SMB 2.0 даже в географически распределенных локальных сетях, соединенных через WAN и VPN. Улучшилась реакция на кратковременные дисконнекты сети и масштабируемость.       <br />Но работы в группе разработки SMB не стояли на месте, и к выходу Server 2012 была готова новая, еще более глубоко переработанная версия: </li>
<li><strong>SMB 3.0</strong> – это самая новая на сегодня версия файлового протокола Microsoft, с которым компания готова побороться с некоторым вынужденным засилием NFS в файловых системах хранения (NAS). В ее разработке MS буквально скакнула через несколько ступенек, и подготовила крайне интересный и современный продукт, с множеством новинок и хорошим заделом на будущее. Продолжая развитие SMB 2.0, в Microsoft еще более значительно улучшили производительность работы протокола, реализовали такие интересные вещи, как SMBDirect, с использованием RDMA Transport Protocol (Remote DMA, технология, используемая в высокоскоростых сетях, таких как 10G Ethernet и Infiniband) и поддержку многоканального режима, возможность использовать Remote VSS, BranchCache v2, Transparent Failover, шифрования. Немалую роль в популяризации и распространении SMB 3.0 должен сыграть и MS Hyper-V, впервые поддерживающий в его лице файловые протоколы для подключения стораджа. </li>
</ul>
<p>Официально о поддержке, кроме самой Microsoft, уже заявили EMC и NetApp, два крупнейших игрока рынка NAS, а также поддержка SMB 3.0 появится и в открытом проекте SAMBA. Есть надежда, что к этим игрокам, после выхода Server 2012 подтянутся и остальные, уж больно много полезного появилось в новом SMB.</p>
<p>Так, например, SMB 3.0 явственно нацелился не только на традиционный для SMB 1.0/CIFS/SMB 2.0 сегмент канала связи от сервера до конечной клиентской машины, но и на межсерверный коннект (как бы ни звучало это дико и невообразимо для Old Skool: “Между серверами по бэкбону гонять данные? MS SQL? Exchange? По <strike>CIFS</strike> SMB? Да вы шутите!”). Для этого в нем появились средства SMBDirect и multichannel, позволяющие полноценно использовать производительные возможности вплоть до все еще невообразимого многими 40G Ethernet. Например можно объединить на уровне протокола (а не EtherChannel) в мультилинковый “транк” четыре 10G-линка. А использование RDMA (наиболее известным пользователем технологий RDMA является протокол Infiniband, славящийся своей низкой латентностью) и iWARP (я рассказывал о них в <a href="../../../155/trackback.html">давней заметке</a> в этом блоге) позволит даже выйти по уровню латентности и полосе пропускания для файлового протокола на уровень FC, при этом сохранив все преимущества файлового, а не тупого блочного протокола.</p>
<p>SMB 2.0 поддерживается в системах NetApp уже довольно давно, и требует просто включения соответствующей опции в конфигурации (<code>&gt; options cifs.smb2.enable on</code> и <code>&gt; options cifs.smb2.client.enable on</code>), так что если вы используете в своей сети клиентов не ниже Windows Vista/7, и сервера не ниже Server 2008, то есть смысл включить на сторадже эти опции и перейти целиком на версию протокола SMB 2.0, вы можете получить довольно заметный <a href="http://media.netapp.com/documents/tr-3869.pdf">прирост в производительности</a>.</p>
<p>Поддержка SMB 3.0 в NetApp появится в версии Data ONTAP 8.2, планируемой к выпуску в RC осенью этого года.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../../../tag/cifs.html" rel="tag">cifs</a>, <a href="../../../tag/microsoft.html" rel="tag">microsoft</a>, <a href="../../../tag/netapp/index.html" rel="tag">netapp</a>, <a href="../../../tag/smb.html" rel="tag">smb</a>, <a href="../../../tag/smb-20.html" rel="tag">smb 2.0</a>, <a href="../../../tag/smb-30.html" rel="tag">smb 3.0</a><br />					Раздел: <a href="../../justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;" rel="category tag">justread</a>,  <a href="../index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../../1206/trackback.html#comments" title="Комментарий к записи SMB 3.0">Комментарии (18)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1198">
				<h2 class="posttitle"><a href="../../../1198/trackback.html" rel="bookmark" title="Permanent Link to Политики кэширования записи на Flash Pool">Политики кэширования записи на Flash Pool</a></h2>
				<div class="postmetadata">6 Сентябрь 2012, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>В одном из <a href="../../../1191/trackback.html">предыдущих постов</a> я начал описывать то, как, с помошью политик кэширования Flash Pool можно настроить индивидуально параметры кэширования для томов. Однако кроме кэширования чтения у Flash Pool появидлись средства и кэшировать запись. ??х немного, но они есть.</p>
<p>В настоящий момент имеется два варианта настройки кэширования записи (и один – и чтения и записи разом, который зачислен в “чтения”, и о котором я упомянул в предшествующем посте на эту тему):</p>
<ul>
<li><strong>write-cache = none</strong> – тут нечего особенно рассказывать, это отключение кэширования записи, когда она включена в режиме кэширования во Flash Pool по умолчанию. Параметр этот может быть задан на каждый конкретный том, и использовать его стоит в тех случаях, когда кэширование записи не приносит пользы, например когда рабочая нагрузка не делает многочисленных и частых random-перезаписей данных тома (а напротив, записи идут секвентальные, большими блоками). С использованием такой опции данные пойдут непосредственно на HDD, собственно как они и записывались ранее, в обычных aggregates, без использования Flash Pool. В случае такого характера нагрузки данных тома, вы освободите место на кэше для тех, кому оно действительно необходимо. </li>
<li><strong>write-cache = random-write</strong> – эта опция, напротив, включает кэширование записей на aggregate для данного тома через flash. При этом данные сперва попадают в пространство SSD и кэшируются на нем. Такая политика должна хорошо работать для задач, когда данные, рандомно записываемые на том, часто перезаписываются, или перечитываются сразу после записи. Это значение политики записи по умолчанию. </li>
</ul>
<p>Как я уже упоминал в предшествующей заметке, для управления настройкой кэширования томов на Flash Pool теперь используется новая команда <code>priority</code>, имеющая следующий синтаксис:</p>
<p><code>priority hybrid-cache set &lt;volume name&gt; read-cache=&lt;value&gt; write-сache=&lt;value&gt; </code></p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../../../tag/flash-pool.html" rel="tag">flash pool</a>, <a href="../../../tag/netapp/index.html" rel="tag">netapp</a>, <a href="../../../tag/write-policy.html" rel="tag">write policy</a><br />					Раздел: <a href="../../review/index.html" title="Просмотреть все записи в рубрике &laquo;review&raquo;" rel="category tag">review</a>,  <a href="../index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../../1198/trackback.html#comments" title="Комментарий к записи Политики кэширования записи на Flash Pool">Комментарии (2)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1204">
				<h2 class="posttitle"><a href="../../../1204/trackback.html" rel="bookmark" title="Permanent Link to Что такое IOPS?">Что такое IOPS?</a></h2>
				<div class="postmetadata">5 Сентябрь 2012, 11:00 <!-- от  --></div>
				<div class="postentry">
					<p>Сегодня очередной перевод одного из моих любимых авторов, инженера NetApp Dimitris Krekoukias, пишущего в блоге recoverymonkey.org. Текст крайне важный и заставляющий задуматься. Казалось бы, все мы знаем, что такое “IOPS”, но знаем ли мы это на самом деле, и не упускаем ли мы, говоря про IOPS-ы, нечто важное из виду? Насколько полнятие IOPS является однозначно идентифицируемым и можно ли показатели “в IOPS” трактовать однозначно, и сравнивать различные результаты, различных вендоров между собой?</p>
<h3>IOPS: Возможно наиболее известный показатель производительности системы хранения.</h3>
<p>IOPS означает <em>Input/Output (operations) Per Second</em>, &quot;операций ввода-вывода в секунду&quot;. Смысл величины выглядит довольно очевидно. Он измеряет объем работы за определенный промежуток времени (и это не то же самое, что мегабайты в секунду, MB/s).</p>
<p>Кто из вас не видел вендоров, которые превозносят достоинства своих систем хранения, демонстрируя огромные величины IOPS ими достигнутые? Кто из вас не принимал решения покупки системы хранения, основываясь на обещаниях вендорами этих величин? Однако: как часто вендоры, приводя свои результаты, в действительности четко определяли то, что они понимали под аббревиатурой &quot;IOPS&quot;, публикуя эти результаты? </p>
<p>Для нетерпеливых, скажу это с самого начала: <strong>Величина IOPS <em>сама по себе</em> бессмысленна, и именно так и должна рассматриваться. Без дополнительных метрик, таких как latency, процентное соотношение операций чтения и записи и размера блоков ввода-вывода, величина IOPS совершенно бесполезна</strong>.</p>
<p>А теперь подробнее… </p>
<p>   <a href="../../../1204/trackback.html#more-1204" class="more-link"><small>Continue reading &#8216;Что такое IOPS?&#8217; &raquo;</small></a></p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../../../tag/benchmark/index.html" rel="tag">benchmark</a>, <a href="../../../tag/iops.html" rel="tag">iops</a>, <a href="../../../tag/netapp/index.html" rel="tag">netapp</a>, <a href="../../../tag/performance/index.html" rel="tag">performance</a>, <a href="../../../tag/spc-1.html" rel="tag">spc-1</a><br />					Раздел: <a href="../../justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;" rel="category tag">justread</a>,  <a href="../index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>,  <a href="../../translations/index.html" title="Просмотреть все записи в рубрике &laquo;переводы&raquo;" rel="category tag">переводы</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../../1204/trackback.html#comments" title="Комментарий к записи Что такое IOPS?">Комментарии (16)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1191">
				<h2 class="posttitle"><a href="../../../1191/trackback.html" rel="bookmark" title="Permanent Link to Политики кэширования чтения на Flash Pool">Политики кэширования чтения на Flash Pool</a></h2>
				<div class="postmetadata">20 Август 2012, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>В предыдущем посте я показал, как создать и начать использовать гибридный aggregate (flash pool) с использованием дисков SATA для хранения, и SSD для кэширования обращения.<br />
Но aggregate может содержать на себе множество томов, и, часто, разные тома потребуют разных режимов использования. Flash Pool конечно имеет возможности индивидуальной настройки параметров кэширования для тома. Делается это так:<br />
С помощью команды priority можно указать следующие варианты политик кэширования чтения:</p>
<ul>
<li><strong>read-cache = none</strong> - эта политика отключает кэширование чтения для данного тома вовсе. Например мы хотим сэкономить место в кэше для более ценных данных, или чтение с этого тома редкое и длинными последовательными кусками, затем не перечитываемых повторно,  и их кэширование просто непроизводительно замусорит кэш.</li>
<li><strong>read-cache = meta </strong>- эта политика кэширует операции чтения метаданных. Такая политика полезна для томов, на которых значительную часть операций составляют операции чтения метаданных. Например это операции с большим количеством сканирований директорий со  значительным количеством (сотни и тысячи) файлов, поиска и выбора среди них.<br />
Операции чтения метаданных довольно затратны, так как представляют из себя рандомное чтение мелкими блоками, и кэширование таких операций очень эффективно (и при этом может не занимать больших объемов в кэше).</li>
<li><strong>read-cache = random-read </strong>- эта политика, что очевидно из названия, кэширует операции чтения, идущие в произвольном порядке. Причем кэшируются ?? метаданные, ?? собственно данные одновременно. Эта политика как бы включает в себя предыдущую, но расширяет кэш и на собственно считываемые данные. Это политика по умолчанию. Если вы не переопределите ее, то действовать будет именно она. Обратите внимание, что &#8216;random&#8217; означает, что sequental-операции будут исключены из операций кэширования (оно и правильно).</li>
<li><strong>read-cache = random-read-write </strong>- несколько парадоксальным образом эта политика считается политикой кэширования чтения. С ее использованием к кэшированию операций чтения добавляется новый для NetApp процесс кэширования операций записи. Впрочем, о политиках по кэшированию операций записи мы поговорим в одном из следующих постов.</li>
</ul>
<p>Командная строка настройки политик кэширования для тома выглядит так:<br />
<code>priority hybrid-cache set &lt;volume name&gt; read-cache=&lt;value&gt; write-сache=&lt;value&gt; </code></p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../../../tag/flash-pool.html" rel="tag">flash pool</a>, <a href="../../../tag/netapp/index.html" rel="tag">netapp</a>, <a href="../../../tag/read-policy.html" rel="tag">read policy</a><br />					Раздел: <a href="../../review/index.html" title="Просмотреть все записи в рубрике &laquo;review&raquo;" rel="category tag">review</a>,  <a href="../index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../../1191/trackback.html#comments" title="Комментарий к записи Политики кэширования чтения на Flash Pool">1 комментарий</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1190">
				<h2 class="posttitle"><a href="../../../1190/trackback.html" rel="bookmark" title="Permanent Link to Создание Flash Pool">Создание Flash Pool</a></h2>
				<div class="postmetadata">16 Август 2012, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>С выходом Data ONTAP 8.1.1 (сейчас он, для самых нетерпеливых, находится в состоянии Release Candidate) появляется долгожданная фича под названием <a href="../../../1158/trackback.html">Flash Pool </a>(он же, ранее, <a href="../../../1096/trackback.html">Hybrid Aggregate</a>)</p>
<p>??так, давайте посмотрим, как можно создать Flash Pool, то есть aggregate с дополнительными дисками SSD для кэширования данных.<br />
Создадим для начала простой aggregate:</p>
<p><code>fas01> aggr create flashpool -B 64 -t raid_dp -T SATA -r 16 16</code></p>
<p>??мя aggregate: flashpool, формат: 64-bit, тип RAID: RAID-DP, тип дисков: SATA, размер RAID: 16</p>
<p>После успешного создания aggregate по имени &#8216;flashpool&#8217; разрешим на нем собственно flashpool:</p>
<p><code>fas01> aggr options flashpool hybrid_enabled on</code></p>
<p>Несмотря на то, что коммерческое название фичи было изменено в релизе с &#8216;hybrid aggregate&#8217; на &#8216;flash pool&#8217;, опция по прежнему называется &#8216;hybrid&#8217;. Аналогично с дедупликацией, которая когда-то называлась A-SIS (Advanced Single Instance Storage), и до сих пор так называется соответствующая опция в параметрах.</p>
<p>Теперь можно добавить к aggregate диски SSD в количестве 6 штук:</p>
<p><code>fas01> aggr add flashpool -T SSD 6</code></p>
<p>??з 6 штук два будет забрано под RAID parity (RAID-DP), а оставшиеся 4 - будут использованы как кэш. Обратите внимание, что сам aggregate не увеличится в емкости хранения! Добавленные SSD недоступны для непосредственного использования и записи на них данных, они будут использованы как кэш.</p>
<p>А теперь просто создадим на получившемся aggregate том (myvol) для хранения данных, емкостью 500GB:</p>
<p><code>fas01> vol create myvol flashpool 500g</code></p>
<p>Теперь получившийся том myvol, размером 500GB, можно использовать под данные, причем записываемые и считываемые данные будут автоматически использовать кэш на SSD.<br />
В следующем посте мы посмотрим, какие средства есть для тонкой настройки режимов кэширования томов на Flash Pool.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../../../tag/811.html" rel="tag">8.1.1</a>, <a href="../../../tag/flash-pool.html" rel="tag">flash pool</a>, <a href="../../../tag/netapp/index.html" rel="tag">netapp</a>, <a href="../../../tag/ssd/index.html" rel="tag">ssd</a><br />					Раздел: <a href="../../review/index.html" title="Просмотреть все записи в рубрике &laquo;review&raquo;" rel="category tag">review</a>,  <a href="../index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../../1190/trackback.html#comments" title="Комментарий к записи Создание Flash Pool">Комментарии (5)</a>									 </div>
			</div>
	
						
			<div class="post" id="post-1172">
				<h2 class="posttitle"><a href="../../../1172/trackback.html" rel="bookmark" title="Permanent Link to Про настройку NetApp &ndash; новый блог">Про настройку NetApp &ndash; новый блог</a></h2>
				<div class="postmetadata">28 Июнь 2012, 8:00 <!-- от  --></div>
				<div class="postentry">
					<p>К пользующимся у меня тут, судя по вебсатистике, бешеным спросом статьям о начальном запуске и настройке новых систем NetApp (<a href="../../../916/trackback.html">часть 1</a> и <a href="../../../1132/trackback.html">часть 2</a>), в закладки админу добавились в интернете новые тексты:</p>
<h3><a href="http://twistedminds.ru/2012/06/setting-up-fas2040-part-1/">Настройка NetApp FAS – Часть 1</a>&#160;</h3>
<p>(Описание контроллера FAS2040, возврат к заводским настройкам, базовая настройка файлера, настройка BMC, обновление Data ONTAP, NTP сервера).</p>
<h3><a href="http://twistedminds.ru/2012/06/setting-up-netapp-fas-filer-part-2/">Настройка NetApp FAS – Часть 2</a></h3>
<p>&#160;&#160;
<p>(Multimode VIF и его виды, балансировка нагрузки, интерфейсы-партнер в кластере, псевдонимы aka IP Aliasing, flowcontrol и MTU, настройка Static и Dynamic VIF с&#160; коммутатором Cisco Catalyst).</p>
<h3><a href="http://twistedminds.ru/2012/06/setting-up-netapp-filer-part-3/">Настройка NetApp FAS – Часть 3</a></h3>
<p>&#160;&#160;
<p>(disk ownership, raid group, aggregate, volume, qtree, lun).</p>
<h3><a href="http://twistedminds.ru/2012/06/setting-up-netapp-filer-part-4/">Настройка NetApp FAS – Часть 4</a></h3>
<p>&#160;&#160;
<p>(iSCSI, настройка iSCSI, безопасность iSCSI, iSNS)</p>
<p class="title">Все это – в блоге <a href="http://twistedminds.ru">http://twistedminds.ru</a>.</p>
<p class="title">Если вы интересуетесь темой, то сходите, посмотрите, может быть полезно. Автор раскрывает тему в несколько ином ключе, и пишет, например, гораздо больше о сетевых настройках и VIF, о которых я в своих постах “самого начала” не говорил (отчасти намеренно).</p>
<p class="title">Ожидается продолжение. да и вообще заглядывайте туда, интересный ресурс.</p>
<p>UPD: Пока пост отстаивался в “отстойнике”, как это обчно и бывает с написанными мной текстами, автор удвоил количество своих постов на данную тему. Шоназывается “респект”.</p>
				</div>
		
				<div class="postmetadata">
					Метки: <a href="../../../tag/install.html" rel="tag">install</a>, <a href="../../../tag/netapp/index.html" rel="tag">netapp</a>, <a href="../../../tag/network.html" rel="tag">network</a>, <a href="../../../tag/setup.html" rel="tag">setup</a>, <a href="../../../tag/vif.html" rel="tag">vif</a><br />					Раздел: <a href="../../howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;" rel="category tag">howto</a>,  <a href="../index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;" rel="category tag">techtalk</a>&nbsp;&nbsp;|&nbsp;
					<a href="../../../1172/trackback.html#comments" title="Комментарий к записи Про настройку NetApp &ndash; новый блог">1 комментарий</a>									 </div>
			</div>
	
		
		<div class="navigation">
			<div class="alignleft"><a href="4.html">&laquo; Previous Entries</a></div>
			<div class="alignright"><a href="2.html">Next Entries &raquo;</a></div>
		</div>
		
	
	</div>
	<div id="sidebar">
		<ul>
			
			
			<!-- Author information is disabled per default. Uncomment and fill in your details if you want to use it.
			<li><h2>Автор</h2>
			<p>A little something about you, the author. Nothing lengthy, just an overview.</p>
			</li>
			-->

			<li class="pagenav"><h2>Страницы</h2><ul><li class="page_item page-item-153"><a href="../../../../about/trackback.html" title="about">about</a></li>
<li class="page_item page-item-215"><a href="../../../../distributory-v-rossii/trackback.html" title="Дистрибуторы в России">Дистрибуторы в России</a></li>
<li class="page_item page-item-1327"><a href="../../../../disti-ua/trackback.html" title="Дистрибуторы в Украине">Дистрибуторы в Украине</a></li>
</ul></li>
			<li><h2>Рубрики</h2>
				<ul>
					<li class="cat-item cat-item-89"><a href="../../commands/index.html" title="Просмотреть все записи в рубрике &laquo;commands&raquo;">commands</a>
</li>
	<li class="cat-item cat-item-37"><a href="../../howto/index.html" title="Просмотреть все записи в рубрике &laquo;howto&raquo;">howto</a>
</li>
	<li class="cat-item cat-item-52"><a href="../../justread/index.html" title="Просмотреть все записи в рубрике &laquo;justread&raquo;">justread</a>
</li>
	<li class="cat-item cat-item-51"><a href="../../review/index.html" title="Просмотреть все записи в рубрике &laquo;review&raquo;">review</a>
</li>
	<li class="cat-item cat-item-3 current-cat"><a href="../index.html" title="Просмотреть все записи в рубрике &laquo;techtalk&raquo;">techtalk</a>
</li>
	<li class="cat-item cat-item-71"><a href="../../tricks/index.html" title="Просмотреть все записи в рубрике &laquo;tricks&raquo;">tricks</a>
</li>
	<li class="cat-item cat-item-95"><a href="../../utilities/index.html" title="Просмотреть все записи в рубрике &laquo;utilities&raquo;">utilities</a>
</li>
	<li class="cat-item cat-item-44"><a href="../../whoisho/index.html" title="Просмотреть все записи в рубрике &laquo;whoisho&raquo;">whoisho</a>
</li>
	<li class="cat-item cat-item-1"><a href="../../news/index.html" title="Просмотреть все записи в рубрике &laquo;новости&raquo;">новости</a>
</li>
	<li class="cat-item cat-item-387"><a href="../../opros.html" title="Просмотреть все записи в рубрике &laquo;опрос&raquo;">опрос</a>
</li>
	<li class="cat-item cat-item-8"><a href="../../translations/index.html" title="Просмотреть все записи в рубрике &laquo;переводы&raquo;">переводы</a>
</li>
	<li class="cat-item cat-item-40"><a href="../../citaty/index.html" title="Просмотреть все записи в рубрике &laquo;цитаты&raquo;">цитаты</a>
</li>
				</ul>
			</li>

			<li><h2>Архивы</h2>
				<ul>
					<li><a href='../../../date/2018/01.html' title='Январь 2018'>Январь 2018</a></li>
	<li><a href='../../../date/2015/10.html' title='Октябрь 2015'>Октябрь 2015</a></li>
	<li><a href='../../../date/2015/04.html' title='Апрель 2015'>Апрель 2015</a></li>
	<li><a href='../../../date/2015/03.html' title='Март 2015'>Март 2015</a></li>
	<li><a href='../../../date/2015/01.html' title='Январь 2015'>Январь 2015</a></li>
	<li><a href='../../../date/2014/12.html' title='Декабрь 2014'>Декабрь 2014</a></li>
	<li><a href='../../../date/2014/11.html' title='Ноябрь 2014'>Ноябрь 2014</a></li>
	<li><a href='../../../date/2014/10.html' title='Октябрь 2014'>Октябрь 2014</a></li>
	<li><a href='../../../date/2014/09.html' title='Сентябрь 2014'>Сентябрь 2014</a></li>
	<li><a href='../../../date/2014/08.html' title='Август 2014'>Август 2014</a></li>
	<li><a href='../../../date/2014/07.html' title='Июль 2014'>Июль 2014</a></li>
	<li><a href='../../../date/2014/06.html' title='Июнь 2014'>Июнь 2014</a></li>
	<li><a href='../../../date/2014/05.html' title='Май 2014'>Май 2014</a></li>
	<li><a href='../../../date/2014/04.html' title='Апрель 2014'>Апрель 2014</a></li>
	<li><a href='../../../date/2014/03.html' title='Март 2014'>Март 2014</a></li>
	<li><a href='../../../date/2014/02.html' title='Февраль 2014'>Февраль 2014</a></li>
	<li><a href='../../../date/2014/01.html' title='Январь 2014'>Январь 2014</a></li>
	<li><a href='../../../date/2013/12.html' title='Декабрь 2013'>Декабрь 2013</a></li>
	<li><a href='../../../date/2013/11.html' title='Ноябрь 2013'>Ноябрь 2013</a></li>
	<li><a href='../../../date/2013/10.html' title='Октябрь 2013'>Октябрь 2013</a></li>
	<li><a href='../../../date/2013/09.html' title='Сентябрь 2013'>Сентябрь 2013</a></li>
	<li><a href='../../../date/2013/08.html' title='Август 2013'>Август 2013</a></li>
	<li><a href='../../../date/2013/07.html' title='Июль 2013'>Июль 2013</a></li>
	<li><a href='../../../date/2013/06.html' title='Июнь 2013'>Июнь 2013</a></li>
	<li><a href='../../../date/2013/05.html' title='Май 2013'>Май 2013</a></li>
	<li><a href='../../../date/2013/04.html' title='Апрель 2013'>Апрель 2013</a></li>
	<li><a href='../../../date/2013/03.html' title='Март 2013'>Март 2013</a></li>
	<li><a href='../../../date/2013/02.html' title='Февраль 2013'>Февраль 2013</a></li>
	<li><a href='../../../date/2013/01.html' title='Январь 2013'>Январь 2013</a></li>
	<li><a href='../../../date/2012/12.html' title='Декабрь 2012'>Декабрь 2012</a></li>
	<li><a href='../../../date/2012/11.html' title='Ноябрь 2012'>Ноябрь 2012</a></li>
	<li><a href='../../../date/2012/10.html' title='Октябрь 2012'>Октябрь 2012</a></li>
	<li><a href='../../../date/2012/09.html' title='Сентябрь 2012'>Сентябрь 2012</a></li>
	<li><a href='../../../date/2012/08.html' title='Август 2012'>Август 2012</a></li>
	<li><a href='../../../date/2012/07.html' title='Июль 2012'>Июль 2012</a></li>
	<li><a href='../../../date/2012/06.html' title='Июнь 2012'>Июнь 2012</a></li>
	<li><a href='../../../date/2012/05.html' title='Май 2012'>Май 2012</a></li>
	<li><a href='../../../date/2012/04.html' title='Апрель 2012'>Апрель 2012</a></li>
	<li><a href='../../../date/2012/03.html' title='Март 2012'>Март 2012</a></li>
	<li><a href='../../../date/2012/02.html' title='Февраль 2012'>Февраль 2012</a></li>
	<li><a href='../../../date/2012/01.html' title='Январь 2012'>Январь 2012</a></li>
	<li><a href='../../../date/2011/12.html' title='Декабрь 2011'>Декабрь 2011</a></li>
	<li><a href='../../../date/2011/11.html' title='Ноябрь 2011'>Ноябрь 2011</a></li>
	<li><a href='../../../date/2011/10/index.html' title='Октябрь 2011'>Октябрь 2011</a></li>
	<li><a href='../../../date/2011/09/index.html' title='Сентябрь 2011'>Сентябрь 2011</a></li>
	<li><a href='../../../date/2011/08.html' title='Август 2011'>Август 2011</a></li>
	<li><a href='../../../date/2011/07/index.html' title='Июль 2011'>Июль 2011</a></li>
	<li><a href='../../../date/2011/06/index.html' title='Июнь 2011'>Июнь 2011</a></li>
	<li><a href='../../../date/2011/05/index.html' title='Май 2011'>Май 2011</a></li>
	<li><a href='../../../date/2011/04/index.html' title='Апрель 2011'>Апрель 2011</a></li>
	<li><a href='../../../date/2011/03/index.html' title='Март 2011'>Март 2011</a></li>
	<li><a href='../../../date/2011/02.html' title='Февраль 2011'>Февраль 2011</a></li>
	<li><a href='../../../date/2011/01.html' title='Январь 2011'>Январь 2011</a></li>
	<li><a href='../../../date/2010/12.html' title='Декабрь 2010'>Декабрь 2010</a></li>
	<li><a href='../../../date/2010/11/index.html' title='Ноябрь 2010'>Ноябрь 2010</a></li>
	<li><a href='../../../date/2010/10/index.html' title='Октябрь 2010'>Октябрь 2010</a></li>
	<li><a href='../../../date/2010/09/index.html' title='Сентябрь 2010'>Сентябрь 2010</a></li>
	<li><a href='../../../date/2010/08.html' title='Август 2010'>Август 2010</a></li>
	<li><a href='../../../date/2010/07/index.html' title='Июль 2010'>Июль 2010</a></li>
	<li><a href='../../../date/2010/06.html' title='Июнь 2010'>Июнь 2010</a></li>
	<li><a href='../../../date/2010/05.html' title='Май 2010'>Май 2010</a></li>
	<li><a href='../../../date/2010/04/index.html' title='Апрель 2010'>Апрель 2010</a></li>
	<li><a href='../../../date/2010/03/index.html' title='Март 2010'>Март 2010</a></li>
	<li><a href='../../../date/2010/02.html' title='Февраль 2010'>Февраль 2010</a></li>
	<li><a href='../../../date/2010/01.html' title='Январь 2010'>Январь 2010</a></li>
	<li><a href='../../../date/2009/12/index.html' title='Декабрь 2009'>Декабрь 2009</a></li>
	<li><a href='../../../date/2009/11/index.html' title='Ноябрь 2009'>Ноябрь 2009</a></li>
	<li><a href='../../../date/2009/10.html' title='Октябрь 2009'>Октябрь 2009</a></li>
	<li><a href='../../../date/2009/09.html' title='Сентябрь 2009'>Сентябрь 2009</a></li>
	<li><a href='../../../date/2009/08/index.html' title='Август 2009'>Август 2009</a></li>
	<li><a href='../../../date/2009/07/index.html' title='Июль 2009'>Июль 2009</a></li>
	<li><a href='../../../date/2009/06.html' title='Июнь 2009'>Июнь 2009</a></li>
	<li><a href='../../../date/2009/05.html' title='Май 2009'>Май 2009</a></li>
	<li><a href='../../../date/2009/04.html' title='Апрель 2009'>Апрель 2009</a></li>
	<li><a href='../../../date/2009/03.html' title='Март 2009'>Март 2009</a></li>
	<li><a href='../../../date/2009/02.html' title='Февраль 2009'>Февраль 2009</a></li>
	<li><a href='../../../date/2009/01.html' title='Январь 2009'>Январь 2009</a></li>
	<li><a href='../../../date/2008/12.html' title='Декабрь 2008'>Декабрь 2008</a></li>
	<li><a href='../../../date/2008/11.html' title='Ноябрь 2008'>Ноябрь 2008</a></li>
	<li><a href='../../../date/2008/10.html' title='Октябрь 2008'>Октябрь 2008</a></li>
	<li><a href='../../../date/2008/09.html' title='Сентябрь 2008'>Сентябрь 2008</a></li>
	<li><a href='../../../date/2008/08.html' title='Август 2008'>Август 2008</a></li>
	<li><a href='../../../date/2008/03.html' title='Март 2008'>Март 2008</a></li>
	<li><a href='../../../date/2008/02.html' title='Февраль 2008'>Февраль 2008</a></li>
	<li><a href='../../../date/2007/12.html' title='Декабрь 2007'>Декабрь 2007</a></li>
	<li><a href='../../../date/2007/11.html' title='Ноябрь 2007'>Ноябрь 2007</a></li>
	<li><a href='../../../date/2007/10.html' title='Октябрь 2007'>Октябрь 2007</a></li>
	<li><a href='../../../date/2007/09.html' title='Сентябрь 2007'>Сентябрь 2007</a></li>
	<li><a href='../../../date/2007/08.html' title='Август 2007'>Август 2007</a></li>
	<li><a href='../../../date/2007/07/index.html' title='Июль 2007'>Июль 2007</a></li>
	<li><a href='../../../date/2007/06.html' title='Июнь 2007'>Июнь 2007</a></li>
	<li><a href='../../../date/2007/05.html' title='Май 2007'>Май 2007</a></li>
				</ul>
			</li>

			
					</ul>
	</div>

</div> <!-- wrapper -->
<div id="footer">
	<a href="../../../../feed">Entries (RSS)</a> and <a href="../../../../comments/feed">Comments (RSS)</a>. Valid <a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional"><abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a> and <a href="http://jigsaw.w3.org/css-validator/check/referer"><abbr title="Cascading Style Sheets">CSS</abbr></a>.<br />
	Powered by <a href="http://wordpress.org/" title="Powered by WordPress.">WordPress</a> and <a href="http://srinig.com/wordpress/themes/fluid-blue/">Fluid Blue theme</a>.<br />
	<!-- 15 queries. 0.104 seconds. -->
	</div>
</div> <!-- page -->
</body>
</html>
